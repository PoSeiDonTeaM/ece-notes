\documentclass[11pt,a4paper,notitlepage,fleqn]{article}

\input{preamble.tex}

\title{Αναλογικές Τηλεπικοινωνίες
	\\
	{ 
		\normalsize Σημειώσεις από τις παραδόσεις
	}}
\date{Οκτώβριος-Ιανουάριος 2017
	\\
	{ 
		\small Τελευταία ενημέρωση: \today
	}
}
\author{
	Για τον κώδικα σε \LaTeX, ενημερώσεις και προτάσεις:
	\\
	\url{https://github.com/kongr45gpen/ece-notes}}

\setallmainfonts(Digits,Latin,Greek){Asana Math}
\setmainfont{Noto Serif}
\setsansfont{Ubuntu}
%\usepackage{unicode-math}
\usepackage{polyglossia}
\newfontfamily\greekfont[Script=Greek,Scale=0.95]{Noto Serif}
\setmathfont{XITS Math}

\hypersetup{pdftitle = {Αναλογικές Τηλεπικοινωνίες}}


\begin{document}
\maketitle

\hrule
\vspace{50pt}
	
Αναλογικές Τηλεπικοινωνίες

\begin{attnbox}{Εγγραφή στη λίστα}
	Μήνυμα στο \href{mailto:dimakis@auth.gr}{\texttt{dimakis@auth.gr}} με θέμα
	\textit{\textbf{Αναλογικές Τηλεπικοινωνίες}}.
	
	\tcblower
	
	Στη λίστα θα στέλνονται ασκήσεις χρήσιμες για τις εξετάσεις και λοιπές ανακοινώσεις.
\end{attnbox}

\begin{attnbox}{Μάθημα}
	Το μάθημα της Παρασκευής καταργείται.
	Θα γίνονται μαθήματα σε κοινό τμήμα την Τρίτη και την Τετάρτη.
	
	Την Τρίτη θα γίνονται ασκήσεις, και την Τετάρτη θεωρία.
\end{attnbox}

Εξετάσεις: Όλα ανοιχτά.

Το μάθημα θα γίνει με βάση το βιβλίο του Haykin.

Ιστοσελίδα Ασκήσεων:
\url{http://genesis.ee.auth.gr/dimakis/greek/courses/telesysI}

\section{Εισαγωγή}
Επικοινωνία είναι η μεταφορά μηνυμάτων, που μπορεί να έχουν τη μορφή απλών συμβόλων / φθόγγων
ή πιο περίπλοκων μηνυμάτων.

Για τον μηχανικό, επικοινωνία είναι η μετάδοση ή μεταφορά πληροφορίας από ένα σημείο \( A \) σε ένα σημείο \( B \) του χώρου.

\begin{center}
	\begin{tikzpicture}
	\draw[thin,gray,dashed] (0,0) -- (2,0);
	\filldraw (0,0) circle (2pt) node[left] {$A$};
	\filldraw (2,0) circle (2pt) node[right] {$B$};
	\end{tikzpicture}
\end{center}

Την πληροφορία μπορούμε να την ορίσουμε ως ένα σύνολο ταξινομημένων συμβόλων, που μαζί ίσως
σχηματίζουν μια λέξη, μια πρόταση, ή ένα νόημα. Ένας καλύτερος ορισμός έχει δοθεί από τον
Shannon στη Θεωρία Πληροφοριών.

Μία ακόμα παράμετρος είναι ο χρόνος μεταφοράς της πληροφορίας, αν και συνήθως δεν μας
ενδιαφέρει στις αναλογικές τηλεπικοινωνίες (δεδομένης της ταχύτητας του φωτός), εκτός
αν προσπαθούμε να επικοινωνήσουμε με κάτι εκτός του πλανήτη.

Τα σήματα αυτά μπορούν να μεταφέρουν αριθμούς, κείμενο, εικόνα, ήχο, βίντεο, αρχεία κ.ά, και
βρίσκονται σε σχετικά χαμηλές συχνότητες (\textbf{baseband}). Για παράδειγμα, το εύρος της ανθρώπινης φωνής που
απαιτείται για να είναι καταληπτή είναι \( 300 \ \mathrm{Hz} \)-\( 3300\ \mathrm{Hz} \), ενώ
τα τηλεοπτικά σήματα κωδικοποιούνται σε συχνότητες έως \( 6 \ \mathrm{MHz} \). Τέτοιες
συχνότητες όμως είναι δύσκολο να μεταδοθούν (αν π.χ. σκεφτούμε ότι οι συχνότητες αρκετών
ηλεκτρομαγνητικών κυμάτων ή του ορατού φωτός είναι της τάξης των \( \mathrm{GHz} \) και
\( \mathrm{THz} \)). Επομένως, για να επιτύχει η επικοινωνία απαιτείται η αύξηση της
συχνότητας του σήματος, μέσω μιας διαδικασίας που λέγεται \textbf{διαμόρφωση}.

\begin{tikzpicture}[scale=1]
\def\h{0.6}
\filldraw (-0.5,0) circle(1.5pt) node[left] {$A$};
\draw (0,-\h/2) rectangle ++(1.5,\h) node[midway] {Πηγή};
\draw (1.5,0) -- (1.95,0);
\node[cloud, cloud puffs=15.7, cloud ignores aspect,
rotate=90,minimum width=3cm, minimum height=1.2cm, align=center, draw]
(cloud) at (2.63cm, 0cm) {Διαμόρφωση};
\draw (3.3,0) -- (3.7,0);
\draw (3.7,-\h/2) rectangle ++(1.5,\h) node[midway] {Πομπός};

\draw[->] (5.2,0) -- ++ (0.2,0) -- ++(0,-1) -- ++(0.3,0);
\draw 
(5.7,-1-2*\h/2) rectangle ++(3,2*\h) node[midway,align=center,rectangle] {Κανάλι\\Μέσο διάδοσης};
\draw (8.7,-1) -- ++(0.3,0) -- ++(0,1) -- ++(0.2,0);
\draw (9.2,-\h/2) rectangle ++(1.5,\h) node[midway] {Δέκτης};
\draw (10.7,0) -- ++(0.35,0);
\node[cloud, cloud puffs=15.7, cloud ignores aspect,
rotate=90,minimum width=3cm, minimum height=1.6cm, align=center, draw]
(cloud) at (11.85cm, 0cm) {Αποδιαμόρφωση};
\draw (12.6,0) -- (13,0);
\draw (13,-\h/2) rectangle ++(1.8,\h) node[midway,scale=.9] {Αποδέκτης};
\filldraw (14.8+0.5,0) circle(1.5pt) node[right] {$B$};
\end{tikzpicture}

Η επιλογή της κατάλληλης συχνότητας του σήματος που θα στείλουμε από την κεραία, εξαρτάται
από τα χαρακτηριστικά του ηλεκτρομαγνητικού κύματος. Για παράδειγμα, πιο χαμηλές συχνότητες
(π.χ. AM) μπορούν να περάσουν μέσα από βουνά και εμπόδια, φτάνοντας σε μεγάλες αποστάσεις
στον πλανήτη, και ακολουθώντας την καμπύλη της γης. Τα βραχέα μπορούν να χτυπήσουν στην
ιονόσφαιρα και να ανακλαστούν για ακόμα μεγαλύτερη κάλυψη. Αντιθέτως, οι υψηλές συχνότητες
(π.χ. FM) επιτρέπουν υψηλότερη ποιότητα μετάδοσης.

\begin{wrapfigure}{r}{0.3\textwidth}\centering
	\begin{tikzpicture}[scale=.5,every node/.style={scale=.7}]
	\def\l{1}
	\def\h{3.5}
	\def\N{7}
	
	\begin{scope}[every node/.style={midway,above,scale=.4}]
	\draw[->] (0,1) -- (0,0) node[midway,right] {user};
	\draw (-\l,0) rectangle (\l,-\h);
	\draw(-\l,-1*\h/7) -- ++(2*\l,0) node {Application};
	\draw(-\l,-2*\h/7) -- ++(2*\l,0) node {Presentation};
	\draw(-\l,-3*\h/7) -- ++(2*\l,0) node {Session};
	\draw(-\l,-4*\h/7) -- ++(2*\l,0) node {Transport};
	\draw(-\l,-5*\h/7) -- ++(2*\l,0) node {Network};
	\draw(-\l,-6*\h/7) -- ++(2*\l,0) node {Data Link};
	\draw(-\l,-7*\h/7) -- ++(2*\l,0) node[scale=1.3,yshift=-1mm] {Physical};
	\end{scope}
	
	\begin{scope}[every node/.style={midway,above,scale=.4,baseline},xshift=5cm]
	\draw[<-] (0,1) -- (0,0) node[midway,right] {user};
	\draw (-\l,0) rectangle (\l,-\h);
	\draw(-\l,-1*\h/7) -- ++(2*\l,0) node {Application};
	\draw(-\l,-2*\h/7) -- ++(2*\l,0) node {Presentation};
	\draw(-\l,-3*\h/7) -- ++(2*\l,0) node {Session};
	\draw(-\l,-4*\h/7) -- ++(2*\l,0) node {Transport};
	\draw(-\l,-5*\h/7) -- ++(2*\l,0) node {Network};
	\draw(-\l,-6*\h/7) -- ++(2*\l,0) node {Data Link};
	\draw(-\l,-7*\h/7) -- ++(2*\l,0) node[scale=1.3,yshift=-1mm] {Physical};
	\end{scope}
	
	\draw (0,-\h) -- ++(0,-1) -- ++(1.5,0);
	\draw (1.5,-\h-1+0.4) rectangle ++(2,-0.8) node[midway] {Κανάλι};
	\draw (3.5,-\h-1) -- ++(1.5,0) -- ++(0,1);
	
	\draw[<->,thick,gray] (1.5,-1.7) to[bend left] node[midway,above] {Peer} ++(2,0);
	
	\draw (current bounding box.north) node[rectangle,align=center]
	{OSI\\7 επιπέδων};
	\end{tikzpicture}
\end{wrapfigure}

Για την κωδικοποίηση και αποκωδικοποίηση των δεδομένων, πρέπει ο πομπός και ο δέκτης να
συμφωνήσουν σε ένα κοινό πρότυπο, για παράδειγμα στο TCP/IP ή το OSI 7 επιπέδων.

Σε αυτό το μάθημα μας ενδιαφέρει το φυσικό επίπεδο μόνο.

Οι ψηφιακές επικοινωνίες αναφέρονται σε ψηφιακά δεδομένα, αλλά πρακτικά η μετάδοση
του σήματος μέσω των καναλιών (π.χ ηλεκτρομαγνητικά κύματα) είναι αναλογική, αφού δεν γίνεται
να έχουμε άμεση μετάβαση της κατάστασης από 0 ως 1:

\begin{tikzpicture}[scale=1]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (6,0);

\draw[very thick,black!70!blue] plot[const plot]
coordinates {(0,1) (1,-1) (3,1) (4,-1) (5.5,1) (6,1)};

\draw[very thick,black!20!cyan!80!blue] plot[const plot,smooth,tension=0.8]
coordinates {(0,0.8) (0.8,0.7) (1.5,-1.4) (2.7,-0.8) (3.5,1) (4.9,-1.2) (5.5,1) (6,1.2)};

\filldraw[fill=black!70!blue] (7,-0.3) rectangle ++(0.2,0.2) node[midway,right,xshift=1mm] {ψηφιακό σήμα};

\filldraw[fill=black!20!cyan!80!blue] (7,-0.8) rectangle ++(0.2,0.2) node[midway,right,xshift=1mm] {πραγματικό σήμα};
\end{tikzpicture}

Πρακτικά οι αναλογικές τηλεπικοινωνίες χρησιμοποιούνται πλέον μόνο στους ραδιοφωνικούς
σταθμούς FM (που αρχίζουν και αυτοί να καταργούνται), αλλά συνεχίζουμε να τις μελετάμε για
λόγους ιστορικούς, διδακτικούς, και επειδή το σήμα όπως αναφέρθηκε παραπάνω είναι εν γένει
αναλογικό. Στο νέο πρόγραμμα σπουδών δεν υπάρχει ακριβώς αυτό το μάθημα.

\subsection{Βασικές έννοιες}
\paragraph{Σήμα βασικής συχνότητας (baseband)}
Τα σήματα βασικής συχνότητας (\textbf{baseband}) προέρχονται από το αρχικό σήμα σε
"χαμηλές" συχνότητες όπως αναφέρθηκε παραπάνω (συνήθως από 0 μέχρι π.χ. 20 \( \mathrm{kHz} \)
ή 6 \( \mathrm{MHz} \)):

\begin{tikzpicture}[scale=1]
\def\s{ (0,0) (0.5,1) (0.7,1.2+0.1*rand) (1,1.5) (1.2,1.2+0.1*rand) (1.4,1+0.1*rand)
	(1.6, 0.7+0.2*rand) (1.8,0.4+0.15*rand) (2,0)}

\pgfmathsetseed{15}
\draw[very thick, orange] plot [smooth] coordinates \s;
\pgfmathsetseed{15}
\draw (2,0) node[below] {$w$};

\draw (0,0) node[below left] {$0$};
\draw (-3,0) -- (3,0) node[below right] {$\mathrm{Hz}$};
\draw (0,-0.2) -- (0,2);
\end{tikzpicture}

Ή, επειδή χρησιμοποιούμε \textit{δίπλευρα} φάσματα:

\begin{tikzpicture}[scale=1]
\def\s{ (0,0) (0.5,1) (0.7,1.2+0.1*rand) (1,1.5) (1.2,1.2+0.1*rand) (1.4,1+0.1*rand)
	(1.6, 0.7+0.2*rand) (1.8,0.4+0.15*rand) (2,0)}

\pgfmathsetseed{15}
\draw[very thick, orange] plot [smooth] coordinates \s;
\pgfmathsetseed{15}
\draw[very thick, orange!90!brown, xscale=-1] plot [smooth] coordinates \s;
\draw (2,0) node[below] {$w$};
\draw (-2,0) node[below] {$-w$};

\draw (0,0) node[below left] {$0$};
\draw (-3,0) -- (3,0) node[below right] {$\mathrm{Hz}$};
\draw (0,-0.2) -- (0,2);
\end{tikzpicture}

Η μέγιστη θετική συχνότητα \( w \) ορίζει το \textbf{εύρος ζώνης (bandwidth)} του σήματος.

Η διαδικασία που θα χρησιμοποιήσουμε για να αυξήσουμε τη συχνότητα του σήματος ονομάζεται
\textbf{διαμόρφωση (modulation)}.

Συνήθως έχουμε μια \textbf{φέρουσα συχνότητα}:
\[
c(t) = A_c\cos(2\pi f_c t)
\]
και πρέπει να βρούμε έναν τρόπο να προσθέσουμε σε αυτήν τις πληροφορίες του αρχικού σήματος.
Στην παραπάνω εξίσωση έχουμε τρεις παραμέτρους που μπορούμε να επηρεάσουμε: το πλάτος,
τη συχνότητα και τη φάση:
\[
c(t) =
\underset{\substack{\downarrow\\\mathclap{A_c(t)}}}{A_c}
\cos(2\pi
\underset{\substack{\downarrow\\\mathclap{f_c(t)}}}{f_c}
t
+
\underset{\substack{\downarrow\\\mathclap{\phi(t)}}}{\phi}
)
\]

Έτσι έχουμε τρία είδη διαμόρφωσης:
\begin{description}
	\item[AM] Διαμόρφωση Πλάτους (Amplitude Modulation)
	\item[FM] Διαμόρφωση Συχνότητας (Frequency Modulation)
	\item[PM] Διαμόρφωση Φάσης (Phase Modulation)
\end{description}

\section{Διαμόρφωση Πλάτους}

\subsection{AM}
Έστω το \emph{φέρον}:
\[
c(t) = A_c\cos(2\pi f_c t)
\]
και θέλουμε να μεταφέρουμε ένα σήμα:
\[
m(t) \qquad \text{στη βασική ζώνη}
\]

Θεωρούμε, για λόγους που θα δούμε παρακάτω, ότι το φέρον έχει συχνότητα πολύ μεγαλύτερη
από το εύρος ζώνης της πληροφορίας:
\[
f_c \gg w
\]

Το σήμα που εκπέμπουμε κατά AM είναι το εξής:
\[
\mathlarger{
	\mathlarger{
		\mathlarger{
			s(t) = A_c\left[ 1 + k_a \cdot m(t) \right]\cos(2\pi f_c t)
		}
	}
}
\]
το οποίο μπορεί να εκφράζεται σε Volt ή Ampere και ίσως εκπέμπεται από κάποια κεραία.

Γραφικά: \\* {\centering
\begin{tikzpicture}[scale=1.2,xscale=1.3]
\def\f{1.3+0.30362*\x-6.94276*\x^2+5.23511*\x^3-0.0466465*\x^4-0.696833*\x^5+0.128634*\x^6}
%coordinates {(0,1.5) (0.7,0) (1.2,-0.5) (1.5,0) (2,1.5)  (3,1.5) (3.2,1.5)}
\draw (0,-1.5) -- (0,2);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f}) (0,1.3) node[left] {$m(t)$};

\begin{scope}[yshift=-4cm]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);

\draw[thick,blue!70!black,variable=\x,samples=\gsamples,domain=0:3,smooth] plot ({\x},{(1.5*sin(\x r*40))}) (0,1.5) node[above right] {$c(t)$};
\draw (0,-1.5) node[left] {$-A_c$};
\draw (0,1.5) node[left] {$A_c$};
\end{scope}

\begin{scope}[xshift=5cm]
\draw (0,-0.5) -- (0,3);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples={\gsamples/2},domain=0:3,opacity=.05]
plot ({\x},{\f}) (0,1.3);
\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3,smooth]
plot ({\x},{\f+1}) (0,1.3+1) node[left] {$\left[1+k_am(t)\right]$};
\end{scope}

\begin{scope}[xshift=5cm,yshift=-4cm]
\draw[thin,dashed,cyan!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f+1}) (0,1.3+1);
\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{(\f+1)*sin(\x r*40)}) (1.3+1,0);

\draw[->,cyan!70!blue] (2.65,3) to[bend left] ++(1,1) node[above right] {Περιβάλλουσα};

\draw (0,-3) -- (0,3);
\draw (0,0) -- (3,0);
\end{scope}
\end{tikzpicture}
}

Η περιβάλλουσα του διαμορφωμένου σήματος περιέχει την πληροφορία που θέλουμε.

Η σταθερά \( k_a \) ονομάζεται \textbf{ευαισθησία πλάτους} του διαμορφωτή, και θέλουμε
να είναι τέτοια ώστε \( \left[1 + k_a m(t)\right] > 0 \), διότι σε διαφορετική περίπτωση:

\begin{tikzpicture}[scale=1,xscale=1.3]
\def\f{1.3+0.30362*\x-6.94276*\x^2+5.23511*\x^3-0.0466465*\x^4-0.696833*\x^5+0.128634*\x^6}
%coordinates {(0,1.5) (0.7,0) (1.2,-0.5) (1.5,0) (2,1.5)  (3,1.5) (3.2,1.5)}
\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);

\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{\f}) (0,1.3);

\begin{scope}[xshift=5cm]
\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{(\f)*sin(\x r*40)}) (1.3+1,0);
\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:3]
plot ({\x},{abs(\f)}) (0,1.3);

\draw (0,-2) -- (0,2);
\draw (0,0) -- (3,0);
\end{scope}
\end{tikzpicture}

Επειδή ο αποδιαμορφωτής βλέπει μόνο τις θετικές κορυφές του σήματος, εδώ δεν έχει μεταφέρει
σωστά την πληροφορία στα σημεία όπου \(  \left[1 + k_a m(t)\right] < 0  \), αλλά την έχει
μεταφέρει ανεστραμμένη. Αυτό ονομάζεται \textbf{υπερδιαμόρφωση}.

Επομένως, θέλουμε:
\begin{align*}
	1+ k_a m(t) &\geq 0 \implies \\
	\Aboxed{\left\lvert k_a m(t) \right\rvert &\leq 1} \implies \\
	-1 \leq k_a m(t) &\leq 1
\end{align*}

Παρατηρούμε ότι για να μην έχουμε υπερδιαμόρφωση, το σήμα μας δεν μπορεί να αποκτά πολύ
μεγάλο πλάτος.

\begin{defn}{Ποσοστό διαμόρφωσης}{}
	Ως \textbf{ποσοστό διαμόρφωσης} ορίζουμε:
	\[
	\left\lvert
	\max k_a m(t)
	\right\rvert \cdot 100
	\]
\end{defn}

\paragraph{}
Ξαναγράφουμε το σήμα και παίρνουμε το μετασχηματισμό Fourier:
\begin{align*}
	s(t) &= A_c \cos 2\pi f_c t + Ak_a m(t) \cos 2\pi f_c (t) \\
	S(f) &=
	\frac{A_c}{2}\left[ δ(f-f_c)+δ(f+f_c) \right]
	+ \frac{k_aA_c}{2}\left[ M(f-f_c) + M(f+f_c) \right]
\end{align*}

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-1.2,0) node[below] {$-w$}
-- (0,1.8) node[right] {$M(0)$}
-- (1.2,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,3) node[right] {$M(f)$};

\begin{scope}[yshift=-4.5cm]
\draw[xshift=-2cm,draw=black!50!orange,dashed,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$-f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$-f_c+w$}
(0,0) node[below] {$-f_c$}
;
\draw[xshift=2cm,draw=black!50!orange,dashed,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;
\draw[ultra thick,->] (-2,0) -- ++(0,2.5)
node[above] {$\sfrac{A_c}{2}$};
\draw[ultra thick,->] (2,0) -- ++(0,2.5);

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[dashed] (-2.1,2.5) --++(4.2,0);
\draw[dashed] (-2.1,1.8) --++(4.2,0);
\draw (0,1.8) node[above right,scale=.7] {$\sfrac{1}{2}k_aA_cM(0)$};

\end{scope}
\end{tikzpicture}

Βλέπουμε ότι το φάσμα του σήματος μετακινήθηκε στη συχνότητα.

Παρατηρούμε επίσης ότι το φάσμα είναι δίπλευρο, και θυμόμαστε από το αναλογικό σήμα ότι
η αρνητική συχνότητα δεν έχει φυσική σημασία, αλλά εκφράζει τον αρνητικό εκθέτη στην
έκφραση του συνημιτόνου \( 
\mathrm{Re}\left[
\frac{e^{jωt}+e^{-jωt}}{2}
\right]
 \).
 
Αν έχουμε \textbf{μικρή συχνότητα} \( f_c \), τότε το φάσμα του σήματος περνάει το 0:

\begin{tikzpicture}[scale=1]
\draw[dashed] (0.7,0) -- ++(0,1.8);
\draw[xshift=-0.7cm,draw=orange!50!brown,,very thick,every node/.style={scale=.9}]
(-1.2,0)
-- (0,1.8)
-- (1.2,0)
(0,0)
;
\draw[xshift=0.7cm,draw=blue!50!brown,very thick,every node/.style={scale=.9}]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;

\draw[draw=gray!70!black,thin] (-3,0) -- (3,0);
\draw[->,draw=gray!70!black,thin] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[very thick,black!70!gray,->] (0,-0.75) -- ++(0,-0.5);

\begin{scope}[yshift=-4.5cm]
\draw[->,draw=gray!70!black,thin] (0,-0.5) -- (0,3) node[right] {$S(f)$};

\draw[very thick,orange!50!brown] (-1.9,0) -- (-0.7,1.8) -- (-0.5,1.5) -- (-0.49,1.5);
\draw[very thick,blue!50!brown]
(-0.5,1.5) -- (0.5,1.5);
\draw[very thick,path fading=east,orange!50!brown]
(-0.5,1.5) -- (0.5,1.5);
\draw[very thick,blue!50!brown] (0.49,1.5) -- (0.5,1.5) -- (0.7,1.8) -- (1.9,0);

\draw[draw=gray!70!black,thin] (-3,0) -- (3,0);

\end{scope}
\end{tikzpicture}

και το αποτέλεσμα είναι παραμορφωμένο και μακριά από το επιθυμητό.

Το εύρος φάσματος του σήματος είναι \( 2w \) (από \( f_c-w \) μέχρι \( f_c+w \)), το οποίο
είναι περισσότερο απ' όσο χρειάζεται (αφού το αριστερό του μέρος είναι ίδιο με το δεξί),
ενώ το σήμα είναι και ενεργειοβόρο, αφού τα \( \sfrac{2}{3}  \) της ενέργειας καταναλώνονται
στον όρο \( δ \) και όχι στην πληροφορία.

\begin{tikzpicture}[scale=0.8]
\draw[xshift=-3cm,fill=gray,fill opacity=0.04]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);
\draw[xshift=3cm,fill=gray,fill opacity=0.04]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);

\draw[xshift=-3cm,draw=black!50!orange,very thick,every node/.style={scale=.8}]
(-1.2,0) node[below] {$-f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$-f_c+w$}
(0,0) node[below] {$-f_c$}
;
\draw[xshift=3cm,draw=black!50!orange,very thick,every node/.style={scale=.8,opacity=1},
fill=lime!60!green,fill opacity=.5]
(-1.2,0) node[below] {$f_c-w$}
-- (0,1.8)
-- (1.2,0) node[below] {$f_c+w$}
(0,0) node[below] {$f_c$}
;
\draw[ultra thick,->] (-3,0) -- ++(0,2.5);
\draw[ultra thick,->] (3,0) -- ++(0,2.5);

\draw (-5.5,0) -- (5.5,0);
\draw[->] (0,-0.5) -- (0,4) node[right] {$S(f)$};

\draw[xshift=-3cm]
(-1.6,0) -- ++(0,3) -- ++(1.6*2,0) -- ++(0,-3);
\end{tikzpicture}

\subsubsection{Για ημιτονοειδή είσοδο}
Έστω ένα αρχικά ημιτονοειδές σήμα:
\[
m(t) = A_m\cos(2\pi f_mt)
\]

Τότε το διαμορφωμένο σήμα AM γίνεται:
\begin{align*}
s(t) &= A_c \left[
1 + \overbrace{μ}^{\mathclap{μ = k_aA_m}}
\cdot \cos(2\pi \cdot f_m t)
\right]\cos(2\pi f_c t)
\hspace{200pt}
\boxed{
μ \leq 1
}
\\
&= A_c\cos(2\pi f_c t) + A_c μ\cos(2\pi f_c t)\cos(2\pi f_mt)
\\ &=
A_c\cos2πf_ct + \frac{1}{2}μA_c \cos\left[2π(f_c+f_m)t\right]
+\frac{1}{2} μA_c\cos\left[
2π(f_c-f_m)t
\right]
\\
\updownarrow &\quad \text{Μ. F}
\\
S(f) &= \mathsmaller{\mathsmaller{\frac{1}{2} A_c \left[
δ(f-f_c)+δ(f+f_c) \right]
+ \frac{1}{4}μA_c \left[
δ(f-f_c-f_m)+δ(f-f_c+f_m)
\right]
+ \frac{1}{4} μA_c\left[
δ(f-f_c+f_m)+δ(f+f_c-f_m)
\right]}}
\end{align*}

Γραφικά:\nopagebreak

\begin{center}
	\begin{tikzpicture}[scale=1]
	\draw (0,-1.8) -- (0,2);
	\draw (0,0) -- (6,0);
	
	\draw[very thick,black!70!blue,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{1.4*cos(1.5*\x r)}) (1.1,1) node[] {$m(t)$};
	
	\draw (0,1.4) node[left] {$A_m$};
	\draw (0,-1.4) node[left] {$-A_m$};
	
	\draw[dashed] (2/1.5*pi,0) node[below] {$T_m=\frac{1}{f_m}$} -- ++(0,1.4);
	
	\begin{scope}[yshift=-5cm]
	\draw (0,-1.8) -- (0,2);
	\draw (0,0) -- (6,0);
	
	\draw[very thick,blue!70!cyan,variable=\x,samples=\gsamples,domain=0:6,smooth]
	plot ({\x},{1.2*sin(26*\x r)}) (1,1.2) node[above] {$c(t)$};
	
	\draw (0,1.2) node[left] {$A_c$};
	\draw (0,-1.2) node[left] {$-A_c$};
	
	\draw[dashed] (0,1.2) -- ++(6,0);
	\end{scope}
	
	\begin{scope}[yshift=-10cm]
	\draw (0,-2.5) -- (0,2.5);
	\draw (0,0) -- (6,0);
	
	\draw[dashed,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{1+0.7*cos(1.5*\x r)});
	\draw[dashed,variable=\x,samples=\gsamples,domain=0:6]
	plot ({\x},{-1-0.7*cos(1.5*\x r)});
	
	\draw[very thick,green!70!blue,variable=\x,samples=\gsamples,domain=0:6,smooth]
	plot ({\x},{(1+0.7*cos(1.5*\x r))*sin(26*\x r)}) (1.2,1.2) node[above] {$s(t)$};


	\end{scope}
	
	\begin{scope}[xshift=10cm]
	\draw (-3,0) -- (3,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$M(f)$};
	
	\draw[black!70!blue,ultra thick,->] (-0.7,0) node[below] {$-f_m$}-- ++(0,1.5);
	\draw[black!70!blue,ultra thick,->] (0.7,0) node[below] {$f_m$}-- ++(0,1.5);
	
	\begin{scope}[yshift=-5cm]
	\draw (-3,0) -- (3,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$C(f)$};
	
	\draw[blue!70!cyan,ultra thick,->] (-2.5,0) node[below] {$-f_c$}-- ++(0,1.5);
	\draw[blue!70!cyan,ultra thick,->] (2.5,0) node[below] {$f_c$}-- ++(0,1.5);
	\end{scope}
	
	\begin{scope}[yshift=-10cm]
	\draw (-3,0) -- (4,0);
	\draw[->] (0,-1) -- (0,2) node[right] {$S(f)$};
	
	\draw[blue!70!cyan,ultra thick,->] (-2.5,0) node[below] {$-f_c$}-- ++(0,1.5);
	\draw[black!70!blue,very thick,->] (-2.8,0) -- ++(0,0.7);
	\draw[black!70!blue,very thick,->] (-2.2,0) -- ++(0,0.7);
	
	\draw[blue!70!cyan,ultra thick,->] (2.5,0) node[below,scale=1] {$f_c$}-- ++(0,1.5);
	\draw[black!70!blue,very thick,->] (2.2,0) node[below left,scale=.9] {$f_c-f_m$}-- ++(0,0.7);
	\draw[black!70!blue,very thick,->] (2.8,0) node[below right,scale=.9] {$f_c+f_m$}-- ++(0,0.7);
	\end{scope}
	\end{scope}
	\end{tikzpicture}
\end{center}

\[
\underset{\substack{\downarrow\\\mathclap{\text{Bandwidth}}}}{\mathrm{B_T}}
=2f_m = 2w
\]

Επίσης προκύπτει ότι:
\begin{align*}
\frac{A_{\max}}{A_{\min}} &= \frac{A_c(1+μ)}{A_c(1-μ)} \implies \\
μ &= \frac{A_{\max} -A_{\min} }{A_{\max} + A_{\min}}
\end{align*}

\subsubsection{Ισχύς}
\label{am.power}
Αν μας ζητούνταν η ισχύς του σήματος, θα απαντούσαμε \( \frac{1}{2}A_c^2R \), αν θεωρήσουμε
ότι το σήμα είναι μια ένταση ρεύματος που διαρρέει κάποια αντίσταση \( R \). Στα σήματα
όμως θεωρούμε ότι η αντίσταση αυτή είναι 1, άρα παίρνουμε ίδιο αποτέλεσμα, είτε θεωρούμε ότι
το σήμα αναπαριστά ρεύμα, είτε τάση.

Επομένως η ισχύς π.χ. του φέροντος είναι:
\[
\boxed{
\frac{1}{2}A_c^2
	}
\]

Το πλευρικό σήμα για ημιτονοειδή είσοδο έχει ενέργεια:
\[
2\times \frac{1}{8}μ^2A_c^2
\]

και ο λόγος του με τη συνολική ενέργεια είναι:
\[
\frac{2\cdot \frac{1}{8} μ^2A_c^2}{\frac{1}{2}A_c^2+2\cdot\frac{1}{8}μ^2A_c^2}
= \frac{μ^2}{2+μ^2}
\]

Γραφικά:

\begin{tikzpicture}
\def\c{gray!50!black}
\draw (0,0) -- (4,0) node[below] {$μ$};
\draw (0,-0.5) -- (0,4) node[left] {Ισχύς \%};

\draw[\c,thin] (3,-0.5) -- (3,4);

\draw (0,0) node [below left] {$0$};
\draw (3,0) node [below left] {$1$};

\draw[\c,thin] (0,1) node[left] {$\sfrac{1}{3}$} -- (4,1);
\draw[\c,thin] (0,2) node[left] {$\sfrac{2}{3}$} -- (4,2);
\draw[\c,thin] (0,3) node[left] {$\sfrac{3}{3}$} -- (4,3);

\draw[gray,dashed] (0.2*3,-0.4) node[right,scale=.8] {$0.2=20\%$} -- (0.2*3,4);
\draw[gray,dashed] (0.2*3,{3*0.2^2/(2+0.2^2)}) -- ++(-0.2*3,0)
node[scale=0.6,left] {$2\%$};

\draw[->,black!80!brown] (1.51,2.67) to[bend left=20] ++(0.5,1.5) node[above right] {Ισχύς φέροντος};
\draw[->,black!80!brown] (2.61,0.82) to[bend right=20] ++(0.8,-0.5) node[right] {
	Ισχύς πλευρικών συνιστωσών};

\draw[very thick,black!80!brown,variable=\m,domain=0:3,samples=\gsamples]
plot ({\m}, {3*(\m/3)^2/(2+(\m/3)^2)});
\draw[very thick,black!80!brown,variable=\m,domain=0:3,samples=\gsamples]
plot ({\m}, {3-3*(\m/3)^2/(2+(\m/3)^2)});
\end{tikzpicture}

Όσο αυξάνουμε το \( μ \), αυξάνεται το ποσοστό της ισχύος που καταναλώνεται για τη μετάδοση
του σήματος και όχι του φέροντος, αλλά η ισχύς του φέροντος συνεχίζει να είναι μεγάλη.

\subsubsection{Διαμορφωτής AM}
Ένα ερώτημα που προκύπτει είναι ποιό κύκλωμα θα πραγματοποιήσει τον πολλαπλασιασμό του
σήματος με το φέρον. Για αυτό παρουσιάζεται το παρακάτω κύκλωμα, που λειτουργεί
ως \textbf{διαμορφωτής AM (διακοπτικός - switching modulator)}:

\begin{circuitikz}[american,scale=1.3]
	\draw (0,0) to[esource,label=$m(t)$] (0,2)
	to[sV,label={$c(t)\equals A_c\cos(2πf_ct)$}] (2,2)
	to[D] (4,2)
	to[R=$R_L$] (4,0)
	-- (0,0);
	
	\draw (2,2) to[open,v=$v_1(t)$,*-*] (2,0);
	\draw (4,2) -- (5,2) to[open,v^=$v_2(t)$,o-o] (5,0) -- (4,0);
\end{circuitikz}

Επίσης απαιτούμε το σήμα \( m(t) \) να έχει \textbf{αρκετά μικρότερο πλάτος} από το φέρον:
\[
\left\lvert  m(t) \right\rvert \ll A_c
\]

Τότε, η τάση \( u_1 \) γίνεται:
\[
u_1(t) = m(t)+A_c \cos(2πf_ct)
\]

%\def\gsamples{700}
\begin{tikzpicture}
\draw (0,0) -- (6,0);
\draw[->] (0,-2) -- (0,3) node[left] {$u_1(t)$};

\draw[very thick,blue!50!black] plot
[variable=\t,domain=0:5,samples=\gsamples,smooth]
(\t,{2*cos(2*\t r)+0.2*cos(43.7*\t r)})
;

\draw[dashed] (2*pi/2,0) node[below] {$\sfrac{1}{f_c}$} -- ++(0,2);
\end{tikzpicture}

Και, αφού θυμηθούμε την καμπύλη λειτουργίας της διόδου, \begin{tikzpicture}[baseline,scale=0.4,every node/.style={scale=.7}]
\draw (-2,0) -- (2,0) node[below] {$u_1(t)$};
\draw[->] (0,-1) -- (0,2) node[above] {$u_2(t)$};

\draw[very thick,blue!50!black] (-2,0) -- (0,0) -- (2,2);
\end{tikzpicture}, ισχύει:
\[
u_2(t) \simeq \begin{cases}
u_1(t), &\quad \text{όταν } c(t) > 0 \\
0,&\quad \text{όταν } c(t) < 0
\end{cases}
\]

Εναλλακτικά, μπορούμε να εκφράσουμε την \( u_2(t) \) ως γινόμενο της
εισόδου \( u_1(t) \) και μιας συνάρτησης \( g_{T_0} \) που μηδενίζεται για \( c(t) <0 \) και
είναι μονάδα για \( c(t) > 0 \), δηλαδή μιας παλμοσειράς:

\begin{center}
\begin{tikzpicture}
\draw (-4.2,0) node[left] {$\cdots$} -- (4.2,0) node[right] {$\cdots$};
\draw[->] (0,-1.5) -- (0,2) node[right] {$g_{T_0}(t)$};

\draw[blue!70!cyan,ultra thick,opacity=.1]
plot[variable=\t,domain=-4.2:4.2,samples=\gsamples]
(\t,{cos(2*pi/3*\t r}) (0,1) node[above left] {$u_1(t)$};

\draw[very thick,draw=teal] (-0.75,0) node[below] {$-\sfrac{T_0}{4}$} -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8) node[below] {$\sfrac{T_0}{4}$} ;
\draw[very thick,draw=teal] (2+0.25,0) node[below] {$\sfrac{3T_0}{4}$} -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8) node[below] {$\sfrac{5T_0}{4}$};
\draw[very thick,draw=teal] (-4+0.25,0) -- ++(0,0.8) -- ++(1.5,0) -- ++(0,-0.8);

\draw (0,0) node[below right] {$0$};
\draw[dashed] (3,0) node[below] {$T_0$} -- ++(0,0.8);
\draw[dashed] (-3,0) node[below] {$-T_0$} -- ++(0,0.8);

\draw (0,0.8) node[above right] {$1$};

\draw (current bounding box.east) node[above right] {$T_0 = \frac{1}{f_c}$};
\end{tikzpicture}
\end{center}
\begin{align*}
	u_2(t) &\simeq
	\left[
	A_c\cos 2π f_c t + m(t)
	\right] \cdot g_{T_0}(t) \\
	g_{T_0(t)} &= \frac{1}{2} + \frac{2}{\pi}
	\sum_{n=1}^\infty \frac{(-1)^{n-1}}{2n+1}\cos[2πf_ct(2n-1)]
	\intertext{Άρα}
	u_2(t) &\simeq
	\left(
	A_c\cos 2πf_ct +m(t
	\right) \cdot \left[
	\frac{1}{2} + \frac{2}{π} \cos\left(
	2πf_ct
	\right)-\frac{2}{π}\frac{1}{3}\cos(2π3f_ct)
	+ \frac{2}{π}\frac{1}{5}\cos(5f_ct)+\dots
	\right]
	\\
	&=
	\frac{A_c}{2}\cos 2 π f_ct
	+ \frac{1}{2}m(t)
	\\ &\hphantom{=}
	+ \frac{2}{π}A_c\cos 2πf_ct + \infoboxed{\frac{2}{π}m(t)\cos 2πf_c t}
	\\ &\hphantom{=}
	-\frac{2}{3π}A_c\cos 2π (3f_c) \cos 2πf_ct - \frac{2}{3π}
	m(t)\cos 2π(3f_ct)+\dots
\end{align*}

Αν σχεδιάσουμε τις συχνότητες που δίνει ο τύπος σε ένα διάγραμμα φάσματος:

\begin{tikzpicture}[scale=1.2]
\draw[->] (0,-2) -- (0,2) node[above] {$U_2(f)$}; % y axis

\draw[orange!40!brown] (-0.5,0) -- (0,0.8) -- (0.5,0);
\draw[orange!20!brown!90!black,very thick,->] (0,0) -- ++(0,1);

\draw[blue!50!green,fill opacity=0.9,fill=green!5!white,blur shadow,shadow xshift=0cm,shadow yshift=0.3mm]
(0.8,0) -- ++(0,1.2) -- ++(1+2*0.2,0) -- ++(0,-1.2);

\begin{scope}[xshift=1.5cm]
\draw[draw=orange!50!brown,thick,every node/.style={scale=.7}]
(-0.5,0) node[below] {$f_c-w$} -- (0,0.8) -- (0.5,0) node[below] {$f_c+w$} ;
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$f_c$} -- ++(0,1);
\end{scope}

\foreach \i in {3,5}
{
	\begin{scope}[xshift={\i*1.5cm}]
	\draw[orange!50!brown,thick] (-0.5,0) -- (0,0.8) -- (0.5,0);
	\end{scope}
}
\foreach \i in {2,3,...,5}
{
	\begin{scope}[xshift={\i*1.5cm}]
	\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$\i f_c$} -- ++(0,1);
	\end{scope}
}

\draw (-1,0) -- (9,0); % x axis
\draw (8.2,0.4) node[right] {$\cdots$};

\draw[gray,->,thick] (-1.75,0) to[bend right=20] ++(0.5,0);
\begin{scope}[xshift=-3.5cm]
\draw (-1.5,0) -- (1.5,0);
\draw (0,-2) -- (0,2) node[above] {$M(f)$};

\draw[draw=orange!50!brown,thick,scale=1.7]
(-0.5,0) node[below] {$-w$} -- (0,0.8) -- (0.5,0) node[below] {$w$};
\end{scope}
\end{tikzpicture}

Παρατηρούμε ότι στο φάσμα υπάρχει το επιθυμητό διαμορφωμένο AM σήμα, όπως και ο
πολλαπλασιασμός του \( m(t) \) με το φέρον. Επομένως, με ένα ζωνοπερατό φίλτρο, μπορούμε
να πάρουμε από τις άπειρες συχνότητες μόνο το τελικό φάσμα:
\begin{align*}
u(t) = &\frac{A_c}{2}\left[ 1+\frac{4}{πA_c}m(t) \right]\cos 2π f_c t
\intertext{που αντιστοιχεί στον τύπο:}
A_c\left[ 1+k_am(t) \right] \cos 2πf_c
\end{align*}

δηλαδή το κύκλωμα γίνεται:

\begin{circuitikz}[american,scale=1.3]
	\draw (0,0) to[esource,label=$m(t)$] (0,2)
	to[sV,label={$c(t)\equals A_c\cos(2πf_ct)$}] (2,2)
	to[D] (4,2)
	to[R=$R_L$] (4,0)
	-- (0,0);
	
	\draw (2,2) to[open,v=$v_1(t)$,*-*] (2,0);
	\draw (4,2) -- (5,2) to[open] (5,0) -- (4,0);
	
	% Rectangle
	\draw (5,2.5) rectangle (7,-0.5) node[align=center] (A) at (6,1) {BPF\\{%
			\footnotesize Band Pass Filter}};
	
	\draw (7,2) -- (8,2) to[open,v^=$s(t)$,o-o] (8,0) -- (7,0);
\end{circuitikz}

όπου το Band Pass Filter πρέπει να έχει κέντρο τη συχνότητα \( f_c \) και εύρος ζώνης
από \( f_c - w \) μέχρι \( f_c + w \).

Αυτό ήταν ένα παράδειγμα χρήσης \textit{μη γραμμικών στοιχείων} (δίοδος) για spectral
spread.

\subsubsection{Φωρατής περιβάλλουσας / Αποδιαμορφωτής AM}
Ο φωρατής περιβάλλουσας είναι η συσκευή που μαζεύει τις κορυφές του διαμορφωμένου σήματος
AM ώστε να παράγει το αρχικό σήμα (θυμόμαστε ότι \( s(t) = A_c\left[
1+k_a m(t)
\right] \cos(2π f_c t) \)). Η διαδικασία ονομάζεται κορυφοφώραση, και το κύκλωμα του φωρατή
δεν είναι πολύ διαφορετικό από αυτό του διαμορφωτή:

\begin{circuitikz}[american,scale=1.3,yscale=0.8]
	\draw (0,0) to[esource,l_={$s(t)$},n=sig]
	(0,2) to[R=$R_j$] (0,4)
	to [D={$z_f$},l_=$r_f$] (2,4)
	to [C=$C$] (2,0)
	-- (0,0)
	
	(2,4) to[short] (4,4)
	to[R=$R_l$] (4,0)
	-- (2,0)
	
	(4,4) to[short,-o] (6,4)
	(4,0) to[short,-o] (6,0)
	;
	
	\draw (-1,1) node[rxantenna,xscale=-1] (antenna) {};
	\draw(antenna.1) -- (sig.n);
	
	\draw (6,4) to[open,v=$s(t)$] (6,0);
\end{circuitikz}

\textbf{Πώς λειτουργεί αυτό το κύκλωμα};

Θυμόμαστε ότι η συχνότητα του φέροντος είναι πολύ μεγάλη σε σχέση με τη συχνότητα του
αρχικού σήματος (π.χ. 100 ή παραπάνω φορές μεγαλύτερη).

Η δίοδος αφήνει να περάσει ρεύμα μόνο όταν το σήμα είναι θετικό. Όταν φτάσουμε σε μία
κορυφή της διαμορφωμένης κυματομορφής, ο πυκνωτής φορτίζεται άμεσα, και ξεφορτίζεται πολύ
αργά με μία εκθετική καμπύλη, μέχρι να φτάσει στην επόμενη κορυφή:

\begin{tikzpicture}[scale=1.6]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*3};
\def\sc{1.4}

\draw[thick,green!50!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.7+0.3*cos(\f*(\t r)))});

\draw[green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=0.5mm]
(\t,{(0.7+0.3*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=-0.5mm]
(\t,{-(0.7+0.3*cos(\f*(\t r)))});

\draw[very thick,blue!75!magenta,yscale=\sc] plot[smooth]
file{data/AM_capacitor.data};

\end{tikzpicture}

Πρακτικά το κύκλωμα χωρίζεται σε δύο κομμάτια. Το αριστερό που περιλαμβάνει τη δίοδο
έχει μικρή σταθερά χρόνου και επηρεάζεται άμεσα από τις κορυφές. Το δεξί έχει μεγάλη σταθερά
χρόνου ώστε να διατηρείται η χαμηλής συχνότητας έξοδος. Ο πυκνωτής που βρίσκεται στη
μέση ανήκει και στα δύο τμήματα. Πρακτικά:
\begin{gather*}
	(R_s+r_f)C \ll \frac{1}{f_C} \\
	\intertext{και}
	\frac{1}{f_C} \ll R_l C \ll \frac{1}{w}
\end{gather*}

Για να μην υπάρχουν οι συχνότητες που προκύπτουν από την εκθετική πτώση της τάσης του
πυκνωτή ανάμεσα στις κορυφές, μπορούμε να τοποθετήσουμε στο τέλος του κυκλώματος ένα
χαμηλοπερατό φίλτρο.

\begin{circuitikz}[american,scale=1.3,yscale=0.8]
	\draw (0,0) to[esource,l_={$s(t)$},n=sig]
	(0,2) to[R=$R_j$] (0,4)
	to [D={$z_f$},l_=$r_f$] (2,4)
	to [C=$C$] (2,0)
	-- (0,0)
	
	(2,4) to[short] (4,4)
	to[R=$R_l$] (4,0)
	-- (2,0)
	
	(4,4) to[short] (5,4)
	(4,0) to[short] (5,0)
	
	(7,4) to[short,-o] (8,4)
	(7,0) to[short,-o] (8,0)
	;
	
	\draw (-2,1) node[rxantenna,xscale=-1] (antenna) {};
	\draw(antenna.1) -- (sig.n);
	
	\draw (5,4.5) rectangle (7,-0.5) node[align=center] (A) at (6,2) {LPF\\{%
			\footnotesize Low Pass Filter}};
\end{circuitikz}

Επίσης, μπορούμε να χρησιμοποιήσουμε ένα φίλτρο που κόβει τον DC όρο,
ώστε από την τιμή \( 1+k_am(t) \) του αρχικού σήματος να καταλήξουμε στην επιθυμητή
\( k_a m(t) \). Για παράδειγμα, σε μια κυματομορφή που παριστάνει ήχο, μπορούμε να
κόψουμε τις συχνότητες κάτω από 20 Hz, μαζί με το χαμηλοπερατό φίλτρο που
τοποθετήσαμε παραπάνω:

\begin{tikzpicture}[scale=1.2]
\draw[->] (-3,0) -- (3,0) node[below right] {Hz}; % x axis
\draw (0,0) -- (0,2);


\draw[orange!50!brown,very thick] plot[smooth,tension=1] coordinates {(-0.8,0) (-0.425,0.7) (-0.05,0)};
\draw[orange!50!brown,very thick] plot[smooth,tension=1] coordinates {(0.8,0) (0.425,0.7) (0.05,0)};

\draw (0.05,0) node[below,scale=0.5] {20};
\draw (0.8,0) node[below,scale=0.5] {20k};

\draw[orange!20!brown!90!black,very thick,->] (2,0) node[below,black] {$f_c$} -- ++(0,1.5);
\draw[orange!20!brown!90!black,very thick,->] (-2,0) node[below,black] {$-f_c$} -- ++(0,1.5);

\draw[thick,black!80!green] (-1,0) -- ++(0,1) -- (1,1) -- (1,0);
\draw[thick,black!70!green] (0.03,0) -- ++(0.3,1.3) -- ++(0.5,0) edge[path fading=east] ++(0.8,0);
\draw[thick,black!70!green,xscale=-1] (0.03,0) -- ++(0.3,1.3) -- ++(0.5,0) edge[path fading=west] ++(0.8,0);
\end{tikzpicture}

\paragraph{Πρόβλημα 1: Αργός πυκνωτής}
Αν ο πυκνωτής είναι πολύ αργός, μπορεί να μην προλάβει να έχει κατέβει αρκετά μέχρι την
επόμενη κορυφή, και έτσι να χαθεί κάποια πληροφορία του σήματος:

\begin{tikzpicture}[scale=1.2]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*3};
\def\sc{1.4}

\draw[thick,green!80!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.5+0.45*cos(\f*(\t r)))});

\draw[green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=0.5mm]
(\t,{(0.5+0.45*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc,yshift=-0.5mm]
(\t,{-(0.5+0.45*cos(\f*(\t r)))});

\draw[very thick,blue!75!magenta,yscale=\sc] plot[smooth]
file{data/AM_capacitor_2.data};
\end{tikzpicture}

Αυτό μπορεί να διορθωθεί βλέποντας ποιά είναι η μέγιστη ταχύτητα μεταβολή του σήματος, και
ρυθμίζοντας ανάλογα τις σταθερές της διαμόρφωσης και του αποδιαμορφωτή, ώστε να μην υπάρχει
περίπτωση κάποια κορυφή του AM να είναι κάτω από την τάση του πυκνωτή κάθε στιγμή.

\paragraph{Πρόβλημα 2: Υπερδιαμόρφωση}

Αν το αρχικό σήμα έχει πολύ μεγάλο πλάτος, δηλαδή
αν \( \left| k_a m(t) \right| > 1 \), τότε η αποδιαμόρφωση δεν θα δώσει το επιθυμητό
αποτέλεσμα, όπως είχαμε αναφέρει και παραπάνω:

\begin{tikzpicture}[scale=1.1]
\draw (0,-2) -- (0,2) node[right] {$s(t)$};
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*5};
\def\sc{1.4}

\draw[very thick,green!50!cyan] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{sin(\fc*(\t r))*(0.2+0.8*cos(\f*(\t r)))});

\draw[thick,green!50!blue,dashed] plot[smooth,domain=0:6,variable=\t,yscale=\sc]
(\t,{(0.2+0.8*cos(\f*(\t r)))})
plot[smooth,domain=0:6,variable=\t,yscale=\sc]
(\t,{-(0.2+0.8*cos(\f*(\t r)))});
\end{tikzpicture}

Αυτό μπορεί να διορθωθεί με διαφορετική επιλογή της σταθεράς \( k_a \), έτσι ώστε \( 1 + k_am(t) \geq 0 \).

\subsubsection{Και άλλοι αποδιαμορφωτές}
Ο παραπάνω αποδιαμορφωτής, όπως και ο διαμορφωτής, λειτουργεί με χρήση ενός μη γραμμικού
στοιχείου, της διόδου.

\begin{tikzpicture}[baseline,scale=0.7,every node/.style={scale=.7}]
\draw (-2,0) -- (2,0) node[below] {$u_1(t)$};
\draw[->] (0,-1) -- (0,2) node[above] {$u_2(t)$};

\draw[very thick,blue!50!black] (-2,0) -- (0,0) -- (2,2);
\draw[very thick,blue!70!black] plot[variable=\x,domain=0:2,samples=\gsamples]
(\x,{\x*\x/1.7});
\end{tikzpicture}

Η συμπεριφορά της διόδου μπορεί να προσεγγιστεί με μια σχέση της μορφής \( y= ax^2+b \).
Οπότε, ας εξετάσουμε ένα σύστημα που εξάγει το τετράγωνο μιας κυματομορφής, που είναι ένα
από τα πιο απλά παραδείγματα μη γραμμικών στοιχείων:

\begin{tikzpicture}[scale=1]
\draw (0,0) node[rectangle,draw,inner sep=5pt] (DM) {αποδιαμορφωτής τετραγωνικού νόμου};
\draw (DM.west) -- ++(-1,0) node[above right] {$u_1$};
\draw (DM.east) -- ++(1,0) node[above left] {$u_2$};

\draw (DM.south)
node[below] {$u_2(t) = a_1u_1(t) + a_2u_1^2(t)$};
\end{tikzpicture}

Γενικά, τέτοια μη γραμμικά συστήματα παράγουν πολλές συχνότητες, και μία από αυτές ίσως είναι
αυτή που επιθυμούμε.

Θα πραγματοποιήσουμε μια ανάλυση παρόμοια με τον διαμορφωτή, μελετώντας την έξοδο
του παραπάνω συστήματος στο πεδίο συχνότητας:

\todo{infobox importants}
\begin{align*}
	u_1(t) &= s(t) = A_c\left[ 1+k_am(t) \right]\cos(2π f_c t) \\
	u_2(t) &= a_1A_c\left[1+k_am(t)^2\right]\cos 2πf_c t
	+ a_2A_c^2\left[ 1+k_a m(t) \right]^2 \cos^2 2πf_c t \\
	&=             {\color{orange!20!brown!70!black} a_1A_c \cos 2πf_ct} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_1A_ck_am(t)\cos 2πf_c t} \\
	&\hphantom{=} +{\color{orange!20!brown!70!black} a_2\frac{A_c^2}{2}} \\
	&\hphantom{=} +{\color{blue!80!black}            2a_2\frac{A_c^2}{2}k_a m(t)} \\
	&\hphantom{=} +{\color{magenta!80!black}         a_2\frac{A_c^2}{2}k_a^2 m^2(t)} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_2\frac{A_c^2}{2}\cos 2π2f_c t} \\
	&\hphantom{=} +{\color{cyan!80!black}            a_2\frac{A_c^2}{2} k_a m(t) \cos 2π2f_ct} \\
	&\hphantom{=} +{\color{magenta!80!black}         a_2\frac{A_c^2}{2}k_a^2 m^2(t) \cos 2π2f_ct}
\end{align*}

Από μία ύψωση στο τετράγωνο δηλαδή προκύπτουν πολλές καινούριες συχνότητες:

\begin{tikzpicture}[scale=1.1,yscale=1.4]
\draw[->] (-2.5,0) -- (12.5,0) node[below right] {f};
\draw[->] (0,-1) -- (0,2) node[right] {$Y_2(f)$};

\draw (0,0) node[below right] {$0$};
\draw (1,0) node[below] {$\vphantom{2}w$};
\draw (2,0) node[below] {$2w$};
\draw (-1,0) node[below] {$-\vphantom{2}w$};
\draw (-2,0) node[below] {$-2w$};

\begin{scope}
\clip (-1,0) -- (0,1) -- (1,0);
\fill[red!50!green, opacity=.4, postaction={pattern=north east lines}] plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)};
\end{scope}

\begin{scope}
\clip plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)};
\fill[even odd rule,orange!90!green, opacity=.2, postaction={pattern=north west lines}] plot[smooth]
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (-1,0) -- (0,1) -- (1,0);
\end{scope}

\draw[orange!20!brown!90!black,very thick,->] (0,0)  -- ++(0,1.5);
\draw[blue!80!black,very thick] (-1,0) -- (0,1) node[right] {$m(f)$} -- (1,0);
\draw[magenta!90!blue, very thick] plot[smooth] 
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (1,0.3) node[above right] {$m^2(f)=m*m$};

\begin{scope}[xshift=5cm]
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$f_c$} -- ++(0,1.5);
\draw[cyan!80!black,very thick] (-1,0) -- (0,1)  -- (1,0);
\end{scope}

\begin{scope}[xshift=10cm]
\draw[orange!20!brown!90!black,very thick,->] (0,0) node[below,black] {$2f_c$} -- ++(0,1.5);
\draw[cyan!80!black,very thick] (-1,0) -- (0,1)  -- (1,0);
\draw[magenta!90!blue, very thick] plot[smooth] 
coordinates {(-2,0) (-1,0.4) (1,0.4) (2,0)} (1,0.3);
\end{scope}
\end{tikzpicture}

Φαίνεται, όπως είδαμε και στο προηγούμενο κύκλωμα, ο DC όρος στο \( f=0 \), τα ripples στις
υψηλότερες συχνότητες, αλλά και μία παραμόρφωση που οφείλεται στον όρο \( m^2(t) \), η
οποία, αφού προκύπτει από συνέλιξη του \( m(t) \) (εύρος ζώνης \( w \)) με τον εαυτό του,
έχει εύρος ζώνης:
\[
a_2\frac{A_c^2}{2}k_a^2 m^2(t)
\]

Για να μειωθεί η παραμόρφωση αυτή, πρέπει να μειώσουμε τον όρο \( k_a^2m^2(t) \), ή ισοδύναμα
τον \( k_a m(t) \):
\[
k_a^2m^2(t) \ll k_am(t) \ll 1
\]

\subsection{DSB-SC}
\label{dsb-sc}
\subsubsection{Στο δρόμο για την κατανάλωση λιγότερης ισχύος}
Θυμόμαστε το σήμα:
\begin{align*}
	s(t) &=
	A_c\left[1+k_a m(t)\right]\cos 2πf_c t
	\\
	&= \underbrace{A_c \cos 2π f_c t} + A_c k_a m(t) \cos 2π f_c t
\end{align*}

Τι γίνεται αν αφαιρέσουμε τον όρο \( A_c \cos 2πf_c t \), ο οποίος
δεν περιέχει πληροφορία, αλλά καταναλώνει μόνο παραπάνω ισχύ (θυμόμαστε
ότι ο όρος αυτός υπάρχει για την αποδιαμόρφωση);

Τότε θα πάρουμε ένα άλλο σήμα:
\[
\boxed{s(t) = A_c m(t) \cos 2π f_c t}
\]
το οποίο ονομάζουμε διαμορφωμένο κατά \textbf{DSB-SC} (Double Side Band - Supressed Carrier).

Μετασχηματισμένο κατά Fourier:
\[
S(f) =
\frac{1}{2} A_c \left[
M(f-f_c) + M(f+f_c)
\right]
\]

Δηλαδή το σήμα εξόδου αποτελείται από το αρχικό σήμα, μετατοπισμένο
μόνο κατά τη συχνότητα:

\begin{center}
\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4) node[right] {$M(0)$}
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,2.5) node[right] {$M(f)$};

\draw[->,very thick, blue!60!black]
(2.5,1.25) -- ++(2,0);

\begin{scope}[xshift=9cm]
\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[below] {$-f_c$}
;
\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[below] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,2.5) node[right] {$S(f)$};

\draw[dashed] (-2.1,1.4) --++(4.2,0);
\draw (0,1.4) node[above right] {$\sfrac{1}{2}A_cM(0)$};
\end{scope}
\end{tikzpicture}
\end{center}


Στο πεδίο του χρόνου, το σήμα φαίνεται κάπως έτσι:

\begin{tikzpicture}[scale=1.1]
\draw (0,-2) -- (0,2);
\draw (0,0) -- (6,0);

\def\f{2*3.14*0.22};
\def\fc{2*3.14*5};
\def\sc{1.4}

\draw[very thick,blue!50!black] plot[smooth,domain=0:6,variable=\t,samples=\gsamples,yscale=\sc]
(\t,{(1-0.1*\t)*sin(\fc*(\t r))*(0.2+0.8*cos(\f*(\t r)))});

\draw[thick,green!50!blue] plot[smooth,domain=0:6,variable=\t,yscale=\sc*1.1]
(\t,{(1-0.1*\t)*(0.2+0.8*cos(\f*(\t r)))});
\draw[thick,green!80!cyan] plot[smooth,domain=0:6,variable=\t,yscale=\sc*1.1]
(\t,{-(1-0.1*\t)*(0.2+0.8*cos(\f*(\t r)))});
\end{tikzpicture}


Παρατηρούμε την αρχική κυματομορφή, η οποία αποκτά και αρνητικές τιμές,
με αποτέλεσμα η χρήση του αποδιαμορφωτή AM που χρησιμοποιήσαμε και
προηγουμένως να μην είναι εφικτή.

Στην πραγματικότητα, ο σχεδιασμός ενός αποδιαμορφωτή AM είναι
πιο δύσκολος.

\subsubsection{Αποδιαμορφωτής}
\label{dsbsc.demodulator}

Σχεδιάζουμε το κύκλωμα του αποδιαμορφωτή ως έναν πολλαπλασιαστή
του φέροντος με το διαμορφωμένο σήμα, φροντίζοντας να μην ξεχάσουμε
το δικό μας φέρον να έχει την \textbf{κατάλληλη φάση} \( φ \) που να αντιστοιχεί
στη φάση του φέροντος του λαμβανόμενου σήματος:

\begin{circuitikz}[scale=2]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	
	\draw[<-] (mult.west) -- ++(-1,0) node[above,midway] {$s(t)$};
	\draw[->] (mult.east) -- ++(1,0) node[above,midway] {$u(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Τότε, με λίγα μαθηματικά έχουμε:
\begin{align*}
	u(t) &=
	s(t)\cdot c(t) =
	A_c \cos(2π f_c t + φ)A_C m(t)\cos(2πf_c t)
	\\ &=
	\frac{1}{2} A_c A_c'
	m(t) \cos(2π2f_ct + φ) + \frac{1}{2}A_cA_c' m(t)\cos φ
\end{align*}
Και, εφαρμόζοντας ένα φίλτρο LPF που κόβει τις υψηλές συχνότητες \( 2π2f_c \):
\begin{tikzpicture}[scale=0.3,baseline]
\filldraw[fill=green!80!black,fill opacity=.1] (-1.2,0) -- (-1,1.8) -- (1,1.8) -- (1.2,0);

\draw[draw=blue!50!brown,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw[draw=red,opacity=.8,xshift=3cm,thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw[draw=red,opacity=.8,xshift=-3cm,thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
;

\draw (-5,0) -- (5,0);
\draw (0,-0.5) -- (0,2.5);
\end{tikzpicture}%
\begin{align*}
	\left. u(t) \right\lvert_{\mathrm{LPF}}
	&= \frac{1}{2} A_c A_c' m(t) \cos φ
\end{align*}

Στο τελικό αποτέλεσμα έχουμε το επιθυμητό \( m(t) \), και έναν
όρο \( \boxed{\cos φ} \). Όταν η γωνία \( φ \) (που εκφράζει τη διαφορά
φάσης μεταξύ του φέροντος του δέκτη και του πομπού) είναι 0, τότε
\( \cos φ = 1 \), και το σήμα έχει πλήρες πλάτος. Όταν έχουμε
\( φ = \pm \frac{π}{2} \) όμως, ο διαμορφωτής και ο
αποδιαμορφωτής δεν είναι συγχρονισμένοι, και δεν παίρνουμε καθόλου
σήμα.

Ο λόγος που ήταν δύσκολο να υλοποιηθούν τέτοια κυκλώματα ήταν
η έλλειψη φθηνών κυκλωμάτων συγχρονισμού τα οποία μπορούν να παρακολουθήσουν
τη φάση \( φ \). Η φάση του φέροντος μπορεί να επηρεαστεί από
εμπόδια που υπάρχουν στη διαδρομή του κύματος, κάτι που οδηγούσε και
στα φαινόμενα των \textit{διαλείψεων} στα παλιότερα ραδιόφωνα.
Για συγχρονισμό της φάσης μπορεί να χρησιμοποιηθεί ένα σύστημα
αυτομάτου ελέγχου PLL (Phase-Locked Loop).

Τελικά, το κύκλωμα προκύπτει:

\begin{circuitikz}[scale=2]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (1.3,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) -- ++(-1,0) node[above,midway] {$s(t)$};
	\draw(mult.east) -- (lpf.west);
	\draw[->] (lpf.east) -- ++(0.5,0);
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

\subsubsection{Δακτυλιοειδής διαμορφωτής (ring modulator)}
Προκύπτει το ερώτημα πώς μπορούμε να υλοποιήσουμε κυκλωματικά
έναν πολλαπλασιαστή. Έστω λοιπόν ότι θέλουμε να πολλαπλασιάσουμε
ένα σήμα \( m(t) \) με ένα φέρον \( A_c\cos2π f_ct \).

Για αυτόν τον λόγο υπάρχει ένα κύκλωμα που ονομάζεται
\textbf{δακτυλιοειδής διαμορφωτής (ring modulator)}, με είσοδο
το \( m(t) \) και μια τετραγωνική κυματομορφή \( c(t) \) συχνότητας
\( f_c \):

\begin{circuitikz}[scale=1,american]
	\draw (0,0) node[transformer core] (t1) {};
	\draw (6,0) node[transformer core] (t2) {};
	
	\draw (t1.A1) to[open,v=$m(t)$] (t1.A2);
	\draw (t2.B1) to[open,v^=$s(t)$] (t2.B2);
	
	\draw (t1.B1) node[above] {$a$} to[diode,*-*] (t2.A1);
	\draw (t2.A1) node[above] {$b$} to[diode] ($(t2.A1)!0.6!(t1.B2)$) -- (t1.B2);
	\draw (t1.B2) node[below] {$c$} to[diode,*-*] (t2.A2);
	\draw (t2.A2) node[below] {$d$} --
	($(t2.A2)!0.48!(t1.B1)$) to[bend left=90] ($(t2.A2)!0.525!(t1.B1)$)
	to[diode] ($(t2.A2)!0.9!(t1.B1)$) 
	-- (t1.B1);
	
	\coordinate (C1) at ($(t1.B1)!0.5!(t1.B2) - (0.4,0)$);
	\coordinate (C2) at ($(t2.A1)!0.5!(t2.A2) + (0.4,0)$);
	
	\def\m{0.2}
	\def\h{2.5}
	\def\l{1.7}
	\draw (C1) to[short,*-] ++(\m,0) -- ++(0,-\h) to[short,-*] ++(\l,0) node (l1) {};
	\draw (C2) to[short,*-] ++(-\m,0) -- ++(0,-\h) to[short,-*] ++(-\l,0) node (l2) {};
	\draw (l1) to[open,v=$c(t)$] (l2);
\end{circuitikz}

Αυτό το κύκλωμα ουσιαστικά εναλλάσει την αλλαγή ή όχι του προσήμου
της κυματομορφής εισόδου:

\begin{tikzpicture}[scale=0.7]
\pgfmathdeclarefunction{mysquare}{1}{%
	\pgfmathparse{int(mod(4*#1,2))}%
	\ifnum\pgfmathresult>0 \pgfmathparse{-1}\else\pgfmathparse{1}\fi%
}

\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$c(t)$};

\def\step{0.25}
\def\ampl{1.8}
\foreach \x in {0,0.5,...,4.5} {
	\draw[thick,blue] (\x,\ampl) -- ++(\step,0) -- ++(0,-2*\ampl) -- ++(\step,0) -- ++(0,2*\ampl);
}

\draw[orange!50!brown!50!black,<->,yshift=-2mm] (0,0) -- (2*\step,0) node[midway,below,scale=.8] {$\sfrac{1}{f_c}$};

\begin{scope}[xshift=6cm]
\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$m(t)$};

\draw[very thick,blue!50!black] plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{1.5*cos(\x r)});
\end{scope}

\begin{scope}[xshift=12cm]
\draw (0,0) -- (5,0);
\draw (0,-2) -- (0,2) node[above right] {$s(t)$};

\draw[blue!50!black,densely dashed,opacity=.9]
plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{1.5*cos(\x r)})
plot [variable=\x,domain=0:5,samples=\gsamples] (\x,{-1.5*cos(\x r)});

\draw[very thick,orange!50!red] plot [variable=\x,domain=0:5,samples=\gsamples]
(\x,{mysquare(\x)*1.5*cos(\x r)});
\end{scope}
\end{tikzpicture}

Πρακτικά, πολλαπλασιάζει το \( c(t) \) με το \( m(t) \). Μαθηματικά,
παίρνουμε τη σειρά Fourier του \( c \) και βλέπουμε:
\begin{align*}
	c(t) &= \frac{4}{π}
	\sum_{n=1}^{\infty}
	\frac{(-1)^{n-1}}{2n-1}\cos\left[
	2πf_c(2n-1)t
	\right] \implies \\
	m(t)c(t) &= \frac{4}{π}m(t)
	\sum_{n=1}^{\infty}
	\frac{(-1)^{n-1}}{2n-1}\cos\left[
	2πf_c(2n-1)t
	\right]
\end{align*}

Ακριβώς όπως μελετήσαμε τον διαμορφωτή και τον αποδιαμορφωτή AM,
ίσως μέσα στις συχνότητες της παραπάνω συνάρτησης υπάρχει και το
σήμα που θέλουμε:
\begin{align*}
	n=1\qquad & \infoboxed{m(t)\frac{4}{π}\cos2πf_c t} \qquad \leftarrow \text{το επιθυμητό σήμα} \\
	n=2\qquad & m(t)\frac{4}{π}\cos2π3f_c t\\
	n=3\qquad & m(t)\frac{4}{π}\cos2π5f_c t
\end{align*}

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!80!black,fill opacity=.1]
(1.5-0.8,0) -- (1.5-0.7,1.8)
to node[midway,above,opacity=1,black] {BPF} (1.5+0.7,1.8) -- (1.5+0.8,0);

\draw[dashed] (1.5,0) node[below] {$f_c$}-- ++(0,1.4);
\draw[draw=orange!90!brown!80!black,opacity=.8,xshift=1.5cm,very thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (3.5,0) node[below] {$3f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=3.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (5.5,0) node[below] {$5f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=5.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw (6.3,0.7) node[right] {$\cdots$};

\begin{scope}[xscale=-1]
\filldraw[fill=blue!80!black,fill opacity=.1]
(1.5-0.8,0) -- (1.5-0.7,1.8)
to (1.5+0.7,1.8) -- (1.5+0.8,0);

\draw[dashed] (1.5,0) node[below] {$-f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=1.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (3.5,0) node[below] {$-3f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=3.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw[dashed] (5.5,0) node[below] {$-5f_c$}-- ++(0,1.4);
\draw[draw=orange!70!brown!70!black,opacity=.8,xshift=5.5cm,thick] (-0.6,0) -- (0,1.4) -- (0.6,0);

\draw (6.3,0.7) node[left] {$\cdots$};
\end{scope}

\draw (-6.3,0) -- (6.3,0);
\draw (0,-0.5) -- (0,2.5);
\end{tikzpicture}

Επομένως, παίρνουμε ένα band pass φίλτρο μόνο για τις συχνότητες
του \( n=1 \) και προκύπτει η ζητούμενη έξοδος \( m(t)\frac{4}{π}
\cos2πf_c t \).

Τέτοιου είδους κυκλώματα, σε συνδυασμό με το Band Pass Filter, είναι
διαθέσιμα στο εμπόριο και ονομάζονται \textbf{μίκτες (mixers)}.

Να σημειωθεί βέβαια πως για να λειτουργήσει σωστά αυτή η διάταξη,
πρέπει το κύκλωμα και τα χαρακτηριστικά των στοιχείων του
(δίοδοι, μετασχηματιστές) να είναι συμμετρικά.

Εναλλακτικά, μπορεί να χρησιμοποιηθεί για το ίδιο αποτέλεσμα
ένα κύκλωμα που ονομάζεται double-balanced modulator και λειτουργεί
με δύο όμοιους διαμορφωτές AM:

\begin{circuitikz}[scale=0.7]
	\draw(-1,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (2,2) node[draw,rectangle,align=left,inner sep=5pt,scale=.7] (am1) {AM\\διαμορφωτής};
	\draw (2,-2) node[draw,rectangle,align=left,inner sep=5pt,scale=.7] (am2) {AM\\διαμορφωτής};
	\draw (5,0) node[draw,circle,scale=1.4,thick] (add) {$+$};
	\draw (-1,-2.2) node[draw,rectangle] (o1) {$-1$};
	\draw (0,-1) node[draw,rectangle] (o2) {$-1$};
	
	\draw[->] (-3,2.2) -- (am1.west |- 0,2.2);
	\draw[<-] (o1.west) -- ++(-1,0) -- ++(0,2.2+2.2) node[circ] {};
	\draw[->] (o1.east) -- (am2.west |- 0,-2.2);
	\draw[->] (osc.east) -| (o2.north);
	\draw[->] (o2.south) |- (am2.west |- 0,-1.8);
	\draw[->] (osc.north) |- (am1.west |- 0,1.8);
	\draw[->] (am1.east) -| (add.north);
	\draw[->] (am2.east) -| (add.south);
	\draw[->] (add.east) -- ++(1,0);
\end{circuitikz}

\subsubsection{Δέκτης Costas}
Θυμόμαστε ότι για ένα σήμα:
\[
s(t) = A_cm(t) \cdot \cos(2πf_ct + φ)
\]
μπορούμε εύκολα να βρούμε τον όρο \( A_c' \cos (2πf_ct) \), αλλά όχι
τον όρο \( A_c'\cos(2πf_c t + φ) \) (εκτός ίσως αν τον επανεκπέμψουμε μόνο του από την πλευρά του πομπού με διαφορετική, π.χ διπλάσια συχνότητα, κάτι που δεν εφαρμόζεται επειδή καταναλώνονται κι άλλες
συχνότητες).

Σχεδιάζουμε έναν νέο δέκτη, ο οποίος αποτελείται από δύο απλούς
αποδιαμορφωτές της ενότητας \ref{dsbsc.demodulator}:

\begin{circuitikz}[scale=1.1]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (3,0) node[draw,rectangle,inner sep=5pt] (osc) {Ταλαντωτής}
	node[below,yshift=-3.5mm,scale=.7] {ελεγχόμενος από τάση};
	\draw (2,2) node[draw,rectangle,inner sep=5pt] (lpf1) {LPF};
	\draw (2,-2) node[draw,rectangle,inner sep=5pt] (lpf2) {LPF};
	\draw (6.5,0) node[draw,rectangle,inner sep=5pt,align=center] (pd) {Διευκρινιστής\\φάσης};
	
	\coordinate (M) at (-2,0);
	
	\draw (M) -- ++(-3,0) node[midway,above] {$A_m(t)\cos(2πft)$};
	\draw[->] (M) |- node[above right,blue!50!black] {\textbf{I}} (m1.west);
	\draw[->] (M) |- node[below right,blue!50!black] {\textbf{Q}} (m2.west);
	\draw[->] (osc) -| (m1);
	\draw[->] (osc) -| (ps) -- (m2);
	\draw[->] (m1) -- (lpf1);
	\draw[->] (lpf1) -| (pd);
	\draw[->] (m2) -- (lpf2);
	\draw[->] (lpf2) -| (pd);
	\draw[->] (pd) -- (osc);
	
	\draw (osc.north east) node[right,xshift=-1mm,yshift=2mm,orange!50!brown!50!black]
	{$\overbrace{-\phi}^{\mathclap{\text{αρνητική ανάδραση}}}$};
	\draw[blue!80!cyan,<-] ($(pd.south)!0.5!(pd.south east)$) to[bend right] ++(0.7,-0.5) node[right,scale=.9,align=center]
	{Διαιρεί τα σήματα\\$\frac{\sin\phi}{\cos\phi}=\tan\phi$};
	
	\draw[->] (pd.north |- lpf1.east) -- ++(1.5,0);
	\draw[->] (pd.south |- lpf2.east) -- ++(1.5,0);
	
	\path (lpf1) -- (pd |- lpf1) node[midway,above] {$\sfrac{1}{2}A_c\cos\phi\; m(t)$};
	\path (lpf2) -- (pd |- lpf2) node[midway,below] {$\sfrac{1}{2}A_c\sin\phi\; m(t)$};
	\path (osc -| ps) -- (m1.south) node[midway,right] {$\cos(2πf_ct)$};
	\path (ps.south) -- (m2.north) node[midway,right] {$\sin(2πf_ct)$};
\end{circuitikz}

Ο δέκτης αυτός ονομάζεται \textbf{δέκτης Costas}, και αποτελείται
από έναν ταλαντωτή \( \cos(2π f_c t + φ) \), και δύο κλάδους
αποδιαμορφωτών, από τους οποίους ο ένας πολλαπλασιάζεται με φέρον
φάσης \( φ \), και ο δεύτερος με φέρον φάσης \( φ-90\degree \).
Στη συνέχεια, τα δύο σήματα διαιρούνται ώστε να βρούμε τη γωνία
\( φ \approx \tan φ = \frac{\cos φ}{\sin φ}
= \frac{\sfrac{1}{2}A_c \cos φ m(t) }{\sfrac{1}{2} A_c \sin φ m(t) } \). Η γωνία αυτή πηγαίνει ως είσοδος στον ταλαντωτή, έτσι ώστε να
διορθωθεί η φάση του σήματος που δίνει ως έξοδο μέσω μιας διαδικασίας
αρνητικής ανάδρασης.

\subsection{QAM}
Έστω ότι έχουμε δύο σήματα, \( m_1(t) \) και \( m_2(t) \), καθώς και το γνωστό φέρον
\( c(t) = A_c\cos2πf_c t \). Διαμορφώνουμε τα σήματα κατά \hyperref[dsbsc.demodulator]{DSB-SC}, όπως
παρουσιάσαμε στην προηγούμενη ενότητα. Το ένα το διαμορφώνουμε
με φέρον \( A_c\cos 2π f_c t \), και το άλλο με φέρον
\( A_c\sin 2πf_c t \), δηλαδή φάση μικρότερη κατά \( 90\degree \).
Στο τέλος, προσθέτουμε τα δύο διαμορφωμένα σήματα:

\begin{circuitikz}[scale=1.2]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (3,2) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps) -- (m2);
	\draw[->] (m1) -- (sum) node[above,midway] {$s(t)$};
	\draw[->] (m2) -| (sum);
	\draw[->] (sum) -- ++(2,0) node[above right,pos=.2]
	{$s(t)=A_cm(t)\cos 2πf_c t + A_cm(t)\sin2πf_ct$};
	\draw[<-] (m1) -- ++(-2,0) node[above,midway] {$m_1(t)$};
	\draw[<-] (m2) -- ++(-2,0) node[below,midway] {$m_2(t)$};
	
	\path (m2) -- (m2 -| sum) node[pos=0,below right] {$s'(t) = A_cm(t)\sin2πf_ct$};
	\path (osc -| ps) -- (m1.south) node[midway,right,scale=.8] {$\cos(2πf_ct+\phi)$};
	\path (ps.south) -- (m2.north) node[midway,right,scale=.8] {$\sin(2πf_ct+\phi)$};
	
	\draw (m1.north) node[above,blue!50!black,scale=1.2] (I) {I};
	\draw (I) node[above,blue!50!black,scale=.7,yshift=2mm] {in phase};
	\draw (m2.south) node[below,blue!50!black,scale=1.2] (Q) {Q};
	\draw (Q) node[below,blue!50!black,scale=.7,yshift=-2mm] {quadrature};
	
	\draw[<-,green!50!gray] (m1.north east) to[bend left] ++(0.7,0.5)
	node[right,scale=.9] {διαμορφωτής (πολλαπλασιασμού)};
\end{circuitikz}

Δηλαδή η έξοδος είναι:
\[
s(t) = A_c m(t)\cos 2π  f_c t
+ A_c m(t) \sin 2π f_c t
\]

Για να τη μελετήσουμε στο πεδίο της συχνότητας, πρώτα θυμόμαστε τους
Μ/Σ Fourier των \( \cos \) και \( \sin \):
\begin{align*}
	\cos 2πf_c t &\leftrightarrow
	\frac{1}{2} δ(f-f_c) + \frac{1}{2}δ(f-f_c)
	\\
	\sin 2πf_ct &\leftrightarrow
	\frac{1}{2} jδ(f-f_c) + \frac{1}{2}jδ(f+f_c)
\end{align*}

Δηλαδή το πεδίο της συχνότητας περιέχει τιμές στο μιγαδικό επίπεδο,
οι οποίες μπορούν να παρουσιαστούν ως εξής:

\begin{tikzpicture}[scale=1]
\draw[brown!50!orange!50!blue,ultra thick,->]
(2,0) node[below,black,xshift=1mm] {$f_c$} -- ++(0,1.4) node[right] {$\cos t$};
\draw[brown!30!orange!30!blue,ultra thick,->]
(2,0) -- ++(0,0,2.5) node[below right] {$\sin t$};

\draw[brown!50!orange!50!blue,ultra thick,->]
(-2,0) node[below,black,xshift=2mm] {$-f_c$} -- ++(0,1.4);
\draw[brown!30!orange!30!blue,ultra thick,->]
(-2,0) -- ++(0,0,2.5);

\draw[->] (-4,0) -- (4,0) node[right] {$f$};
\draw[->] (0,-2) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{tikzpicture}

Άρα το σήμα έχει μορφή:

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4)
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-2.5) -- (0,2.5) node[right] {$M(f)$};

\draw[->,very thick, black]
(2.5,0) -- ++(2,0);

\begin{scope}[xshift=9cm]
\draw[opacity=.5,dashed] (-2,0) -- ++(0,1.4);
\draw[opacity=.5,dashed] (2,0) -- ++(0,1.4);

\draw[orange!50!black,opacity=.5] (2-1,0) |- (2,0.6) -| node[above right,scale=.8] {$2w$} (2+1,0);

\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0) -- (0,1.4) -- (0.8,0)
(0,0) node[below] {$-f_c$};

\draw[xshift=-2cm,draw=brown!50!orange,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.3}]
(-0.8,0,0) -- (0,0,3) -- (0.8,0,0);
\draw[xshift=2cm,draw=brown!50!orange,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.3}]
(-0.8,0,0) -- (0,0,3) -- (0.8,0,0);

\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0) node[below,scale=.7] {$f_c-w$}
-- (0,1.4)
-- (0.8,0) node[below,scale=.7] {$f_c+w$}
(0,0) node[below] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\end{scope}
\end{tikzpicture}

Να σημειωθεί πως το γεγονός ότι υπάρχουν και τιμές στον φανταστικό
άξονα, δεν σημαίνει ότι το σήμα δεν υφίσταται στην πραγματικότητα,
αλλά ότι περιέχει και δεδομένα στην φάση του!

Η διαδικασία της αποδιαμόρφωσης μπορεί να μας επιστρέψει και τα
δύο σήματα, όπως και στον αποδιαμορφωτή DSB-SC, πολλαπλασιάζοντας
την είσοδο αρχικά με \( \cos2π f_c t \), και μετά με \( \sin 2π f_c t \):

\begin{circuitikz}[scale=1.2,yscale=0.7]
	\draw (0,-0.75) node[draw,rectangle] (ps) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (2,2) node[draw,rectangle,inner sep=5pt] (lpf1) {LPF};
	\draw (2,-2) node[draw,rectangle,inner sep=5pt] (lpf2) {LPF};
	
	\coordinate (M) at (-1.5,0);
	
	\draw[<-] (M) -- ++(-1,0) node[midway,above] {$s(t)$};
	\draw[->] (M) |- (m1.west);
	\draw[->] (M) |- (m2.west);
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps) -- (m2);
	\draw[->] (m1) -- (lpf1);
	\draw[->] (m2) -- (lpf2);
	\draw[->] (lpf1) -- ++(2,0) node[above] {$A_c m_1(t)$};
	\draw[->] (lpf2) -- ++(2,0) node[below] {$A_c m_2(t)$};
	
	\path (ps.south) -- (m2.north) node[midway,right,scale=.7] {$\sin(2πf_ct)$};
\end{circuitikz}

Οπότε, π.χ η πρώτη έξοδος είναι:
\begin{align*}
	s(t) \cos 2π f_c t
	&= 2 A_c m_1(t) \cos^2 2π f_c t + 2A_c m_2(t)\cos2π f_c t
	\sin2πf_c t \\
	&= A_c m_1(t)
\end{align*}

Αυτή η τεχνική εκμεταλλεύεται την ορθογωνικότητα του ημιτόνου και του
συνημιτόνου ώστε να μεταδώσει διπλάσιο σήμα στο ίδιο εύρος ζώνης.
Είναι μία τεχνική \textbf{πολυπλεξίας}, και ονομάζεται
\textbf{QAM (Quadrature Amplitude Modulation - Διαμόρφωση ορθογωνικών
	φερόντων)}. Δεν χρησιμοποιούνταν σε εμπορικές εφαρμογές λόγω
του κόστους των πολλών διαμορφωτών και του κυκλώματος συγχρονισμού.

\subsection{SSB}
Αφού τα αρχικά σήματα που χρησιμοποιούμε έχουν δίπλευρο φάσμα, όταν
διαμορφωθούν, ξοδεύουν εύρος ζώνης \( 2w \), και το σήμα εμφανίζεται
δύο φορές γύρω από τη συχνότητα \( f_c \).

\begin{tikzpicture}[scale=1]
\draw[draw=orange!50!brown,very thick]
(-0.8,0) node[below] {$-w$}
-- (0,1.4)
-- (0.8,0) node[below] {$w$}
;

\draw (-2,0) -- (2,0);
\draw (0,-0.5) -- (0,2.5);

\draw[->,very thick, black]
(2.5,1) -- ++(2,0);

\begin{scope}[xshift=9cm]
\fill[opacity=.5,path fading=east,green!30!gray] (2,0) -- ++(0,1.6) -- ++(25:1.5) -- ++(0,-3.1) -- (2,-0.2);

\draw[opacity=.5] (2,0) -- ++(0,1.6) edge[path fading=north] ++(25:1.5)
(2,0) -- ++(0,-0.2) edge[path fading=south] ++(-25:1.5);


\draw[opacity=.5,dashed] (-2,0) -- ++(0,1.4);
\draw[opacity=.5,dashed] (2,0) -- ++(0,1.4);

\draw[orange!50!black,opacity=.8] (2-1,0) |- (2,-0.6) -| node[below right,scale=.8] {$2w$} (2+1,0);
\draw[orange!70!black,opacity=.8] (2,0) |- (2,-0.3) -| (2+0.8,0) node[midway,below,scale=.7] {$w$};

\draw[xshift=-2cm,draw=brown!50!orange,very thick,every node/.style={scale=.9}]
(-0.8,0) -- (0,1.4) -- (0.8,0)
(0,0);

\draw[xshift=2cm,draw=brown!50!orange,very thick]
(-0.8,0)
-- (0,1.4)
-- (0.8,0)
(0,0) node[above right] {$f_c$}
;

\draw (-4,0) -- (4,0);
\draw[->] (0,-0.5) -- (0,2.5);
\end{scope}
\end{tikzpicture}

Αν μπορούσαμε να "κόψουμε" το ένα (π.χ. το αριστερό) κομμάτι του
διαμορφωμένου σήματος, θα είχαμε την ίδια πληροφορία, αλλά θα
καταναλώναμε μισό εύρος ζώνης. Για αυτό παρουσιάζουμε παρακάτω
τη διαμόρφωση \textbf{SSB (Single Side Band)}.

Η διαμόρφωση αυτή λειτουργεί καλύτερα σε ακουστικά και όχι
οπτικά/σήματα δεδομένων, επειδή τα ακουστικά σήματα ξεκινούν από
συχνότητες 20-600 Hz, και δεν έχουν DC κομμάτι:

\begin{tikzpicture}[scale=1.2]
\draw (-3,0) -- (3,0);
\draw[->] (0,-1.5) -- (0,2.5);

\def\s{1.4}

\begin{scope}
\clip (-3,0) rectangle (3,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates {(-0.8,0) (-0.5,0.2) (0,1.4) (0.5,0.2) (0.8,0)}
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates {(-0.8,0) (-0.5,0.2) (0,1.4) (0.5,0.2) (0.8,0)}
;
\end{scope}

\draw (-0.8+\s,0) node[below] {$f_a$};
\draw (0.8+\s,0) node[below] {$f_b$};
\draw (0.8-\s,0) node[below] {$-f_a$};
\draw (-0.8-\s,0) node[below] {$-f_b$};

\draw[dashed,opacity=.5,path fading=north] (\s-0.8,0) -- ++(0,2);
\draw[dashed,opacity=.5,path fading=north] (-\s+0.8,0) -- ++(0,2);

\draw (current bounding box.east) node[right] {ακουστικό σήμα};
\end{tikzpicture}

\pagebreak[4]
Αρχικά, διαμορφώνουμε το σήμα κατά τα γνωστά, με
\hyperref[dsb-sc]{DSB-SC}:\\*%
\begin{tikzpicture}[scale=1]
\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {DSB-SC};

\def\s{3.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};
\end{tikzpicture}

και χρησιμοποιούμε ένα Band Pass φίλτρο για να πάρουμε μόνο το δεξί
μέρος του διαμορφωμένου φάσματος. Το γεγονός ότι χρησιμοποιούμε
το δεξί κομμάτι οφείλεται στην ονομασία
\textbf{USB (Upper Side Band)} της διαδικασίας
(δεν έχει σχέση με το USB του υπολογιστή!):

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.3]
(5-0.6,0) -- ++(0.1,1.2) -- ++(1.2,0) -- ++(0.1,-1.2);
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.3,xscale=-1]
(5-0.6,0) -- ++(0.1,1.2) -- ++(1.2,0) -- ++(0.1,-1.2);

\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5) node[right] {DSB-SC};

\def\s{3.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};

\begin{scope}[yshift=-5cm]
\draw (-7,0) -- (7,0);
\draw[->] (0,-1.5) -- (0,2.5);

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-\s cm-1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=\s cm+1.6 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw (\s+0.8,0) node[below] {$f_c$};
\draw (-\s-0.8,0) node[below] {$-f_c$};
\end{scope}
\end{tikzpicture}

Δρον \( \cos 2πf_c t \), και
παίρνουμε γραφικά τις συνελίξεις:

\begin{tikzpicture}[scale=1]
\filldraw[fill=blue!40!cyan!80!black,fill opacity=.15]
(-1.6,0) -- ++(0.1,1.2) -- ++(3,0) -- ++(0.1,-1.2);

\draw (-7,0) -- (7,0);
\draw[->] (0,-1) -- (0,2.5);

\def\s{2.5}
\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}

\begin{scope}
\clip (-6,0) rectangle (6,2); % clip below 0

\draw[xshift=-0.8 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;
\draw[xshift=0.8 cm,draw=brown!70!orange,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=-2*\s cm,draw=brown!50!orange!80!cyan,very thick] plot[smooth]
coordinates \four
;

\draw[xshift=2*\s cm,draw=brown!50!orange!80!cyan,very thick] plot[smooth]
coordinates \four
;
\end{scope}

\draw[ultra thick,->] (\s+0.4,0) node[below] {$f_c$} node[circle,fill,inner sep=2pt] {} -- ++(0,1.5);
\draw[ultra thick,->] (-\s-0.4,0) node[below] {$-f_c$} node[circle,fill,inner sep=2pt] {} -- ++(0,1.5);
\end{tikzpicture}

που με ένα απλό Low Pass Filter μάς δίνουν το αρχικό ακουστικό σήμα.

\vbox{
	Αν και παραστήσαμε αυτές τις αλλαγές στο πεδίο της συχνότητας, τώρα
	πρέπει να τις υλοποιήσουμε. Η δυσκολία της υλοποίησης έγκειται στο
	ότι το φίλτρο που αποκόπτει το επάνω μέρος πρέπει να έχει πολύ
	μικρή ζώνη μετάβασης. Αν μελετήσουμε την τυπική απόκριση συχνότητας 
	ενός band pass filter:

	\begin{tikzpicture}[scale=1.9]
	\draw[->] (0,-0.5) -- (0,2);
	\draw[->] (-0.5,0) -- (6,0);
	
	\def\four{(-0.6,0) (-0.4,0.2) (0,1) (0.4,0.2) (0.6,0)}
	
	\begin{scope}
	\clip (0,0) rectangle (6,2); % clip below 0
	
	\draw[xshift=2 cm,draw=brown!70!orange,very thick] plot[smooth]
	coordinates \four;
	\draw[xshift=4 cm,draw=brown!70!orange,very thick] plot[smooth]
	coordinates \four;
	\end{scope}
	
	\draw[dashed] (2+0.6,-0.1) node[below,xshift=-3mm,scale=.9] {$f_c-f_a$} -- ++(0,3);
	\draw[dashed,opacity=.5] (3,-0.1) -- ++(0,0.3);
	\draw (3,-0.1) node[below] {$f_c$};
	\draw[dashed] (4-0.6,-0.1) node[below,xshift=3mm,scale=.9] {$f_c+f_a$} -- ++(0,3);
	
	\draw[very thick,blue!50!cyan]
	(1,0) -- plot[smooth,tension=0.5]
	coordinates {(2+0.6,0) (2+0.6+0.3,0.2) (4-0.6,1.2) (4,1.34) (4+0.6,1.2) ({-0.3+4+0.6+(4-0.6)-(2+0.6))},0.2) ({4+0.6+(4-0.6)-(2+0.6))},0)}
	-- (5.9,0)
	(4,1.3) node[above,scale=.9] {BPF};
	;
	
	\draw[<->] (2+0.6,2) -- (4-0.6,2) node[above,midway,scale=.9] {600 Hz};
	\draw (3,2.5) node[above,scale=.77,green!40!black,align=center] {ζώνη\\μετάβασης};
	\end{tikzpicture}
}


Βλέπουμε ότι η ζώνη μετάβασης είναι αρκετά στενή, και η υλοποίηση
ενός τέτοιου φίλτρου γίνεται όλο και δυσκολότερη όσο αυξάνεται
η συχνότητα \( f_c \). Να σημειωθεί ότι το πλάτος της ζώνης μετάβασης
χαρακτηρίζεται από τη σχέση \( \frac{2f_a}{f_c} \), η οποία
έχει τιμή 5\% για απλά αναλογικά κυκλωματικά φίλτρα.

Για παράδειγμα, αν ο ήχος μας ξεκινάει από 300 Hz και θέλουμε να
μεταδώσουμε σε μια συχνότητα 1 Mhz, τότε η ζώνη μετάβασης έχει
πλάτος \( \frac{2\cdot 300}{10^6}
= 6\cdot10^{-4} = 0.06\% \), που είναι κάτι πολύ μικρό για τις δυνατότητες των φίλτρων.

\subsubsection{Μία τεχνική αποκοπής συχνότητας}

Για να λύσουμε το παραπάνω πρόβλημα, σκεφτόμαστε αν μπορούμε να
μετακινήσουμε ελαφρά το σήμα μας στη συχνότητα, ουσιαστικά
αυξάνοντας τη συχνότητα \( f_a \). Πράγματι, αυτό μπορεί να γίνει
εφαρμόζοντας την προηγούμενη διαδικασία (διαμόρφωση DSB-SC + BPF),
αλλά αυξάνοντας τη
συχνότητα μόνο κατά κάποια μικρή τιμή, π.χ. 10 kHz, και όχι αμέσως
1 Mhz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.6}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {600 Hz};

\filldraw[fill=blue!40!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF1};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!50!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!50!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {10 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(1)};

\draw[very thick,blue!50!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!50!cyan,xshift=3cm] \spectrum;

\draw (-2.25,0) node[below,scale=.8] {-10 kHz} ++ (90+45:0.1) -- ++(-45:0.2);
\draw (2.25,0) node[below,scale=.8] {10 kHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Πράγματι, το νέο αυτό φίλτρο έχει ζώνη μετάβασης \(
 \frac{2\cdot300}{10k} = 6\% \) που είναι όντως υλοποιήσιμο!

Συνεχίζουμε την ίδια διαδικασία, διαμορφώνοντας και 
μετακινώντας το σήμα μας αυτήν τη
φορά από τα 10 kHz μέχρι τα 100 kHz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.55}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {$2\cdot10300$ Hz};

\filldraw[fill=blue!60!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF2};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!70!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!70!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {100 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(2)};

\draw[very thick,blue!70!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!70!cyan,xshift=3cm] \spectrum;

\draw (2.3,0) node[below,scale=.8] {100 kHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Με ζώνη μετάβασης \( \frac{2\cdot 10600}{100\cdot 10^3} 
= 21.2 \% \), που είναι απόλυτα υλοποιήσιμη.

Και ξανά για 100 kHz σε 1 Mhz:

\begin{tikzpicture}[scale=.7]
\def\bw{0.55}
\def\A{1}

\def\fa{3+\bw}
\def\fb{5.8}
\def\tz{0.2}

\draw[dashed,brown] (3+\bw,0) -- ++(0,3);
\draw[dashed,brown] (4.6-\bw,0) -- ++(0,3);
\draw[brown,<->] (3+\bw,2.5) -- (4.6-\bw,2.5)
node[right,brown!60!black,scale=.7] {$2\cdot110300$ Hz};

\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15] plot[smooth,tension=0.1] coordinates {
	(\fa,0) (\fa+\tz,1.2) (\fb-\tz,1.2) (\fb,0)
};
\draw ({(\fa+\fb)/2},1.2) node[above,scale=.9,yshift=1mm] {BPF3};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw (0,-1) -- (0,3);

\def\spectrum{plot[smooth,tension=1] coordinates {(-\bw,0) (0,\A) (+\bw,0)}}

\draw[very thick,blue!90!cyan,xshift=-4.6cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=-3cm] \spectrum;

\draw[very thick,blue!90!cyan,xshift=3cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=4.6cm] \spectrum;

\draw (3.8,0) node[below,scale=.9] {1000 kHz} ++ (45+90:0.1) -- ++(-45:0.2);

\draw[very thick, brown!50!gray!20!black,>->] (6.5,0.5) -- ++(1,0);

\begin{scope}[xshift=12cm]
\draw[->] (-4,0) -- (4,0) node[below] {$f$};
\draw (0,-1) -- (0,3) node[right] {(3)};

\draw[very thick,blue!90!cyan,xshift=-3cm] \spectrum;
\draw[very thick,blue!90!cyan,xshift=3cm] \spectrum;

\draw (-2.25,0) node[below,scale=.8] {-1 MHz} ++ (90+45:0.1) -- ++(-45:0.2);
\draw (2.25,0) node[below,scale=.8] {1 MHz} ++ (45+90:0.1) -- ++(-45:0.2);
\end{scope}
\end{tikzpicture}

Με ζώνη μετάβασης \( \frac{2\cdot 110600}{10^6} 
= 22.12\%\), που είναι και αυτό υλοποιήσιμο φίλτρο, και έχουμε φτάσει
στο ζητούμενο, διαμορφωμένο κατά USB, σήμα.

Συνοπτικά, το κύκλωμα αποτελείται από μια σειρά
πολλαπλαστικών διαμορφωτών και φίλτρων:

\begin{circuitikz}
	\draw (1,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult1) {}
	node[scale=1.5] {$\times$};
	\draw (3,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf1) {}
	node[scale=1] {BPF\textsubscript{1}};
	\draw (6.5,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult2) {}
	node[scale=1.5] {$\times$};
	\draw (8.5,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf2) {}
	node[scale=1] {BPF\textsubscript{2}};
	\draw (12,0) node[rectangle,draw,minimum width=8mm,minimum height=8mm] (mult3) {}
	node[scale=1.5] {$\times$};
	\draw (14,0) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf3) {}
	node[scale=1] {BPF\textsubscript{3}};
	
	\draw (mult1) ++(0,-2) node[xshift=4.9mm,oscillator] (osc1) {} node[right,xshift=4.9mm] {10 kHz};
	\draw (mult2) ++(0,-2) node[xshift=4.9mm,oscillator] (osc2) {} node[right,xshift=4.9mm] {100 kHz};
	\draw (mult3) ++(0,-2) node[xshift=4.9mm,oscillator] (osc3) {} node[right,xshift=4.9mm] {1 MHz};
	
	\draw[<-] (mult1) -- ++(-2,0) node[above,midway] {$m(t)$};
	\draw[->] (osc1.north) -- (mult1);
	\draw[->] (osc2.north) -- (mult2);
	\draw[->] (osc3.north) -- (mult3);
	\draw[->] (mult1) -- (bpf1);
	\draw[->] (bpf1.east) node[above right] {(1)} -- (mult2);
	\draw[->] (mult2) -- (bpf2);
	\draw[->] (bpf2.east) node[above right] {(2)} -- (mult3);
	\draw[->] (mult3) -- (bpf3);
	\draw[->] (bpf3.east) -- ++ (1,0);
\end{circuitikz}

Και, αν θέλουμε, μειώνουμε τη συχνότητα του τελευταίου ταλαντωτή
ώστε το σήμα να πέσει ακριβώς επάνω στην \( f_c \) του φέροντος.

\subsubsection{Μελέτη στο πεδίο του χρόνου}
Ας μελετήσουμε και τις χρονικές εξισώσεις του LSB.

Για ευκολία, θεωρούμε ότι το σήμα μας είναι ένα ημίτονο:
\[
m(t) = A_m \cos 2π f_m(t) % ωχ! ένα συνημίτονο αντί για ημίτονο!
\]
και έχουμε και το φέρον:
\[
A_c\cos 2πf_c t
\]
με \( f_c\gg f_m \).

Από τη διαμόρφωση \hyperref[dsb-sc]{DSB-SC} θυμόμαστε ότι η έξοδος του διαμορφωτή είναι
το σήμα πολλαπλασιασμένο με το φέρον:
\[
s_{\mathrm{DSB-SC}} = \frac{1}{2}
A_cA_m\cos\left[ 2π(f_c+f_m)t \right] + \frac{1}{2}A_cA_m\cos[2π(f_c-f_m)t]
\]

\begin{tikzpicture}[scale=1]
\draw (-6,0) -- (6,0);
\draw (0,-1) -- (0,3);

\def\a{1.4}

\def\fa{-4}
\def\fb{4}
\def\tz{0.2}
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.12]
(\fa,0) -- (\fa+\tz,1.8) -- (\fb-\tz,1.8) node[above left,opacity=1] {LSB} -- (\fb,0);
\def\fa{4}
\def\fb{\fa+2}
\filldraw[fill=brown!80!orange!80!black,fill opacity=.25,path fading=east]
(\fa,0) -- (\fa+\tz,1.8) -- ++(2,0) -- ++(0,-1.8);
\draw (\fa+\tz,1.8) node[above right,opacity=1] {USB};
\filldraw[fill=brown!80!orange!80!black,fill opacity=.25,xscale=-1,path fading=west]
(\fa,0) -- (\fa+\tz,1.8) -- ++(2,0) -- ++(0,-1.8);


\draw[->,ultra thick,blue!80!brown] (-5,0) node[below] {$-f_c-f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (-3,0) node[below] {$-f_c+f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (3,0) node[below] {$-f_c-f_m$} -- ++(0,\a);
\draw[->,ultra thick,blue!80!brown] (5,0) node[below] {$-f_c+f_m$} -- ++(0,\a);

\draw[dashed] (-6,\a) -- (6,\a) node[midway,below right,scale=.8] {$\sfrac{1}{2}A_cA_m$};
\end{tikzpicture}

και για να εφαρμόσουμε USB παίρνουμε ένα υψιπερατό/ζωνοπερατό φίλτρο,
όπως φαίνεται στο διάγραμμα:
\begin{align*}
	s_{\mathrm{USSB}}(t) &= \frac{1}{2} A_cA_m\cos[2π(f_c+f_m)t]
	\\ &= \frac{1}{2}A_cA_m\cos 2πf_ct - \frac{1}{2}A_cA_m\sin2πf_ct \sin 2πf_m t
\end{align*}
και αντίστοιχα για LSB, παίρνουμε ένα χαμηλοπερατό φίλτρο για την κάτω πλευρική ζώνη:
\[
s_{\mathrm{LSSB}} =
\frac{1}{2}A_cA_m\cos 2πf_ct + \frac{1}{2}A_cA_m\sin2πf_ct \sin 2πf_m t
\]

Επομένως, μπορούμε να κατασκευάσουμε έναν διαμορφωτή, ο οποίος αφαιρεί ουσιαστικά την
κάτω πλευρική ζώνη, με βάση τους παραπάνω τύπους:

\begin{circuitikz}[scale=1]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps1) -- (m2);
	\draw[->] (m1) -| node[above right] {(1)} (sum);
	\draw[->] (m2) -| node[below right] {(2)} (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[->] (p.center) node[circ] {} -- (ps2) |- (m2);
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}

Αυτός ο υπολογισμός πραγματοποιήθηκε για έναν απλό τόνο. Ας τον εφαρμόσουμε ξανά για μια
περιοδική κυματομορφή (δηλαδή ένα άθροισμα ημιτόνων):
\[
m(t) = \sum_{n} a_n \cos(2πfnt)
\]

και τότε θα προκύψει π.χ.
\[
s_{\mathrm{USSB}}(t)
= \frac{1}{2} A_cA_m \cos 2π f_c t + \sum_n a_n\cos(2πfnt)
-\frac{1}{2}A_cA_m \sin 2πf_ct\sum_n a_n\sin(2πfnt)
\]
και το κύκλωμα διαμόρφωσης θα λειτουργεί ακριβώς με τον ίδιο τρόπο. Ακόμα και η περιστροφή
φάσης κατά \( 90\degree \), είναι ουσιαστικά ένα κύκλωμα καθυστέρησης στο χρόνο, που
ονομάζεται \textit{μετατροπέας φάσης (phase shifter)}.

Στη γενική περίπτωση, ορίζουμε ως \textbf{μετασχηματισμό Hilbert} τη στροφή της φάσης του
σήματός μας κατά \( 90\degree \), που μπορεί να πραγματοποιηθεί ακόμα και για μη περιοδικά
σήματα.

\begin{circuitikz}[scale=0.7,every node/.style={scale=.7}]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[->] (osc.west) -| (ps1) -- (m2);
	\draw[->] (m1) -| (sum);
	\draw[->] (m2) -| (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[->] (p.center) node[circ] {} -- (ps2) -- (m2);
	\draw (ps2.north) node[above,fill=white,draw=white!90!black,scale=1.4,fill opacity=.8,text opacity=1,outer sep=2pt] {Hilbert};
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}


\subsubsection{Μετασχηματισμός Hilbert}
\begin{defn}{Μετασχηματισμός Hilbert}{}
	Ο \textbf{μετασχηματισμός Hilbert} είναι ένα \textbf{φίλτρο} με συνάρτηση μεταφοράς:
	\[
	\mathlarger{H(f) = -j \sgn f}
	\]
\end{defn}
Θυμόμαστε τη συνάρτηση \( \sgn \): \begin{tikzpicture}[scale=.5,baseline]
\draw (-2,0) -- (2,0);
\draw (0,-2) -- (0,2);

\draw[red!60!orange!90!blue,ultra thick] (-2,-1) -- (0,-1) (0,1) -- (2,1) node[above] {$\sgn(f)$};
\filldraw[red!50!black,fill=white] (0,-1) circle (3pt) (0,1) circle(3pt);
%\filldraw[] (0,0) circle (2pt);
\end{tikzpicture}

Έχει κρουστική απόκριση:
\[
h(t) = \frac{1}{πt}
\]

Ο μετασχηματισμός βάζει ένα j και αλλάζει το πρόσημο της συνάρτησης.
Πιο συγκεκριμένα, μεταβάλλει το σήμα κατά \( -90\degree \) στις θετικές συχνότητες, και
\( 90\degree \) στις αρνητικές συχνότητες.
Για παράδειγμα:

\begin{tikzpicture}[scale=1]
\draw[draw=blue!50!cyan,very thick]
(-0.8,0)-- (0,1.4)-- (0.8,0);
\draw (0,1.4) node[above right] {$M(0)$};

\draw[->] (-2,0) -- (2,0) node[below] {$f$};
\draw (0,-2.5) -- (0,2.5) node[right] {$M(f)$} node[left] {Re};

\draw[>->,very thick, black]
(2.5,0) -- ++(1.5,0) node[above,midway] {Μ.H.};

\begin{scope}[xshift=7.5cm]
\draw[shading=color wheel,opacity=.2] (1.2,0,0) -- (0,0,-3) -- (0,0,0);
\draw[shading=color wheel,opacity=.2] (-1.2,0,0) -- (0,0,3) -- (0,0,0);
\draw[draw=blue!50!cyan,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.2}]
(-1.2,0,0) -- (0,0,3) -- (0,0,0);
\draw[draw=blue!50!cyan,very thick,fill=red,fill opacity=.1,postaction={pattern=north east lines,opacity=.2}]
(1.2,0,0) -- (0,0,-3) -- (0,0,0);

\draw (-1.2,0) node[above] {$-w$};
\draw (1.2,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}
\end{tikzpicture}

Ο μετασχηματισμός Hilbert είναι ένας Wide-Band Phase Shifter (WBPS). Και εδώ βρίσκεται το
πρόβλημα. Ο μετασχηματισμός Hilbert είναι ένα ιδανικό φίλτρο που δεν μπορεί να εφαρμοστεί
στην πραγματικότητα:

\begin{tikzpicture}[scale=1]
\draw[ultra thick,blue!70!green] (-3,0,2) -- (0,0,2);
\draw[ultra thick,blue!70!green] (0,0,-2) -- (3,0,-2)  node[pos=.5] (p1) {};
\fill[blue!70!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\def\act{red!80!yellow}
\begin{scope}
\clip (0,0,2) rectangle (0,0,-2);
\draw[very thick,\act,mark position=0.38(p2)] plot[smooth,tension=1] coordinates
{(-3,0,2) (0,0,1.8) (0,0,-1.8) (3,0,-2)};
\end{scope}
\draw[very thick,\act] (3,0,-1.8) -- (0,0,-1.8);
\draw[very thick,\act] (0,0,1.8) -- (-3,0,1.8);

\draw[blue!70!green,<-] (p1.center) to[bend left] ++(0.5,1) node[right] {ιδανική απόκριση};
\draw[\act!80!black,<-] (p2) to[bend right] ++(0.5,-1) node[right] {πραγματική απόκριση};

\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{tikzpicture}

Σε ακουστικά σήματα οι ατέλειες αυτές μπορούν να παραβλεφθο, αλλά σε άλλα σήματα μπορεί να
υπάρχει αισθητή παραμόρφωση.

Επομένως, και οι δύο διαμορφωτές παρουσιάζουν προβλήματα, ο πρώτος στην υλοποίηση του
φίλτρου, και ο δεύτερος στην υλοποίηση του phase shifter.

\subsubsection{Επιστροφή στο πεδίο των συχνοτήτων}
Θα αναλύσουμε το παραπάνω κύκλωμα στη συχνότητα:

\begin{circuitikz}[scale=0.9,every node/.style={scale=.9}]
	\draw (0,-0.75) node[draw,rectangle] (ps1) {$-90\degree$};
	\draw (0,2) node[draw,rectangle,scale=2,outer sep=0] (m1) {$\times$};
	\draw (0,-2) node[draw,rectangle,scale=2, outer sep=0] (m2) {$\times$};
	\draw (2,0) node[oscillator,xshift=4.9mm] (osc) {};
	\draw (4,0) node[draw,circle,scale=1.2,thick] (sum) {$\sum$};
	
	\draw[->] (osc.west) -| (m1);
	\draw[] (osc.west) -| (ps1);
	\draw[->,orange] (ps1) -- (m2);
	\draw[->,orange] (m1) -| node[above right] {(1)} (sum);
	\draw[->,magenta!70!cyan] (m2) -| node[below right] {(2)} (sum.south) node[yshift=-2mm,right] {$\pm$};
	\draw[->,black!80!brown] (sum) -- ++(1.5,0) node[right]
	{$s_{\mathrm{USSB}}(t)\Big/s_{\mathrm{LSSB}}(t)$};
	\draw[<-,draw=blue!70!cyan] (m1) -- ++(-5,0) node[above,midway] {$m(t)=A\cos2πf_m(t)$} node[pos=.5] (p) {};
	\draw[blue!70!green] (p |- 0,-2) node[draw,rectangle] (ps2) {$-90\degree$};
	\draw[blue!70!cyan] (p.center) node[circ] {} -- (ps2);
	\draw[->,orange!50!green] (ps2) -- (m2);
	
	\path (ps1.south) -- (m2.north) node[midway,right,scale=.8] {$\sfrac{1}{2}A_c\sin2πf_ct$};
\end{circuitikz}

Θυμόμαστε το σήμα κατά SSB:
\[
s_{\mathrm{USSB}}(t) = \frac{1}{2}A_c m(t) \cos 2πf_c t - \frac{1}{2}A_c \hat m(t)
\sin 2πf_c t
\]

και βλέπουμε στο πεδίο των συχνοτήτων:
\\*
\begin{tikzpicture}[scale=1]
\draw[ultra thick,blue!70!cyan] (-1,0) -- (0,1.6) -- (1,0);

\draw (-1.2,0) node[below] {$-w$};
\draw (1.2,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,blue!70!cyan] {$M(f)$};

\begin{scope}[xshift=8cm]
\draw[ultra thick,blue!70!green] (-3,0,2) -- (0,0,2);
\draw[ultra thick,blue!70!green] (0,0,-2) -- (3,0,-2);
\fill[blue!70!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,blue!70!green] {$H(f)$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}

\begin{scope}[yshift=-6cm]
\draw[ultra thick,orange!50!green] (-1,0,0) -- (0,0,2);
\draw[ultra thick,orange!50!green] (0,0,-2) -- (1,0,0);
\fill[orange!50!green] (0,0,-2) circle(2pt) (0,0,2) circle(2pt);

\draw (-1,0) node[above] {$-w$};
\draw (1,0) node[below] {$w$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,orange!50!green] {$H(f)M(f)$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);

\begin{scope}[xshift=8cm]
\draw[ultra thick,orange!50!red,->] (1.6,0,0) -- ++(0,0,-3);
\draw[ultra thick,orange!50!red,->] (-1.6,0,0) -- ++(0,0,3);
\fill[orange!50!red] (1.6,0,0) circle(2pt) (-1.6,0,0) circle(2pt);

\draw (-1.6,0) node[above] {$-f_c$};
\draw (1.6,0) node[below] {$f_c$};
\draw (0,0) node[above left] {$0$};

\draw[->] (-3,0) -- (3,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left,orange!50!red]
{$\mathrm{MF}\left[\sin(2πf_ct)\right]$};
\draw[->] (0,0,0) -- (0,0,5) node[below right] {Im};
\draw[path fading=east] (0,0,0) -- (0,0,-5);
\end{scope}
\end{scope}
\end{tikzpicture}

Μετά από τη συνέλιξη του \( H(f)M(f) \) με το μετασχηματισμό του \( \sin(2πf_ct) \),
πολλαπλασιάζονται τα φανταστικά μέρη, \( j\cdot j = -1 \), επομένως
τα σήματα που πηγαίνουν στον αθροιστή επιστρέφουν στο πραγματικό επίπεδο και μοιάζουν
κάπως έτσι:

\begin{tikzpicture}[scale=0.8]
\draw[ultra thick,magenta!70!cyan,xshift=-3cm] (-1,0) -- (0,1.6) -- (0,-1.6) -- (1,0);
\draw[ultra thick,magenta!70!cyan,xshift=+3cm] (-1,0) -- (0,1.6) -- (0,-1.6) -- (1,0) node[midway,below right] {(1)};
\draw[ultra thick,orange,xshift=-3cm,scale=1.09] (-1,0) -- (0,1.6) -- (1,0);
\draw[ultra thick,orange,xshift=3cm,scale=1.09] (-1,0) -- (0,1.6) -- (1,0) node[midway,above right] {(2)};

\draw (-3,0) node[below] {$-f_c$};
\draw ( 3,0) node[below] {$f_c$};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw[->] (0,-2.5) -- (0,2.5) node[right] {Re} node[below left]
{$\mathrm{MF}\left(m(t)\sin(2πf_ct)\right)$};
\end{tikzpicture}

Και τελικά, καθώς προστίθενται, ουσιαστικά αφαιρείται η κάτω πλευρική ζώνη, και παραμένει
μόνο η επάνω πλευρική ζώνη:

\begin{tikzpicture}[scale=0.8]
\draw[ultra thick,black!80!brown,xshift=-3cm] (-1,0) -- (-0.5,1.6) -- (0,0);
\draw[ultra thick,black!80!brown,xshift=+3cm] (1,0) -- (0.5,1.6) -- (0,0);

\draw (-3,0) node[below] {$-f_c$};
\draw ( 3,0) node[below] {$f_c$};

\draw[->] (-6,0) -- (6,0) node[below] {$f$};
\draw[->] (0,-1.5) -- (0,2.5) node[right] {Re} node[below left]
{$S_{\mathrm{USSB}}(f)$};
\end{tikzpicture}

\subsubsection{Αποδιαμόρφωση}
Το διάγραμμα του αποδιαμορφωτή είναι το εξής:

\begin{circuitikz}[scale=1.6]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (2,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) node[above left] {$s(t)$}  -- ++(-2,0) node[above right] {SSB};
	\draw[->] (mult.east) -- (lpf.west) node[above,midway,orange!20!black] {$v(t)$};
	\draw[->] (lpf.east) -- ++(0.5,0) node[right] {$u_o(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Κάνουμε τις πράξεις:
\begin{align*}
	\left. s(t)\cdot A_c' \cos(2πf_ct+φ) \right|_{\mathrm{LPF}}
	&= \frac{A_cA_c'}{4}m(t)\sin φ\cos φ
	\mp \frac{A_cA_c'}{4}\hat m(t) \sin φ
\end{align*}

Αν πετύχουμε ακριβώς τη φέρουσα συχνότητα, δηλαδή αν βρούμε τη φάση του φέροντος και
\( φ = 0 \) (που απαιτεί κύκλωμα συγχρονισμού - άρα έχουμε \textbf{ομόδυνο ή σύγχρονο}
αποδιαμορφωτή, που είναι δυσκολότερος και πιο παλιά ακριβότερος), τότε:
\[
u_o(t) = \frac{A_cA_c'}{4}m(t)
\]

Σε διαφορετική περίπτωση όμως, προστίθεται ο όρος \( \frac{A_cA_c'}{4}\hat m(t) \sin φ \),
ο οποίος είναι μια παραμόρφωση που είναι ουσιαστικά το σήμα μετασχηματισμένο κατά
Hilbert. Αυτός ο όρος εισάγει μια διαφορά φάσης, η οποία παραμορφώνει ιδιαίτερα τη
φωνή, προκαλώντας το \textbf{φαινόμενο Donald Duck}.
Αυτό απέτρεψε τη χρησιμοποίηση αυτού του είδους διαμόρφωσης στην κλασική ραδιοφωνία, παρά
μόνον συνήθως για εσωτερική χρήση στη βιομηχανία, όταν απαιτείται εξοικονόμηση φάσματος.

\subsection{VSB}
Η παραπάνω ανάλυση έχει νόημα όταν μιλάμε για ακουστικά σήματα, τα οποία δεν ξεκινάνε από
τα 0 Hz, αλλά π.χ από τα 300 Hz, επιτρέποντας την ευκολότερη υλοποίηση του φίλτρου ή του
μεταφορέα φάσης. Σε υπόλοιπα (π.χ. τηλεοπτικά) σήματα όμως δεν ισχύει αυτό:

\begin{center}
\begin{tikzpicture}
\draw (-2,0) -- (2,0);
\draw (0,-1) -- (0,2);

\draw[dashed] plot[smooth,tension=1]
coordinates {(-1.8,0) (0,1.7) (1.8,0)};

\draw[xshift=1cm,blue!50!cyan,ultra thick] plot [smooth]
coordinates {(-0.5,0) (-0.4,0.1) (0,0.6) (0.4,0.1) (0.5,0)};
\draw[xshift=-1cm,blue!50!cyan,ultra thick] plot [smooth]
coordinates {(-0.5,0) (-0.4,0.1) (0,0.6) (0.4,0.1) (0.5,0)};

\draw[green!50!yellow!50!black,<->,yshift=2mm] (-1+0.5,0) -- (+1-0.5,0) node[above,midway,scale=.7] {600 Hz};

\draw (0,-1) node[below] {ακουστικό σήμα};

\begin{scope}[xshift=5cm]
\draw (-2,0) -- (2,0);
\draw (0,-1) -- (0,2);

\draw[red!50!yellow,ultra thick,scale=.8] plot[smooth,tension=1]
coordinates {(-1.8,0) (0,1.7) (1.8,0)};

\draw (0,-1) node[below] {τηλεοπτικό σήμα};
\end{scope}
\end{tikzpicture}
\end{center}

Για αυτό το λόγο, σκεφτόμαστε ένα άλλο είδος διαμόρφωσης, στο οποίο δεν κόβουμε ολόκληρη την
π.χ. κάτω πλευρική ζώνη της πληροφορίας, αλλά επιτρέπουμε να περάσει και ένα κομμάτι από
αυτήν:
\todo{Improvise a graph}

Αυτή η διαμόρφωση ονομάζεται \textbf{VSB (Vestigial Side Band)} και έχει απόκριση της μορφής:

\begin{tikzpicture}
\draw (-6,0) -- (6,0);
\draw (0,-1) -- (0,3) node[right] {$H(f)$};

\def\fa{2+0.15}
\def\fb{5.8}
\def\tz{1}
\def\A{2}
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15,path fading=east,thick]
plot[smooth,tension=1] coordinates {
	(\fa-\tz,0) (\fa-\tz+\tz/4,\A/8) (\fa-\tz/2,\A/2) (\fa-\tz/4,7*\A/8) (\fa,\A)
}
--
plot[smooth,tension=1] coordinates {
	(\fb,\A) (\fb+\tz/4,7*\A/8) (\fb+\tz/2,\A/2) (\fb+3*\tz/4,\A/8) (\fb+\tz,0)
}
;

\draw[xshift=2cm,blue!70!black] (-1.5,0) -- (0,2) -- (1.5,0);


\draw[dashed] (2,0) node[below] {$f_c$} -- ++(0,2);
\draw[dashed,path fading=north] (\fa-\tz,0) -- ++(0,2);
\draw (\fa-\tz,0) node[below,scale=.8] {$f_c-f_v$};
\draw (2+1.5,0) node[below,scale=.8] {$f_c+w$};

\begin{scope}[xscale=-1]
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15,path fading=west]
plot[smooth,tension=1] coordinates {
	(\fa-\tz,0) (\fa-\tz+\tz/4,\A/8) (\fa-\tz/2,\A/2) (\fa-\tz/4,7*\A/8) (\fa,\A)
}
--
plot[smooth,tension=1] coordinates {
	(\fb,\A) (\fb+\tz/4,7*\A/8) (\fb+\tz/2,\A/2) (\fb+3*\tz/4,\A/8) (\fb+\tz,0)
}
;


\draw[dashed] (2,0) node[below] {$-f_c$} -- ++(0,1) edge[path fading=north] ++(0,1);
\end{scope}
\end{tikzpicture}

Βέβαια παρατηρούμε ένα πρόβλημα, το οποίο θα προσπαθήσουμε να διορθώσουμε αργότερα.
Συγκεκριμένα ότι το σήμα εξόδου μετά το φίλτρο δεν θα
περιέχει μόνο την πάνω πλευρική ζώνη, αλλά και ένα μέρος της κάτω, οδηγώντας σε κάποια
παραμόρφωση:
\\*
\begin{tikzpicture}[scale=1.2]
\draw (-1,0) -- (5,0);
\draw (0,-0.5) -- (0,3);

\def\fa{2+0.15}
\def\fb{5.8}
\def\tz{1}
\def\A{2}

\fill[red!70!blue,opacity=.2,postaction={pattern=north east lines},xshift=2cm]
plot[smooth,tension=0.5] coordinates {(0.15-1,0) (0.15-1+2.2/4,3/8) (0,2) } -- ++(0,-2);

\draw[very thick,xshift=2cm,blue!70!black]
plot[smooth,tension=0.5] coordinates {(0.15-1,0) (0.15-1+2.2/4,3/8) (0,2) } -- (1.5,0);


\draw[dashed] (2,0) node[below] {$f_c$} -- ++(0,2);
\draw[dashed,path fading=north] (\fa-\tz,0) -- ++(0,2);
\draw (\fa-\tz,0) node[below,scale=.8] {$f_c-f_v$};
\draw (2+1.5,0) node[below,scale=.8] {$f_c+w$};
\end{tikzpicture}

Ο διαμορφωτής μοιάζει κάπως έτσι:

\begin{circuitikz}[scale=1.6]
	\draw (0,-0.5) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos(2πf_c t + φ)$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (2.5,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (bpf) {}
	node[] {$H(f)$};
	
	\draw[<-] (mult.west)  -- ++(-1,0) node[midway,below] {$m(t)$};
	\draw[->] (mult.east) -- (bpf.west) node[above,midway,orange!20!black] {$u(t)$} node[below,midway] {DSB-SC};
	\draw[->] (bpf.east) -- ++(1,0) node[above,midway] {$s(t)$} node[below,midway] {VSB};
	\draw[->] (osc.north) -- (mult.south);
	
	\draw (bpf.north) node[above,scale=.9] {BPF};
\end{circuitikz}

και πολύ απλά εφαρμόζει το παραπάνω φίλτρο στην εκπεμπόμενη συχνότητα:
\begin{align*}
	S(f) &= U(f)H(f) = \frac{A_c}{2}\left[ M(f-f_c)+M(f+f_c) \right]
\end{align*}

Ο αποδιαμορφωτής είναι ομόδυνος:

\begin{circuitikz}[scale=1.6]
	\draw (0,0) node[xshift=4.9mm,oscillator] (osc) {}
	node[above right,xshift=5mm] {$A_c' \cos2πf_c t$};
	\draw (0,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (mult) {}
	node[scale=1.5] {$\times$};
	\draw (1.6,1) node[rectangle,draw,minimum width=15mm,minimum height=10mm] (lpf) {}
	node[] {LPF};
	
	\draw[<-] (mult.west) -- ++(-0.5,0) node[left] {$s(t)$};
	\draw[->] (mult.east) -- (lpf.west) node[above,midway,orange!20!black] {$v(t)$};
	\draw[->] (lpf.east) -- ++(0.5,0) node[right] {$u_o(t)$};
	\draw[->] (osc.north) -- (mult.south);
\end{circuitikz}

Για αυτόν ισχύει:
\begin{align*}
	v(t) &= A_c' \cos 2πf_c t s(t) \\
	V(f) &= \frac{A_c'}{2} \left[ S(f-f_c)+S(f+f_c) \right]
	\\ &= \frac{A_c'A_c}{4}\left[ M(f-2f_c)+M(f) \right]H(f-f_c)
	+\frac{A_c'A_c}{4}\left[ M(f)+M(f+2f_c) \right]H(f+f_c)
	\\ &= \frac{A_c'A_c}{4}M(f)\left[H(f-f_c)+H(f+f_c)\right]
	+ \frac{A_c'A_c}{4}\left[M(f-2f_c)H(f-f_c)+M(f+2f_c)H(f+f_c)\right]
\end{align*}
Ας δούμε έναν-έναν τους όρους:
\todo{Graph 64}

Παρατηρούμε ότι στο κέντρο υπάρχει η επίδραση και των δύο φίλτρων επάνω στο σήμα. Για
να πάρουμε το αρχικό, θα πρέπει η πρόσθεσή τους να μην επηρεάζει την έξοδο, δηλαδή:
\[
H(f-f_c)+H(f+f_c) = 1
\]

Σε διαφορετική περίπτωση, η έξοδος θα είναι παραμορφωμένη:

\begin{tikzpicture}
\draw (0,-1) -- (0,2);
\draw (-1,0) -- (3.5,0);

\draw[dashed,draw=gray] (2,0.5) -- (2,0) node[below] {$f$};
\draw[dashed,draw=gray] (2.7,1) -- (2.7,0) node[below] {$f_c$};

\draw[very thick,blue!80!black]
(1.7,0) -- (2,0.5) -- plot[smooth] coordinates{ (2,1) (2.35,1.04) (2.7,1) } -- (3.2,0);
\end{tikzpicture}


Ενώ, αν έχουμε σωστά ρυθμισμένα φίλτρα σύμφωνα με παραπάνω, θα προστίθενται τα δύο σήματα
για να πάρουμε το τέλειο αρχικό:

\begin{tikzpicture}
\draw (0,-0.2) -- (0,1.5);
\draw (-2,0) -- (2,0);
\draw[very thick,blue,dashed,opacity=.4]
(-1,0) -- plot[smooth] coordinates {(-0.5,0.7) (0,1.3) (0.5,0.7)} -- (1,0);

\draw[very thick,blue!80!black]
(-1,0) -- plot[smooth,tension=0.4] coordinates {(-0.5,0.7) (0,0.8) (0.5,0.7)} -- (1,0);
\draw[very thick,blue!75!black!70!magenta]
plot[smooth,tension=0.3] coordinates {(-0.5,0) (0,0.3) (0.5,0)};
\end{tikzpicture}

Δηλαδή, το χαρακτηριστικό που απαιτούμε είναι η απλώς η περιττή συμμετρία (γύρω από το
\( f_c \)) του φίλτρου, και τέτοια φίλτρα μπορούν να κατασκευαστούν:

\begin{tikzpicture}
\draw (-0.5,0) -- (9,0);
\draw (0,-1) -- (0,3);

\def\fa{3+0.15}
\def\fb{5.8}
\def\tz{2}
\def\A{2}
\filldraw[fill=blue!80!cyan!80!black,fill opacity=.15,path fading=east,thick]
plot[smooth,tension=0.75] coordinates {
	(\fa-\tz,0) (\fa-\tz+\tz/4,\A/8) (\fa-\tz/2,\A/2) (\fa-\tz/4,7*\A/8) (\fa,\A)
}
--
plot[smooth,tension=1] coordinates {
	(\fb,\A) (\fb+\tz/4,7*\A/8) (\fb+\tz/2,\A/2) (\fb+3*\tz/4,\A/8) (\fb+\tz,0)
}
;

\draw[dashed] ({\fa-\tz/2},0) node[below] {$f_c$} -- ++(0,\A/2);
\draw[dashed] ({\fa-\tz/2},\A/2) -- (0,\A/2) node[left] {$\sfrac{1}{2}$};
\draw[dashed] (0,\A) node[left] {$1$} -- (\fa,\A);
\draw[dashed,path fading=north] (\fa-\tz,0) -- ++(0,2);
\draw (\fa-\tz,0) node[below,scale=.8] {$f_c-f_v$};
\draw[dashed] (\fa,0) node[below,scale=.8] {$f_c+f_v$} -- ++(0,2);
\draw[dashed,path fading=north] ({(\fa+\fb)/2},0) -- ++(0,2);
\draw ({(\fa+\fb)/2},0) node[below,scale=.9] {$f_c+w$};
\end{tikzpicture}

Ως \underline{άσκηση για το σπίτι} αφήνεται η γεωμετρική απόδειξη του ότι η απλή συμμετρία
του φίλτρου σημαίνει ότι και το ύψος του αθροίσματος θα παραμένει σταθερό (βλ. \textbf{\hyperref[sec:interesting-question]{Κεφάλαιο
	 \ref*{sec:interesting-question}}}).

Με βάση αυτήν τη διαμόρφωση λειτουργεί η αναλογική τηλεόραση.

\subsubsection{Λίγα λόγια για την τηλεόραση}
Το εύρος ζώνης ενός τηλεοπτικού καναλιού είναι τυπικά \textit{6 MHz}, και εκπέμπεται σε
κάποια συχνότητα μεταξύ 54-216 MHz (VHF, με ένα κενό για τα FM) ή 470-890 MHz (UHF).

Ας ασχοληθούμε με ένα κανάλι μεταξύ 54-60 MHz. Αρχικά, στέλνουμε έναν κλασικό AM τόνο
στα 55.25 MHz, ο οποίος θα βοηθήσει στην αποδιαμόρφωση (ώστε να γίνει φθηνότερη):

\begin{tikzpicture}
\draw[->] (-0.2,0) -- (7,0) node[below] {MHz};
\draw (0,-0.2) -- (0,3);

\draw [draw=red!50!orange!80!gray,ultra thick,->]
(3.5,0) node[below,scale=.8] {$55.25$} -- ++(0,2);
\draw (3,0) node[above,scale=.8] {$54$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\draw (4.8,0) node[below,scale=.6,yshift=-1mm,xshift=-2mm] {$59.75$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);
\draw (5,0) node[above,scale=.8] {$60$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);
\end{tikzpicture}

Στη συνέχεια, απλώνουμε το φάσμα μεταξύ 54 ως 59.75 MHz (αφήνοντας 0.25 MHz στα δεξιά
για τον ήχο διαμορφωμένο κατά FM). Τα 1.25 MHz στα αριστερά του δέλτα είναι η κάτω πλευρική
ζώνη, και τα 4.5 στα δεξιά είναι η άνω πλευρική ζώνη.

\begin{tikzpicture}
\draw[draw=blue!50!cyan!70!black,very thick,fill=blue!50!cyan,fill opacity=.09]
plot[smooth,tension=.4] coordinates {(3,0) (3.2,1.4) (4.6,1.4) (4.8,0)};

\draw[->] (-0.2,0) -- (7,0) node[below] {MHz};
\draw (0,-0.2) -- (0,3);

\draw[dashed,draw=cyan!80!blue] (5,0) -- ++(0,1.5);

\draw [draw=red!50!orange!80!gray,ultra thick,->]
(3.5,0) node[below,scale=.8] {$55.25$} -- ++(0,2);
\draw (3,0) node[above,scale=.8] {$54$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\draw (4.8,0) node[below,scale=.6,yshift=-1mm,xshift=-2mm] {$59.75$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);
\draw (5,0) node[above,scale=.8] {$60$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\draw[blue!50!cyan,<->] (5,1) node[right,scale=.7] {$0.25$} -- ++(-0.27,0);
\draw[blue!50!cyan,<->] (3.53,0.5) -- ++(4.8-3.57,0) node[midway,above,scale=.8] {$4.5$};
\draw[blue!50!cyan,<->] (3.06,0.7) -- (3.48,0.7) node[midway,above,scale=.6] {$1.25$};
\end{tikzpicture}

Η μορφή του σήματος που στέλνουμε οφείλεται στον τρόπο που λειτουργούσαν οι τηλεοράσεις
CRT: Ένα κανόνι ηλεκτρονίων σκανάρει την οθόνη κατά γραμμές και στήλες - σκανάρει πρώτα
τα κελιά μιας γραμμής, μετά της επόμενης, κ.ό.κ. Επομένως, το σήμα αποτελείται από τις
φωτεινότητες των κελιών της πρώτης γραμμής, μετά ένα κενό (που γίνεται παλμός στο σήμα)
μέχρι το κανόνι να μεταφερθεί στην επόμενη γραμμή, στη συνέχεια τις φωτεινότητες
της επόμενης γραμμής κ.ό.κ.

Με τους παραπάνω παλμούς μπορεί τα επιτευχθεί και συγχρονισμός, ενώ κάποιες τεχνικές
πολυπλεξίας χρησιμοποιήθηκαν και για τη μεταφορά πληροφοριών χρώματος.

Από τη μεριά του δέκτη, η αποδιαμόρφωση μπορεί να γίνει χωρίς να δίνουμε πολλή σημασία
στην κάτω πλευρική ζώνη:

\begin{tikzpicture}
\draw[draw=blue!50!cyan!30!gray,very thick,fill=blue!50!cyan!10!gray,fill opacity=.15]
plot[smooth,tension=.2] coordinates {(3,0) (3.5,1.4) (4.6,1.4) (4.8,0)};

\draw[->] (-0.2,0) -- (7,0) node[below] {MHz};
\draw (0,-0.2) -- (0,3);

\draw[dashed]
(3.5,0) node[below,scale=.8] {$55.25$} -- ++(0,1.4);
\draw (3,0) node[below left,scale=.8] {$54$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\draw (4.8,0) node[below,scale=.6,yshift=-1mm,xshift=-2mm] {$59.75$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);
\draw (5,0) node[below right,scale=.8] {$60$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\end{tikzpicture}

Αντίστοιχα, ένα ψηφιακό τηλεοπτικό σήμα (π.χ. με ρυθμό 20 Mbit/s) μπορεί να χωρέσει
με παρόμοιο τρόπο στα 6 MHz:

\begin{tikzpicture}[scale=0.7]
\draw[draw=blue!50!cyan!70!black,very thick,fill=green!70!cyan,fill opacity=.19]
plot[smooth,tension=.2] coordinates {(3,0) (3.2,1.4) (4.8,1.4) (5,0)};

\draw[->] (-0.2,0) -- (7,0) node[below] {MHz};
\draw (0,-0.2) -- (0,3);

\draw [draw=red!50!orange!80!gray,ultra thick,->]
(3.2,0) node[below,scale=.7] {$54.115$} -- ++(0,2);
\draw (3,0) node[above left,scale=.8] {$54$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);

\draw (5,0) node[below,scale=.8] {$60$} node[inner sep=2pt] (m) {};
\draw (m.north) -- (m.south);
\end{tikzpicture}

\subsection{Εφαρμογές}
\paragraph{1.}
\label{application.am-phase}
Μερικές διαμορφώσεις:
\begin{alignat*}{2}
	\text{AM} \quad && s(t) &= \left(1+k_am(t)\right)\cos 2πf_c t \\
	\text{DSB-SC} \quad && s(t) &= A_c m(t)\cos 2πf_c t\\
	\text{SSB} \quad && s(t) &= \frac{1}{2} A_cm(t)\cos 2πf_c t \mp \frac{1}{2}A_c\hat m(t)\sin2π
	f_c t
	\\ && &= \frac{1}{2}A_c\sqrt{m^2(t)+\hat m^2(t)}\cos\left(2πf_c t +\phi(t)\right)
\end{alignat*}
όπου \( \displaystyle φ(τ) = \tan^{-1}\frac{\hat m(t)}{m(t)} \).

Οι πρώτες δύο διαμορφώσεις έχουν την πληροφορία μόνο στο πλάτος, αλλά η τελευταία την
περιλαμβάνει και στην φάση \( \phi(t) \).

Αν φανταστούμε όμως ότι η πληροφορία αποτελείται από δύο ψηφιακά σήματα, στα οποία το πλάτος
1 αναπαριστά το 1 και το -1 αναπαριστά το ψευδές, τότε το μέτρο θα είναι πάντα \( \sqrt{2} \),
αλλά μόνο η φάση θα μεταβάλλεται. Αυτή η διαμόρφωση χρησιμεύει για τη μετάδοση ψηφιακών δεδομένων
και ονομάζεται QPSK (Quadrature Phase-Shift Keying).

\begin{tikzpicture}[scale=.8]
\draw (0,0) -- (6,0);

\draw[dashed,gray!50!black] (3,0) -- (3,.7);

\draw[yscale=.7,very thick,blue] plot[const plot] coordinates {(0,1) (1,-1) (2,1) (3,1) (4,-1) (5,-1)};

\foreach \x in {1,2,...,5}
\filldraw[blue!20!black] (\x,0) circle (1.5pt);

\draw (4,1) node[above] {$1$};
\draw (5,-1) node[below] {$-1$};

\begin{scope}[xshift=8cm]
\draw (0,0) -- (6,0);

\draw[dashed,gray!50!black] (3,0) -- (3,.7);

\draw[very thick,cyan,opacity=.8]
plot[variable=\x,domain=0:1,samples=\gsamples]
(\x,{  0.7* cos(20*\x r)   });
\draw[very thick,cyan!80!blue,opacity=.9]
plot[variable=\x,domain=1:2,samples=\gsamples]
(\x,{  0.7* cos(20*\x r+170)   });
\draw[very thick,cyan,opacity=.8]
plot[variable=\x,domain=2:4,samples=\gsamples]
(\x,{  0.7* cos(20*\x r)   });
\draw[very thick,cyan!80!blue,opacity=.9]
plot[variable=\x,domain=4:5,samples=\gsamples]
(\x,{  0.7* cos(20*\x r+170)   });

\draw[yscale=.7,very thick,blue] plot[const plot] coordinates {(0,1) (1,-1) (2,1) (3,1) (4,-1) (5,-1)};

\foreach \x in {1,2,...,5}
\filldraw[blue!20!black] (\x,0) circle (1.5pt);

\draw (4,1) node[above] {$1$};
\draw (5,-1) node[below] {$-1$};
\end{scope}
\end{tikzpicture}

\paragraph{2.}
Έστω τα σήματα πληροφορίας και φέροντος:
\begin{align*}
	m(t) &= A_m\cos(2πf_m t) \\
	c(t) &= A_c\cos(2πf_c t)
\end{align*}

Έστω ότι θέλουμε να διαμορφώσουμε την πληροφορία κατά SSB. Πρώτα τη διαμορφώνουμε κατά DSB, και μετά
εφαρμόζουμε ένα φίλτρο:

\begin{tikzpicture}[scale=1,yscale=1.4]
\draw[top color=blue!30!cyan!60!black,bottom color=blue!20!white,fill opacity=.3]
(2-0.8,0.8) -- (2+0.8,0) -- (2-0.8,0) -- cycle;
\draw[top color=blue!30!cyan!60!black,bottom color=blue!20!white,fill opacity=.3,xscale=-1]
(2-0.8,0.8) -- (2+0.8,0) -- (2-0.8,0) -- cycle;

\draw (-4,0) -- (4,0);
\draw[->] (0,-1) -- (0,2);

\draw[gray!50!brown,dashed] (-4,1) -- (4,1) node[pos=.7,above] {$A$};

\draw[black!80!orange,very thick]
(2-0.5,0) edge[->] ++(0,1)
(2+0.5,0) edge[->] ++(0,1)
;
\draw[blue!50!cyan,ultra thick]
(2-0.5,0) edge[->] node[above right,pos=1,scale=.6] {$(1-k)A$} ++(0,0.65)
(2+0.5,0) edge[->] node[above right,pos=1,scale=.7] {$kA$} ++(0,0.15)
;

\draw (2-0.5,0) node[below,scale=.5,xshift=-3mm] {$f_c-f_m$};
\draw (2,0) node[below,scale=.5] {$f_c$};
\draw (2+0.5,0) node[below,scale=.5,xshift=3mm] {$f_c+f_m$};

\begin{scope}[xscale=-1]
\draw[black!80!orange,very thick]
(2-0.5,0) edge[->] ++(0,1)
(2+0.5,0) edge[->] ++(0,1)
;
\draw[blue!50!cyan,ultra thick]
(2-0.5,0) edge[->] ++(0,0.65)
(2+0.5,0) edge[->] ++(0,0.15)
;

\draw (2-0.5,0) node[below,scale=.45,xshift=3mm] {$-f_c-f_m$};
\draw (2,0) node[below,scale=.5] {$-f_c$};
\draw (2+0.5,0) node[below,scale=.45,xshift=-3mm] {$-f_c+f_m$};
\end{scope}
\end{tikzpicture}

Το φίλτρο αυτό κόβει την κάτω πλευρική ζώνη και αφήνει να περάσει ένα ίχνος της, και κόβει
και την πάνω πλευρική ζώνη, αφήνοντας να περάσει ένα ακόμα μικρότερο ίχνος της.

Δηλαδή κόβει ένα ποσοστό \( k \) (π.χ 2\%) από την επάνω (άρα αφήνει να περάσει το \( (1-k)
 \) ή π.χ. το 98\%), και αφήνει να περάσει ένα ποσοστό \( k \) από την κάτω (αν θεωρήσουμε
 ότι το φίλτρο είναι συμμετρικό).
 
Το αποδιαμορφωμένο σήμα θα μοιάζει κάπως έτσι:

\begin{tikzpicture}[scale=1,yscale=1.4]
\draw (-4,0) -- (4,0);
\draw[->] (0,-1) -- (0,1.5);

\draw[blue!50!cyan,ultra thick]
(1-0.5,0) edge[->] ++(0,0.65)
(1,0) edge[->] ++(0,0.15)
;
\draw (1-0.25,0) node[below] {$f_m$};

\begin{scope}[xscale=-1]
\draw[blue!50!cyan,ultra thick]
(1-0.5,0) edge[->] ++(0,0.65)
(1,0) edge[->] ++(0,0.15)
;
\draw (1-0.25,0) node[below] {$-f_m$};
\end{scope}
\end{tikzpicture}

Το διαμορφωμένο σήμα, όπως παρατηρούμε από το πεδίο των συχνοτήτων, θα έχει τη μορφή:
\begin{align*}
	s_{\mathrm{USB}}(t) &= \frac{1}{2}kA_cA_m\cos 2π(f_c+f_m)t
	+ \frac{1}{2}(1-k)A_cA_m\cos 2π (f_c-f_m)t \\
	&= \frac{1}{2}kA_cA_m\left(
	\cos2πf_ct\cos2πf_mt-\sin2πf_ct\sin2πf_mt
	\right)
	\\ &\hphantom{=} + \frac{1}{2}(1-k)A_cA_m\left(
	\cos2πf_ct\cos2πf_mt+\sin2πf_ct\sin2πf_mt
	\right)
	\\ &=
	\underbrace{\frac{1}{2}A_cA_m\cos2πf_m t\cos2πf_c t}_{\text{DSB-SC}}
	+ \underbrace{\frac{1}{2}A_cA_m(1-2k)\sin2πf_mt\sin2πf_ct}_{\text{DSB-SC στον
			μετασχηματισμό Hilbert}}
\end{align*}

Δηλαδή μπορούμε να φτάσουμε στην έξοδο διαμορφώνοντας δύο φορές κατά DSB-SC (τη
δεύτερη την εφαρμόζουμε στο phase-shifted κατά \( 90\degree \) σήμα).

Η σταθερά \( k \) εξαρτάται από την κλίση του φίλτρου που χρησιμοποιήσαμε παραπάνω.
Πιο συγκεκριμένα, έχουμε διαφορετικές περιπτώσεις:

\begin{enumpar}
	\item Για \( k=\frac{1}{2} \), έχουμε \emph{DSB-SC}
	\item Για \( k=0 \), έχουμε \emph{LSSB} \\
	Για \( k=1 \), έχουμε \emph{USSB}
	\item Για \( 0\leq k \leq \frac{1}{2} \), έχουμε \emph{VSB} (πάνω πλευρική ζώνη)
	\\
	Για \( \frac{1}{2} \leq k \leq 1 \), έχουμε \emph{VSB} (κάτω πλευρική ζώνη)
\end{enumpar}

Δηλαδή μπορούμε να πάρουμε όλες τις διαμορφώσεις που παρουσιάσαμε με κατάλληλη επιλογή
του \( k \), εκτός από το ΑΜ.

\subparagraph{}
Για την \textbf{αποδιαμόρφωση}, θα χρειαστεί σίγουρα να έχουμε \textit{σύμφωνο / σύγχρονο / ομόδυνο / coherent}
αποδιαμορφωτή (που μπορεί να βρει τη φάση του φέροντος), ο οποίος πρέπει να γνωρίζει
τη φάση του φέροντος η οποία:
\begin{itemize}
	\item Προκύπτει στον ταλαντωτή και δεν είναι γνωστή στο δέκτη
	\item Μπορεί να μεταβάλλεται αργά στον ταλαντωτή και δεν έχει σταθερή τιμή
	\item Αλλάζει ανάλογα με το μέσο διάδοσης του κύματος και τυχόν εμπόδια
\end{itemize}

Τυπικά για την υλοποίηση του αποδιαμορφωτή, αν θεωρήσουμε ότι κάπως έχουμε βρει τη
φάση του φέροντος, πολλαπλασιάζουμε το λαμβανόμενο σήμα
με τη συχνότητα του φέροντος:
\begin{align*}
	v(t) &= s_{\mathrm{USB}}(t) A_c' \cos 2πf_c t
	\\ &= \left[\frac{1}{2}A_cA_c' A_m\cos2πf_mt\right]
	\cancelto{\frac{1}{2}+\frac{1}{2}\cos2π2f_ct}{\cos^22πf_ct}
	\\ &\hphantom{=}
	+ \left[\frac{1}{2}A_cA_c'A_m(1-2k)\sin2πf_mt\right]
	\cancelto{\frac{1}{2}\sin2π2f_ct }{\sin2πf_ct\cos2πf_ct}
	\\
	\left.v(t)\right|_{\mathrm{LPF}} &= \frac{1}{4} A_cA_c' A_m\cos2πf_m t \quad
	\to m(t)
\end{align*}

Έστω όμως ότι στέλνω ένα σήμα \( s_{\mathrm{VSB}+C}(t) = A_c\cos2πf_ct +
k_as_{\mathrm{VSB}}(t) \), δηλαδή VSB μαζί όμως με το φέρον.
Τότε το σήμα που στέλνω είναι:
\begin{align*}
	s_{\mathrm{USB}+C} (t) &=
	A_c\cos2πf_c t + k_a s_{\mathrm{USB}}(t)
	\\ &= \dots =
	A_c\left[ 1+\frac{k_a}{2}A_m\cos(2πf_mt) \right]\cos2πf_c t
	+ \left[\frac{k_a}{2} A_c A_m (1-2k) \sin(2πf_mt) \right]\sin2πf_ct
	\\ &= A(t) \cdot \cos\left(2πf_ct + φ(τ)\right)
\end{align*}
όπου:
\begin{align*}
	A(t) &=
	\sqrt{A_c^2\left[ 1+\frac{k_a}{2}A_m \cos(2πf_mt) \right]^2
		+A_c^2\left[ \frac{k_a}{2}A_m(1-2k)\sin(2πf_mt) \right]^2
	} \\ &= A_c\left[ 1+\frac{k_a}{2}A_m\cos(2πf_mt) \right]
	\sqrt{1+\left(\frac{\frac{k_a}{2}A_m(1-2k)\sin2πf_ct}{
			1+\frac{k_a}{2}A_m\cos2πf_mt}\right)^2}
\end{align*}

Δηλαδή έχουμε μία διαμόρφωση AM \( 1+\frac{k_a}{2}A_m\cos(2πf_m t) \) μαζί με μία
παραμόρφωση \( \sqrt{1+(\cdots)^2} \), την οποία θέλουμε να ελαχιστοποιήσουμε όσο
περισσότερο γίνεται. Αυτό δικαιολογεί και το ότι για την αποδιαμόρφωση του τηλεοπτικού
σήματος αρκεί μόνο ένας αποδιαμορφωτής FM.

Στόχος μας είναι να ελαχιστοποιήσουμε την παραμόρφωση, άρα τον όρο:
\[
\left[\frac{μ(1-2k)\sin2πf_ct}{1+μA_m\cos2πf_mt}\right]^2
\]
(όπου \( μ = \frac{1}{2}k_aA_m \) ), τον οποίο μπορούμε να ρυθμίσουμε επιλέγοντας τις
σταθερές της διαμόρφωσης \( A_m \), το συντελεστή του φέροντος \( k_a \), ή την κλίση \( k \)
του φίλτρου.

\paragraph{3.}
Θυμόμαστε τη βασική λειτουργία του πολλαπλασιαστικού διαμορφωτή
(όπου \( f_1 \) η συχνότητα φέροντος του εισερχόμενου σήματος, και \(f_l\) η συχνότητα του τοπικού ταλαντωτή):
\\*
\begin{circuitikz}[scale=1]
	\draw (0,0) node[rectangle,draw,scale=2] (mult) {$\times$};
	\draw (2,0) node[rectangle,draw] (bpf) {BPF};
	\draw (0,-3) node[oscillator,scale=1,xshift=4.91mm] (osc) {};
	
	\draw (osc.east)  node[right] {$A_c\cos2πf_lt$};
	\draw[<-] (mult) -- ++(-5,0) node[midway,above] (ml) {$m(t)\cdot \cos2πf_1 t$} node[midway,below] {$s_1(t)$};
	\draw (ml) node[above,yshift=5pt] {DSB};
	\draw (mult) -- (bpf) node[above,midway] {$s'(t)$};
	\draw[->] (bpf) -- ++(3,0) node[below] {$s_2(t)$};
	\draw[->] (osc.north) -- (mult.south);
	
	\draw[thick,blue!30!black] (-1,1) rectangle (3,-2)
	(3,1) node[above] {Μίκτης};
\end{circuitikz}

με έξοδο:
\begin{align*}
	s'(t) &= s_1(t)A_c\cos(2πf_l t) \\
	&= \frac{1}{2}A_l m(t) \left[
	\cos2π(f_1+f_l)t + \cos 2π(f1-f_l)t
	\right]
\end{align*}
όπου μπορούμε να επιλέξουμε ποιός μόνον από τους δύο όρους (\( f_1+f_l \) ή \( f_1-f_l \), και
ονομάζουμε τη διαδικασία up conversion ή down conversion αντίστοιχα) θα βγει στην έξοδο
από το Band Pass φίλτρο. Με κατάλληλη επιλογή της \( f_l \) και του φίλτρου, μπορούμε να
ελέγξουμε ποιά συχνότητα εξόδου θέλουμε να πολλαπλασιάσουμε με το σήμα, ώστε να έχουμε
όποια μετατόπιση θέλουμε στην έξοδο:

\begin{tikzpicture}[scale=1]
	\draw (-2,0) -- (7,0);
	\draw (0,-0.5) -- (0,1);
	
	\draw[very thick,blue!50!cyan]
	(-0.6,0) .. controls (-0.4,0.8) and (-0.7,0.8) .. (0,0.8) .. controls (0.7,0.8) and (0.4,0.8) .. (0.6,0);
	\draw[very thick,blue!50!cyan,xshift=2cm]
	(-0.6,0) .. controls (-0.4,0.8) and (-0.7,0.8) .. (0,0.8) .. controls (0.7,0.8) and (0.4,0.8) .. (0.6,0);
	\draw[very thick,blue!50!cyan,xshift=4cm]
	(-0.6,0) .. controls (-0.4,0.8) and (-0.7,0.8) .. (0,0.8) .. controls (0.7,0.8) and (0.4,0.8) .. (0.6,0);
	\draw[very thick,blue!50!cyan,xshift=6cm]
	(-0.6,0) .. controls (-0.4,0.8) and (-0.7,0.8) .. (0,0.8) .. controls (0.7,0.8) and (0.4,0.8) .. (0.6,0);
	
	\draw[dashed]
	(0,0) node[below] {$f_1-f_l$}
	(2,0) node[below] {$f_1-f_l$} -- ++(0,0.8)
	(4,0) node[below] {$f_1$} -- ++(0,0.8)
	(6,0) node[below] {$f_1+f_l$}  -- ++(0,0.8)
	;
	
	\draw[green!50!black,<-] (0.8,0.4) -- ++(0.4,0);
	\draw[green!50!black,<-] (2+0.8,0.4) -- ++(0.4,0);
	\draw[red!50!black,->] (4+0.8,0.4) -- ++(0.4,0);
\end{tikzpicture}

\paragraph{4. Πολυπλεξία (multiplexing)}
Είναι γνωστό πως στον αέρα σήμερα υπάρχει μεγάλος αριθμός διαμορφωμένων τηλεοπτικών,
ραδιοφωνικών, κλπ. σημάτων. Ας εξετάσουμε πώς είναι δυνατό να στέλνονται όλα αυτά ταυτόχρονα.

\subparagraph{FDMA}

Προφανώς αν στείλουμε δύο διαμορφωμένα σήματα στην ίδια συχνότητα ταυτόχρονα χωρίς παραπάνω
επεξεργασία, ο δέκτης θα αποδιαμορφώσει το άθροισμα τους, και δεν μπορούμε να
πάρουμε το καθένα ξεχωριστά.

\begin{tikzpicture}[scale=.9]
\draw (-2,0) -- (9,0);
\draw (0,2) node[right] {$m(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0) node[below] {$w$};
\draw[very thick,draw=blue!50!black,xscale=-1,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0) node[below] {$-w$};

\begin{scope}[yshift=-2cm]
\draw (-2,0) -- (9,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0) node[below] {$w$};
\draw[very thick,draw=blue!50!cyan!80!black,xscale=-1,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0) node[below] {$-w$};
\end{scope}

\begin{scope}[xshift=5cm]
\draw (0,2) node[right] {$s(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!black,xshift=1cm+4mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);

\draw[] (1.3,0) node[below] {$f_1$};

\begin{scope}[yshift=-2cm]
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=1cm+4mm]
(0,0) -- (0.5,1.1) -- (1,0);

\draw[] (1.3,0) node[below] {$f_1$};
\end{scope}
\end{scope}

\draw[thick,>->] (9.1,-0.5) -- ++(0.8,0);

\begin{scope}[xshift=12cm]
\draw (-2,0) -- (2,0);
\draw (0,2) node[right,align=left] {αποδιαμορφωμένο\\$m(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!black,xscale=-1,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xscale=-1,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);

\begin{scope}[yshift=-2cm]
\draw (-2,0) -- (2,0);
\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!black,xscale=-1,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xscale=-1,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\end{scope}
\end{scope}
\end{tikzpicture}

Αν όμως δώσουμε στο κάθε σήμα τη δική του συχνότητα, τότε ο κάθε δέκτης μπορεί να
συντονιστεί στο επιθυμητό σημείο και να δώσει κάθε σήμα ξεχωριστά, όπως επιθυμούμε:

\begin{tikzpicture}[scale=.9]
\draw (-2,0) -- (11,0);
\draw (0,2) node[right] {$m(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0) node[below] {$w$};
\draw[very thick,draw=blue!50!black,xscale=-1,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0) node[below] {$-w$};

\begin{scope}[yshift=-2cm]
\draw (-2,0) -- (11,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0) node[below] {$w$};
\draw[very thick,draw=blue!50!cyan!80!black,xscale=-1,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0) node[below] {$-w$};
\end{scope}

\begin{scope}[xshift=5cm]
\draw (0,2) node[right] {$s(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!black,xshift=1cm+4mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);

\draw[] (1.3,0) node[below] {$f_1$};

\begin{scope}[yshift=-2cm,xshift=3cm]
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=1cm+4mm]
(0,0) -- (0.5,1.1) -- (1,0);

\draw[] (1.3,0) node[below] {$f_2$};
\end{scope}
\end{scope}

\draw[thick,>->] (9.1+2,-0.5) -- ++(0.8,0);

\begin{scope}[xshift=14cm]
\draw (-2,0) -- (2,0);
\draw (0,2) node[right,align=left] {αποδ.\\$m(t)$} -- (0,-3);

\draw[very thick,draw=blue!50!black,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
\draw[very thick,draw=blue!50!black,xscale=-1,xshift=2mm]
(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);

\begin{scope}[yshift=-2cm]
\draw (-2,0) -- (2,0);
\draw[very thick,draw=blue!50!cyan!80!black,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\draw[very thick,draw=blue!50!cyan!80!black,xscale=-1,xshift=2mm]
(0,0) -- (0.5,1.1) -- (1,0);
\end{scope}
\end{scope}
\end{tikzpicture}

Αυτή η τεχνική ονομάζεται \textbf{Frequency-Division Multiple Access (FDMA)}, δηλαδή
πολυπλεξία στη συχνότητα.

Για παράδειγμα, ένας τηλεπικοινωνιακός οργανισμός που θέλει να στείλει πολλά σήματα 
φωνής μέσω ενός καναλιού (π.χ. καλωδίου), μπορεί να διαμορφώνει κάθε σήμα και να του
αναθέτει το δικό του πεδίο συχνοτήτων.

Για παράδειγμα, αν έχουμε \( N \) φωνητικά σήματα (θεωρούμε ότι έχουν εύρος ζώνης
μεταξύ 300-3300 Hz, δηλαδή περίπου 4 kHz), τότε πρέπει να διαμορφώσουμε το καθένα
ξεχωριστά, με πολλαπλάσια μιας βασικής συχνότητας φέροντος (π.χ. 4 kHz):

\begin{tikzpicture}
\tikzstyle{filter} = [rectangle,draw,minimum height=7mm]
\tikzstyle{mod} = [rectangle,draw,minimum width=15mm]

\draw (0,0) node[filter] (lpf1) {LPF};
\draw (0,-1) node[filter] (lpf2) {LPF};
\draw (0,-3) node[filter] (lpfn) {LPF};

\draw (3,0) node[mod] (mod1) {MOD};
\draw (3,-1) node[mod] (mod2) {MOD};
\draw (3,-3) node[mod] (modn) {MOD};

\draw (5.5,0) node[filter] (bpf1) {BPF\textsubscript{1}};
\draw (5.5,-1) node[filter] (bpf2) {BPF\textsubscript{2}};
\draw (5.5,-3) node[filter] (bpfn) {BPF\textsubscript{$N$}};

\draw (7.5,-1.5) node[adder] (add) {};
\draw (9,-1.5) node[rectangle,draw] (chan) {Κανάλι};
\draw (1.5,-5) node[rectangle,draw] (osc) {$\sim$\quad\begin{tabular}{c}Τροφοδοσία\\Φέροντος\end{tabular}};

\begin{scope}[every node/.style={scale=.8}]
\draw (lpf1.north) node[above,align=center] {300-3300\\kHz};
\draw (bpf1.north) node[above] {4 kHz};
\draw (bpf2.north) node[above,yshift=-1mm] {8 kHz};
\end{scope}

\draw[<-] (lpf1) -- ++(-2,0) node[left] {$1$} node[above,midway] {$m_1(t)$};
\draw[<-] (lpf2) -- ++(-2,0) node[left] {$2$} node[above,midway] {$m_2(t)$};
\draw[<-] (lpfn) -- ++(-2,0) node[left] {$N$};

\draw[<-] (mod1) -- ++(0,-0.5) -| (osc);
\draw[<-] (mod2) -- ++(0,-0.5) -| (osc);
\draw[<-] (modn) -- ++(0,-0.5) -| (osc);
\draw[->] (lpf1) -- (mod1);
\draw[->] (lpf2) -- (mod2);
\draw[->] (lpfn) -- (modn);
\draw[->] (mod1) -- (bpf1) node[above,midway] {$f_1$};
\draw[->] (mod2) -- (bpf2) node[above,midway] {$f_2$};
\draw[->] (modn) -- (bpfn) node[above,midway] {$f_N$};
\draw (bpf1) -| (add.north);
\draw (bpf2) |- (add.west);
\draw (bpfn) -| (add.south);
\draw[->] (add.east) -- (chan) node[near start] (link) {};

\draw (0,-2) node {$\vdots$};
\draw (3,-2) node {$\vdots$};
\draw (5.5,-2) node {$\vdots$};

\draw[brown,->] (link.center) to[bend left] ++(0.1,-0.7) to[bend right] ++(0,-0.5)
node[below right,scale=.7] {$\displaystyle s(t) = \sum_{i=1}^n\left[\frac{1}{2}m_i(t)\cos2πf_it-\frac{1}{2}\hat m_i(t)\sin2πf_it \right]$};
\end{tikzpicture}

Έτσι, στο φάσμα των συχνοτήτων έχουμε πολλά σήματα κολλημένα μεταξύ τους:

\begin{tikzpicture}
\draw[->] (-1,0) -- (8,0);
\draw (0,-0.5) -- (0,2);

\foreach \x in {1,2,3,5} {
	\filldraw[fill=black, draw=gray, fill opacity=0.07,xshift=1.3*\x cm]
	(-0.08,0) -- ++(0.08,1.2) -- ++(1,0) node[midway,above,opacity=1,scale=.9] {\ifthenelse{\equal{\x}{1}}{4 kHz}{}} -- ++(0.08,-1.2);
	
	\draw[very thick,draw=blue!50!cyan,xshift=1.3*\x cm]
	(0,0) .. controls (0.255,1) .. (0.5,1) .. controls (1-0.255,1) .. (1,0);
	
	\draw[xshift=1.3*\x cm] (0.5,0.1) -- ++(0,-0.2) node[below] {\ifthenelse{\equal{\x}{5}}%
		{$f_N$}%
		{$f_\x$}};
}

\draw (1.3*4+0.5,0.5) node {$\cdots$};
\end{tikzpicture}

Και ο αποδιαμορφωτής ακολουθεί ακριβώς την αντίστροφη διαδικασία:

\begin{tikzpicture}
\tikzstyle{filter} = [rectangle,draw,minimum height=7mm]
\tikzstyle{mod} = [rectangle,draw,minimum width=15mm]

\draw (5.5,0) node[filter] (lpf1) {LPF};
\draw (5.5,-1) node[filter] (lpf2) {LPF};
\draw (5.5,-3) node[filter] (lpfn) {LPF};

\draw (3,0) node[mod] (mod1) {DEM};
\draw (3,-1) node[mod] (mod2) {DEM};
\draw (3,-3) node[mod] (modn) {DEM};

\draw (0,0) node[filter] (bpf1) {BPF\textsubscript{1}};
\draw (0,-1) node[filter] (bpf2) {BPF\textsubscript{2}};
\draw (0,-3) node[filter] (bpfn) {BPF\textsubscript{$N$}};

\draw (1.5,-5) node[rectangle,draw] (osc) {$\sim$\quad\begin{tabular}{c}Τροφοδοσία\\Φέροντος\end{tabular}};
\draw (-1.5,-5) node (m) {$m(t)$};

\draw[->] (lpf1) -- ++(2,0) node[right] {$m_1(t)$};
\draw[->] (lpf2) -- ++(2,0) node[right] {$m_2(t)$};
\draw[->] (lpfn) -- ++(2,0) node[right] {$m_N(t)$};

\draw (m) |- (bpf1);
\draw (m) |- (bpf2);
\draw (m) |- (bpfn);
\draw[<-] (mod1) -- ++(0,-0.5) -| (osc);
\draw[<-] (mod2) -- ++(0,-0.5) -| (osc);
\draw[<-] (modn) -- ++(0,-0.5) -| (osc);
\draw[->] (bpf1) -- (mod1);
\draw[->] (bpf2) -- (mod2);
\draw[->] (bpfn) -- (modn);
\draw[->] (mod1) -- (lpf1);
\draw[->] (mod2) -- (lpf2);
\draw[->] (modn) -- (lpfn);

\draw (0,-2) node {$\vdots$};
\draw (3,-2) node {$\vdots$};
\draw (5.5,-2) node {$\vdots$};
\end{tikzpicture}

Για τον επιπλέον έλεγχο του φάσματος, τα σήματα μπορεί να ενώνονται σε ομάδες, οι οποίες
ενώνονται σε υπερομάδες, και στη συνέχεια σε super-groups, ενώ για δημόσια κανάλια
(π.χ. για ραδιοφωνικούς σταθμούς) μπορεί να υπάρχει κάποιος οργανισμός που να ελέγχει την
κατανομή των συχνοτήτων.

\subparagraph{TDMA}
Η ιδέα του \textbf{Time-Division Multiple Access (TDMA)} βασίζεται στο ότι για να πάρουμε
τις τιμές ενός σήματος το δειγματοληπτούμε ανά τακτά χρονικά διαστήματα:

\begin{tikzpicture}[scale=1.6]
\draw (0,0) -- (4,0);
\draw[ultra thick,blue!70!cyan]
plot[domain=0:4,variable=\t,smooth,samples=18]
(\t,{1+0.32*cos(2.33*\t r)});

\foreach \x in {0,0.35,...,4} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.32*cos(2.33*\x r)});
}
\end{tikzpicture}

Σκεφτόμαστε αν π.χ. έχουμε 3 σήματα, κάθε φορά που δειγματοληπτείται το πρώτο, μετά από
λίγο να δειγματοληπτείται το δεύτερο, μετά το τρίτο, και μετά να ξεκινάμε ξανά από την
αρχή, δειγματοληπτώντας το πρώτο, το δεύτερο, κ.ό.κ:

\begin{tikzpicture}[scale=1.4]
\foreach \x in {0,0.333,0.667} {
	\draw[gray,dashed] (\x,-9) -- (\x,0);
}

\draw (-0.5,0) -- (4,0);
\draw[ultra thick,blue!70!cyan]
plot[domain=-0.5:4,variable=\t,smooth,samples=16]
(\t,{1+0.32*cos(2.33*\t r)});

\foreach \x in {0,1,...,3} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.32*cos(2.33*\x r)});
}

\begin{scope}[yshift=-3cm]
\draw (-0.5,0) -- (4,0);
\draw[ultra thick,blue!70!cyan]
plot[domain=-0.5:4,variable=\t,smooth,samples=16]
(\t,{1+0.5*sin(1.2*\t r)});

\foreach \x in {0.333,1.333,...,3.333} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.5*sin(1.2*\x r)});
}
\end{scope}

\begin{scope}[yshift=-6cm]
\draw (-0.5,0) -- (4,0);
\draw[ultra thick,blue!70!cyan]
plot[domain=-0.5:4,variable=\t,smooth,samples=30]
(\t,{1+0.4*sin(2.1*\t r)});

\foreach \x in {0.667,1.667,...,3.667} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.4*sin(2.1*\x r)});
}
\end{scope}

\begin{scope}[yshift=-9cm]
\draw (-0.5,0) -- (4,0);

\foreach \x in {0.667,1.667,...,3.667} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.4*sin(2.1*\x r)});
}

\begin{scope}[green!30!black,every node/.style={scale=.9}]
\foreach \x in {0,1,...,3} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.32*cos(2.33*\x r)}) node[above,blue!50!black,fill=white] {1};
}
\foreach \x in {0.333,1.333,...,3.333} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.5*sin(1.2*\x r)}) node[above,red!50!black,fill=white] {2};
}
\foreach \x in {0.667,1.667,...,3.667} {
	\draw[thick,->] (\x,0) -- ++(0,{1+0.4*sin(2.1*\x r)}) node[above,purple!50!black,fill=white] {3};
}
\end{scope}

\draw (-0.2,0.01) -- ++(0,-0.2) -- (0.667+0.2,-0.19) node[midway,below] {frame} -- ++(0,0.21);

\draw (-1,1) node[adder,scale=.7] {};
\end{scope}
\end{tikzpicture}

Έτσι, μέσα σε κάθε frame (χρονοθυρίδα),
μπορούμε να δειγματοληπτήσουμε πολλά (π.χ. 100) διαφορετικά σήματα.

Η τεχνική αυτή μπορεί να χρησιμοποιηθεί και για ψηφιακά σήματα, ενώ είναι δυνατόν να
συνδυαστεί με το FDMA για πολυπλεξία ακόμα περισσότερων σημάτων.

\subparagraph{CDMA}
Το \textbf{Code-Division Multiple Access (CDMA)} εφαρμόζεται σε ψηφιακά σήματα, που θεωρούμε
ότι μπορούν να λάβουν π.χ. μόνο τις τιμές 1 ή -1.

Έστω δύο σήματα:

\begin{tikzpicture}[scale=0.6,every node/.style={scale=.7}]
\draw (-0.5,0) -- (3.5,0);
\draw (0,2) -- (0,-5.5);

\draw (0,0) node[above left] {$s_1(t)$};

\begin{scope}[yshift=-4cm]
\draw (-0.5,0) -- (3.5,0);
\draw (0,0) node[above left] {$s_2(t)$};

\draw[thick,blue!60!cyan!80!black,xscale=.5]
plot [const plot] coordinates {(0,1) (1,1) (2,-1) (3,1) (4,1) (5,1) (6,0)};

\begin{scope}[every node/.style={blue!60!cyan!90!black,scale=.7},xscale=.5]
\draw (0,1) node[above right] {1};
\draw (1.5,1) node[above] {1};
\draw (2.5,1) node[above] {-1};
\draw (3.5,1) node[above] {1};
\draw (4.5,1) node[above] {1};
\draw (5.5,1) node[above] {1};
\draw[dashed] (1,0) -- ++(0,1);
\draw[dashed] (4,0) -- ++(0,1);
\draw[dashed] (5,0) -- ++(0,1);
\end{scope}
\end{scope}

\draw[thick,blue!60!cyan!80!black,xscale=.5]
plot [const plot] coordinates {(0,1) (1,-1) (2,1) (4,-1) (5,1) (6,0)};

\begin{scope}[every node/.style={blue!60!cyan!90!black,scale=.7},xscale=.5]
\draw (0,1) node[above right] {1};
\draw (1.5,1) node[above] {-1};
\draw (2.5,1) node[above] {1};
\draw (3.5,1) node[above] {1};
\draw (4.5,1) node[above] {-1};
\draw (5.5,1) node[above] {1};
\draw[dashed] (3,0) -- ++(0,1);
\end{scope}
\end{tikzpicture}

Με κατάλληλο πολλαπλασιασμό, άθροιση και ολοκλήρωση, θα λάβουμε ένα σήμα ευρείας μπάντας
που περιέχει τα δεδομένα μας, ενώ θα είναι αντιληπτό μόνο ως θόρυβος σε κάποιον άλλον ακροατή,
κάτι που έκανε αυτήν την κωδικοποίηση χρήσιμη στον Β' Παγκόσμιο Πόλεμο.

\todo{συμπλήρωση?}

\subsection{Ένα μαθηματικό ερώτημα που τέθηκε παραπάνω}
\label{sec:interesting-question}
\begin{infobox}{}
	Έστω \( H(f) \) είναι η χαρακτηριστική μεταφοράς πλάτους ενός ζωνοπερατού φίλτρου,
	η οποία περιγράφεται \textbf{στις θετικές συχνότητες} από τη σχέση:
	\[
	H(f) = \begin{cases}
	c, \qquad & f \in \left[ f_c+f_v,\ f_c+w \right]\text{ (ζώνη διέλευσης)} \\
	G(f),\qquad & f\in \left[f_c-f_v,\ f_c+f_v\right]\text{ (ζώνη μετάδοσης)} \\
	0,\qquad & \text{αλλού}
	\end{cases}
	\]
	
	Η απαίτηση \( H(f+f_c) + H(f-f_c) = c \) στο διάστημα \( [-f_v,+f_v] \) απαιτεί από
	το τμήμα \( G(f) \) της χαρακτηριστικής να παρουσιάζει περιττή συμμετρία γύρω από το
	σημείο \( \left(f_c,\ H(f_c)\right) \).
	
	Να αποδειχθεί μαθηματικά και πλήρως η παραπάνω πρόταση.
\end{infobox}

\subsection{Ασκήσεις}
\begin{attnbox}{Μάθημα}
	Κάθε Τρίτη θα γίνεται μάθημα ασκήσεων.
\end{attnbox}
\begin{attnbox}{Ασκήσεις}
	Όλες οι ασκήσεις είναι ανεβασμένες στην ιστοσελίδα.
\end{attnbox}

Έγιναν οι ασκήσεις:
\begin{itemize}
	\item \textbf{2} από το σετ
	\href{https://genesis.ee.auth.gr/dimakis/greek/courses/telesysI/exers/am.pdf}{Διαμόρφωση Πλάτους 1}
	\item \textbf{3} από το σετ
	\href{https://genesis.ee.auth.gr/dimakis/greek/courses/telesysI/exers/am.pdf}{Διαμόρφωση Πλάτους 1}
	
	\item\textbf{3} από το σετ
	\href{https://genesis.ee.auth.gr/dimakis/greek/courses/telesysI/exers/ssb.pdf}{Διαμόρφωση Πλάτους 2}
	
	\item\textbf{1} από το σετ
	\href{https://genesis.ee.auth.gr/dimakis/greek/courses/telesysI/exers/vsb.pdf}{Διαμόρφωση Πλάτους 3}
\end{itemize}

\paragraph{Παράδειγμα}
Δίνεται ένα μήνυμα πληροφορίας \( m(t) \) για το οποίο οι ελάχιστες και μέγιστες τιμές
είναι:
\begin{align*}
\min\left[m(t)\right] &= -2\\
\max\left[m(t)\right] &= +3
\end{align*}

Ποιά είναι η μέγιστη τιμή που μπορεί να πάρει ο συντελεστής \( k_a \) σύμφωνα με τη
λιγότερο αυστηρή συνθήκη για την αποφυγή υπερδιαμόρφωσης;

(Για \( s(t) = A_c(1+k_am(t)) \cos2πf_ct \))

\subparagraph{Λύση}

Θυμόμαστε τη μέθοδο αποδιαμόρφωσης του AM σήματος:
\todo{Graph 84}

Παρατηρούμε ότι ο φωρατής βγάζει ως έξοδο το \( A_c\left|1+k_a m(t)\right| \),
ενώ η επιθυμητή έξοδος είναι η \( A_c\left(1+k_a m(t)\right) \). Αυτές οι δύο τιμές είναι
ίσες μόνο όταν ισχύει \( 1+k_a m(t) \geq 0 
\implies \boxed{k_am(t)} \geq -1 \), που είναι η συνθήκη για να μην υπάρχει
υπερδιαμόρφωση.

Η συνθήκη όμως που γνωρίζουμε από τη θεωρία είναι η εξής:
\[
\left| k_am(t) \right| \leq 1 \implies -1 \leq k_a m(t) \leq 1
\]
που περιλαμβάνει και το κομμάτι \( k_am(t) \leq 1 \), το οποίο όμως δεν επηρεάζει την
ύπαρξη ή όχι της υπερδιαμόρφωσης.

Επομένως, για εμάς πρέπει να ισχύει:
\begin{align*}
	1+\min\left[ k_am(t) \right] \geq 0 &\implies
	k_a\min\left[ m(t) \right] \geq 1 \implies \\ &\implies \boxed{
		k_a \leq \frac{1}{2}
		}
\end{align*}

\paragraph{Παράδειγμα}
Δίνεται ένα AM σήμα:
\[
A_c\left( a+0.75m(t) \right)\cos 2πf_c t
\]
όπου \( \max\left[m(t)\right] = 2 \) και \( \min\left[m(t)\right] = -1\).

Να βρεθεί η τιμή της σταθεράς \( a \) για:
\begin{enumgreekparen}
	\item Ποσοστό διαμόρφωσης 100\%
	\item Ποσοστό διαμόρφωσης 50\%
\end{enumgreekparen}

\subparagraph{Λύση}
\begin{enumgreekparen}
	\item Ποσοστό διαμόρφωσης 100\% σημαίνει ότι το σήμα μόλις δεν υπερδιαμορφώνεται,
	δηλαδή το πλάτος \( A_c(a+0.75m(t)) \) του συνημιτόνου μόλις φτάνει στο 0, και δεν
	πηγαίνει κάτω από αυτό, δηλαδή:
	
	\begin{align*}
		a+0.75m(t) \geq 0 &\implies a+\min\left[0.75m(t)\right] = 0 \implies
		\\ &\implies a+0.75\min\left[m(t)\right] = 0 \implies \\& \implies
		\boxed{a=0.75}
	\end{align*}
	
	\item Για να έχω ποσοστό διαμόρφωσης 50\%, θα πρέπει ουσιαστικά να μπορώ να
	διπλασιάσω τον όρο \( a+0.75m(t) \) χωρίς να υπερδιαμορφώνω το σήμα, δηλαδή:
	
	\begin{align*}
		1+\frac{0.75}{a}\cdot m(t) &= 0.5 \\
		\implies 1+\frac{0.75}{a}\min\left[ m(t) \right] &= 0.5 \\
		\implies \boxed{a=0.5}
	\end{align*}
\end{enumgreekparen}

\paragraph{Παράδειγμα}
Έχουμε έναν ραδιοφωνικό σταθμό στα \( f_c = \SI{700}{\kilo\hertz} \), και θέλουμε να
τον \textbf{ετεροδυνώσουμε} στα \( f_{IF} = \SI{400}{\kilo\hertz} \), δηλαδή να
τον κατεβάσουμε στα \( \SI{400}{\kilo\hertz} \) προτού τον κατεβάσουμε στη βασική ζώνη.

Ποιά πρέπει να είναι συχνότητα \( f_{LO} \) του τοπικού ταλαντωτή;

Η κεραία AM λαμβάνει ολόκληρη τη μπάντα των AM, δηλαδή \( f \in \left[540,\;1600\right]
\si{\kilo\hertz} \).

\subparagraph{Λύση}
Το φάσμα που λαμβάνει η κεραία μοιάζει κάπως έτσι:
\todo{Graph 91}

Εμείς όμως θέλουμε να ακούσουμε μόνο το σταθμό στα \( \SI{700}{\kilo\hertz} \).

Ο υπερετερόδυνος δέκτης μοιάζει κάπως έτσι:

\begin{tikzpicture}
\draw (-1,0) node[rxantenna,xscale=-1] (ant) {};
\draw (0,0) node[rectangle,draw,align=left] (f1) {RF\\φίλτρο};
\draw (2,0) node[rectangle,draw] (m) {μίκτης};
\draw (4,0) node[rectangle,draw,align=left] (f2) {IF\\φίλτρο};
\draw (6,0) node[rectangle,draw,align=center] (amp) {audio\\amplifier};

\draw[<-] (m) -- ++(0,-1) node[below] (osc) {$f_{LO}$};
\draw (ant) -- (f1) -- (m) -- (f2) -- (amp);
\draw (f2.south) node[below,align=center] {$f_{\mathrm{centre}} = $ 100 kHz\\BW $ = $ 10 kHz};
\draw (amp.east) -- ++(0.5,0);
\end{tikzpicture}

Στον μίκτη ουσιαστικά πολλαπλασιάζουμε με τη συχνότητα \( f_{LO} \) για να μετακινήσουμε
το σήμα σε μια \( f_{IF} \) (Intermediate Frequency) που θα αποδιαμορφώσουμε αργότερα.

Οι συχνότητες με τις οποίες μπορούμε να πολλαπλασιάσουμε το σήμα ώστε να μετακινηθεί είναι
η \( f_{LO} = \SI{300}{\kilo\hertz} \) και \( f_{LO} = \SI{1100}{\kilo\hertz} \), κάτι
που μπορούμε να διαπιστώσουμε αν σκεφτούμε τη συνέλιξη των δύο εισόδων στη συχνότητα.

Όμως σε κάθε έναν από τους παραπάνω πολλαπλασιασμούς, προστίθενται επιπλέον συχνότητες-φάντασμα στα \( \SI{400}{\kilo\hertz} \), από τα \( f' = \SI{100}{\kilo\hertz} \)
και τα \( f' = \SI{1500}{\kilo\hertz} \) αντίστοιχα, τα οποία επηρεάζουν και προστίθενται
στο επιθυμητό σήμα.

Εφ' όσον όμως στα \( \SI{100}{\kilo\hertz} \) δεν έχουμε σήμα, αφού το φίλτρο RF δεν
το αφήνει να περάσει, μπορούμε να χρησιμοποιήσουμε την τοπική συχνότητα των
\( f_{LO} = \SI{300}{\kilo\hertz} \) για να ετεροδυνώσουμε το σήμα.

\todo{Improvise a graph}

\paragraph{Παράδειγμα}
\todo{Graph 92, από 3 Σεπτ. 17}

Δίνεται ένας υπερετερόδυνος δέκτης, όπου η κεραία λαμβάνει το φάσμα των AM ραδιοφωνικών σταθμών
(540 - 1600 kHz) με εύρος ζώνης του καθενός 10 kHz.

Η κεντρική συχνότητα του RF φίλτρου ρυθμίζεται
μαζί με την \( f_{\mathrm{LO}} \), και ισχύει:
\[
f_{\mathrm{RF}} = f_{\mathrm{LO}} - \SI{5}{\kilo\hertz}
\]
ενώ για τη συχνότητα \( f_c \) του σταθμού που θέλουμε
να ακούσουμε ισχύει:
\[
f_{\mathrm{LO}} = f_C + \SI{455}{\kilo\hertz}
\]
\begin{enumgreekparen}
	\item Ζωγραφίστε ποιοτικά το φάσμα στην είσοδο
	του RF φίλτρου
	\item Δικαιολογήστε ότι αυτό επιτυγχάνεται εάν η συχνότητα
	\( f_{\mathrm{LO}} \) του τοπικού ταλαντωτή παίνρι τιμές στο διάστημα \( [995,\;2055]\si{\kilo\hertz} \). Συνοδεύστε την απάντησή σας με ένα παράδειγμα.
	\item Βρείτε το δεύτερο διάστημα τιμών στο οποίο
	μπορεί να κυμαίνεται η \( f_{\mathrm{LO}} \), ώστε
	να ετεροδυνώνεται στα \( \SI{455}{kHz} \)
	\item Υπολογίστε το λόγο της μέγιστης προς την ελάχιστη \( f_{\mathrm{LO}} \)
	για καθένα από τα παραπάνω διαστήματα συχνοτήτων.
	Η επιλογή ποιού από τα δύο καταλήγει σε υλοποίηση του τοπικού ταλαντωτή
	τεχνοοικονομικά πιο συμφέρουσα;
\end{enumgreekparen}

\subparagraph{Λύση}
\begin{enumgreekparen}
	\item \todo{Graph 91 (again)}
	\item[(γ)] \(  f_c=540,\ f_{IF}=455,\ f_{LO} = 85, f_C' = \SI{70}{\kilo\hertz}  \)
	\item[(δ)] \(
	\begin{aligned}[t]
		\frac{f_{LO_{\max}}}{f_{LO_{\min}}}
		= \frac{2055}{995} &= 2.065 \\
		\frac{f_{LO_{\max}}}{f_{LO_{\min}}}
		= \frac{1145}{85} &= 13.47
	\end{aligned} \)
	
	\textit{"Τεχνοοικονομικά πιο συμφέρουσα"}
	σημαίνει ότι το κύκλωμα είναι πιο απλό για να
	υλοποιηθεί, με αποτέλεσμα να είναι πιο φθηνό.
	
	Ουσιαστικά εδώ έχουμε ένα κύκλωμα που ταλαντώνεται σε μία συχνότητα. Είναι
	πιο δύσκολο να κατασκευάσουμε μία τέτοια διάταξη με μεγαλύτερο εύρος ζώνης,
	αφού απαιτούνται μεγαλύτεροι μεταβλητοί πυκνωτές.
\end{enumgreekparen}

\paragraph{Παράδειγμα}
Δίνεται το παρακάτω διαμορφωμένο σήμα:
\todo{Graph 91}

Να δείξετε (οπτικά) ότι είναι διαμορφωμένο και κατά πλάτος, και κατά φάση.
\subparagraph{Λύση}
Παρατηρούμε ότι μεταβάλλεται και το πλάτος, και η συχνότητα του σήματος, επομένως
είναι διαμόρφωση πλάτους και φάσης.

\begin{attnbox}{}
	\textbf{Αναλυτική λύση} σημαίνει ότι λύνουμε την άσκηση προχωρώντας τους τύπους.
\end{attnbox}

\paragraph{Άσκηση}
Δίνεται ένα σήμα διαμορφωμένο κατά USB, και πολυπλεγμένο στη συχνότητα:

\todo{Graph 97}

Θέλουμε να το αποδιαμορφώσουμε ώστε να πάρουμε μόνο το ένα σήμα στη βασική ζώνη. Για αυτό
χρησιμοποιούμε την παρακάτω διάταξη αποδιαμορφωτή:

\todo{Graph 98}

όπου δίνεται και η απόκριση \( B(f) \) του φίλτρου:
\todo{Graph 99}

\begin{enumgreekparen}
	\item Να ζωγραφίσετε ποιοτικά τα φάσματα στα σημεία Α, Β, Γ και Δ.
	
	\item Να ζωγραφίσετε τα φάσματα στα Α' και Δ' μιας εναλλακτικής διάταξης διαμόρφωσης:
	\todo{Graph 107}
	
	\item Να συγκρίνετε τα σήματα στα σημεία Δ και Δ', και να σχολιάσετε τι πλεονέκτημα
	τεχνοοικονομικής φύσης προσφέρει ο αποδιαμορφωτής δύο σταδίων (του 1\textsuperscript{ου}
	ερωτήματος) σε σχέση με τον αντίστοιχο του ενός.
\end{enumgreekparen}

\subparagraph{Λύση}

\begin{enumgreekparen}
	\item \begin{itemize}
		\item Στο σημείο A έχουμε πολλαπλασιασμό του σήματος με ένα ημίτονο
		900 kHz, δηλαδή στη συχνότητα
		συνέλιξη του σήματος με δύο δέλτα. Επομένως ένα αντίγραφο του σήματος θα μετατοπιστεί
		κατά 900 kHz στα αριστερά, και ένα άλλο θα μετατοπιστεί στα δεξιά:
		
		\todo{Graph 101}
		
		\item Το σημείο Β προκύπτει από το προηγούμενο σήμα, στο οποίο εφαρμόσαμε ένα φίλτρο:
		\todo{Graph 102}
		
		Δηλαδή το σήμα που προκύπτει είναι το πρώτο αριστερό σήμα, και το δεύτερο με
		μειωμένο πλάτος, ενώ οι συχνότητες από τα 1900 kHz και μετά θα έχουν
		αποκοπεί πλήρως από το φίλτρο:
		\todo{Graph 103}
		
		\item Στη συνέχεια πολλαπλασιάζουμε με ένα ημίτονο 100 kHz, άρα δύο αντίγραφα
		του σήματος στο \textit{Β} μετατοπίζονται στα αριστερά και στα δεξιά:
		\todo{Graph 104}
		
		\item Η απόκριση του χαμηλοπερατού φίλτρου εφαρμόζεται επάνω στο σήμα \textit{Γ}:
		\todo{Graph 105}
		
		Άρα τελικά το σήμα εξόδου είναι:
		\todo{Graph 106}
	\end{itemize}
	
	Παρατηρούμε ότι στο τελικό σήμα δεν έχει κοπεί το δεύτερο κανάλι, αλλά έχει μόνο
	αποσβεστεί σε μεγάλο βαθμό.
	
	Σημειώνουμε ότι ο παραπάνω δέκτης είναι υπερετερόδυνος, αφού δεν κατεβάζει αμέσως
	το σήμα στην επιθυμητή συχνότητα, αλλά το φέρνει πρώτα σε μια ενδιάμεση.
	
	\item Αντίστοιχα με παραπάνω, έχουμε:
	\todo{Graph 108}
	
    \item Ο ετερόδυνος αποδιαμορφωτής έχει πιο εύκολα υλοποιήσιμα φίλτρα, αφού η απόκρισή
    τους στη συχνότητα είναι πολύ λιγότερο απότομη σε σχέση με αυτήν του ομόδυνου, επομένως
    είναι πιο φθηνός. Από την άλλη μεριά, ο δεύτερος αποδιαμορφωτής δεν δίνει στην έξοδο
    το μη επιθυμητό σήμα, το οποίο μπορεί να εμφανιστεί ως θόρυβος σε έναν ακροατή.
\end{enumgreekparen}

\paragraph{Ερώτημα}
Αιτιολογήστε γιατί το παρακάτω φίλτρο φαίνεται ότι μπορεί να χρησιμοποιηθεί για διαμόρφωση
VSB:

\todo{Graph 109}

\subparagraph{Λύση}
Το φίλτρο αυτό φαίνεται ότι έχει περιττή συμμετρία γύρω από τα κεντρικά σημεία των ζωνών
καθόδου, \( f_ο \) και \( f_ο' \).

Για να σχηματίσουμε ένα VSB σήμα, θυμόμαστε ότι πρώτα σχεδιάζουμε ένα DSB (διπλής
πλευρικής ζώνης), και σε αυτό εφαρμόζουμε το παραπάνω φίλτρο, τοποθετώντας τη συχνότητα
φέροντος \( f_c \) επάνω στην κεντρική \( f_0 \) ή \( f_0' \) του φίλτρου.
\todo{Graph 110}

Και μετά την εφαρμογή του φίλτρου προκύπτει:
\todo{Graph 111}
όπου είναι κατάλοιπη η κάτω πλευρική ζώνη, ή, αν έχουμε ως κατάλοιπη την επάνω πλευρική
ζώνη:

\todo{Graph 112}

Τα σημεία \( f_0 \) του φίλτρου είναι τα:
\[
\left( H^{-1}(0.5), \ 0.5 \right)
\]
όπου \( H^{-1} \) η αντίστροφη συνάρτηση της απόκρισης του φίλτρου. Για το VSB χρειάζεται:
\[
f_c = H^{-1}(0.5)
\]

Για να μπορεί να διαμορφωθεί και να αποδιαμορφωθεί το VSB σήμα, πρέπει να έχουμε \textbf{περιττή συμμετρία} γύρω από τα σημεία \( f_0 \) του φίλτρου. Εποπτικά, αν περιστρέψουμε τη ζώνη μετάβασης γύρω από το \( f_0 \) κατά \( \ang{180} \), θα πρέπει
να καταλήγουμε στο ίδιο σχήμα.

\paragraph{Άσκηση (Παλμός Ανυψωμένου Συνημιτόνου)}
Οι παλμοί ανυψωμένου συνημιτόνου χρησιμοποιούνται στις ψηφιακές τηλεπικοινωνίες. Έχουν
το εξής ενδιαφέρον φάσημα:
\[
X_{rc}(f) = \begin{cases}
T, \qquad & |f| \leq \frac{1}{4T}\\
\frac{T}{2}\left[1+\cos2πT\left(|f|-\frac{1}{4T}\right)\right],\qquad & \frac{1}{4T} \leq |f| \leq \frac{3}{4T}\\
0,\qquad & |f| > \frac{3}{4T}
\end{cases}
\]

\begin{enumgreekparen}
	\item Να σχεδιαστεί το φάσμα \( X_{rc}(f) \)
	\item Να δείξετε αναλυτικά ότι μια τέτοια συνάρτηση μεταφοράς μπορεί να χρησιμοποιηθεί
	για VSB διαμόρφωση.
	\item Να σχεδιάσετε πώς θα έμοιαζε το φίλτρο σε υψηλότερες συχνότητες.
	\item Ποιά συχνότητα στο διάστημα \( \left[ f_1-\frac{3}{4T},\
	f_1+\frac{3}{4T} \right] \) θα επιλέγατε για να βάλετε το κέντρο του DSB σήματος
	ώστε μετά την εφαρμογή του φίλτρου να γίνει DSB, και ποιά θα ήταν τότε η κατάλοιπη πλευρική ζώνη;
\end{enumgreekparen}

\subparagraph{Λύση}
\begin{enumgreekparen}
	\item \todo{Graph 118}
	\item Αφού το φίλτρο είναι στη βασική ζώνη και έχουμε συμμετρία γύρω από το 0, θα εξετάσουμε μόνο το άνω σκέλος (και όχι και το κάτω), προσπαθώντας να αποδείξουμε
	ότι έχει περιττή συμμετρία γύρω από κάποιο κεντρικό σημείο.
	
	Το σημείο στο κέντρο της ζώνης μετάβασης του φίλτρου είναι αυτό με τεταγμένη
	\( \frac{T}{2} \), και ορίζουμε την τετμημένη του να είναι \( f_0 \), δηλαδή:
	\[
	f_0 = X^{-1}_{rc}\left(\frac{T}{2}\right),\quad f\geq 0
	\]
	
	Πρώτα πρέπει να βρούμε την τιμή του \( f_0  \), δηλαδή την τιμή του \( f \) για την
	οποία \( X_{rc}(f) = 0 \):
	\begin{align*}
		X_{rc}(f) &= \frac{T}{2} \implies \\
		\frac{T}{2}\left[1+\cos2πT\left(f-\frac{1}{4T}\right)\right] &= \frac{T}{2}
		\implies \\
		1+\cos 2πT\left(f-\frac{1}{4T}\right)&= 1 \implies \\
		\cos 2πT \left(f-\frac{1}{4T}\right) &= 0 \implies \\
		2πT\left( f-\frac{1}{4T} \right) &= \frac{π}{2},\frac{3π}{2},\dots \implies \\
		f &= \frac{1}{2T},\ \frac{1}{T},\ \frac{3}{2T}, \dots
	\end{align*}
	
	Από τις παραπάνω τιμές επιλέγουμε αυτήν που είναι εντός του διαστήματος \( \left(
	\frac{1}{4T},\frac{3}{4T}
	\right) \), δηλαδή την \( \displaystyle \frac{1}{2T} \), η οποία μάλιστα
	βρίσκεται στο κέντρο του διαστήματος αυτού.
	
	Για να αποδείξουμε την περιττή συμμετρία γύρω από αυτό το σημείο, πρώτα ορίζουμε
	ένα \( β \in [ 0, \cancelto{\frac{1}{4T}}{f_v} ] \), που είναι η απόσταση από το
	σημείο \( \frac{1}{2T} \).
	
	\todo{Graph 119}
	
	Τότε:
	\begin{itemize}
		\item Δεξιά του \( f_0 \), πηγαίνουμε στο σημείο \( f_0+β = \frac{1}{2T} +β \), και έχουμε:\begin{align*}
			X_{rc} \left(\frac{1}{2T} + β\right)
			&= \frac{T}{2} \left[ 1+\cos 2πT \left(\frac{1}{2T}+β-\frac{1}{4T}\right) \right]
			\\ &= \frac{T}{2} \left[1+\cos 2πT \left(β+\frac{1}{4T}\right)\right]
		\end{align*}
		\item Αριστερά του \( f_0 \), πηγαίνουμε στο σημείο \( f_0 - β =\frac{1}{2T}-β \),
		και έχουμε:\[
		X_{rc} \left(\frac{1}{2T} - β\right) = \frac{T}{2}\left[
		1+\cos 2πT \left(\frac{1}{4T} - β\right)
		\right]
		\]
	\end{itemize}
	
	Για να έχουμε περιττή συμμετρία, θα πρέπει οι παραπάνω όροι να δίνουν σταθερό άθροισμα
	\( T \):
	\begin{align*}
		X_{rc}\left(\frac{1}{2T} + β\right)+X_{rc}\left(\frac{1}{2T} - β\right)
		&= T + \frac{T}{2} \left( \cos 2πT\left(β+\frac{1}{4T}\right)
		+\cos 2πT\left( \frac{1}{4T} - β \right)
		 \right)
		\\ &\overset{\mathllap{\text{από τριγ. ταυτότητα}}}{=} T + \frac{T}{2} \cdot 2 \cdot \cos 2πT\cdot \frac{1}{4T}\cdot \cos 2πTβ
		\\ &= T.
	\end{align*}
	
	\item Θα μετατοπίσουμε αριστερά και δεξιά την απόκριση συχνότητας του φίλτρου:
	\todo{Graph 120}
	
	\item Σε προηγούμενο ερώτημα είδαμε ότι η κεντρική συχνότητα \( f_0 \) της ζώνης
	μετάβασης (στη βασική ζώνη) είναι \( f_0 = \frac{1}{2T} \). Επομένως, στις υψηλές
	συχνότητες μπορούμε να κεντράρουμε το σήμα στη συχνότητα \( f_c = f_i + \frac{1}{2T} \), και να αφήσουμε κατάλοιπη την επάνω πλευρική ζώνη.
	
	Εναλλακτικά, μπορούμε να κεντράρουμε στην \( f_c = f_i - \frac{1}{2T} \) και να είναι
	κατάλοιπη η κάτω πλευρική ζώνη.
	
	\todo{Graph 121}
\end{enumgreekparen}

\paragraph{Άσκηση}
Αναζητώντας στο διαδίκτυο περισσότερες πληροφορίες για την διαμόρφωση DSB σημάτων, βρήκατε
στο διαδίκτυο την εξής εικόνα:
\todo{Graph 121}

Το σχήμα αυτό παρουσιάζει ένα αρχικό σήμα κατά DSB, ένα φίλτρο από το οποίο το περνάμε,
και το τελικό σήμα μετά το φίλτρο.

Βρείτε το λάθος του παραπάνω σχήματος, και επιλέξτε ένα φίλτρο το οποίο να μπορεί να διαμορφώσει σωστά το σήμα. Σχεδιάστε το σωστά διαμορφωμένο σήμα.

\subparagraph{Λύση}
Το φίλτρο που παρουσιάζεται παρατηρούμε ότι δεν παρουσιάζει περιττή συμμετρία ως προς το κέντρο της ζώνης
μετάβασης, επομένως δεν μπορεί να χρησιμοποιηθεί σαν VSB φίλτρο.

Μία πιο σωστή διαμόρφωση θα ήταν:
\todo{Graph 122}

\section{Διαμόρφωση Γωνίας}
Μέχρι στιγμής ασχοληθήκαμε με διαμορφώσεις πλάτους, που μετέβαλλαν μόνο το πλάτος
του σήματος (ίσως και τη φάση με κάποιον τρόπο, όπως εξηγήσαμε σε \hyperref[application.am-phase]{μια εφαρμογή}).

Τώρα θα μελετήσουμε συστήματα στα οποία μεταβάλλουμε τη συχνότητα ή τη φάση του
εκπεμπόμενου σήματος (αργότερα θα δούμε ότι αυτά τα δύο είναι ισοδύναμα), διατηρώντας το
πλάτος σταθερό:
\[
A_c \cos(\underbrace{2πf_ct + \vartheta}_{\theta(t)})
\]

Η διαμόρφωση αυτή ονομάζεται \textbf{Phase Modulation (PM)} ή \textbf{Frequency Modulation
	 (FM)}, εμφανίστηκε το 1930, και άρχισε να χρησιμοποιείται για broadcasting το 1960-1970.
Έχει το πλεονέκτημα ότι, παρ' όλο που απαιτεί ένα πιο ακριβό και πολύπλοκο σύστημα, έχει
καλύτερη ποιότητα πληροφορίας, επειδή δεν επηρεάζεται από τον θόρυβο όσο και τα AM.

\subsection{Βασικοί ορισμοί}
Έστω ένα σήμα:
\[
s(t) = A_c \cos \underbrace{2πf_c t}_{\theta(t)}
\] 

Τότε από παραπάνω προκύπτει ότι η συχνότητα είναι:
\[
f_c = \frac{\theta(t)}{2πt}=\frac{\omega_c}{2π}
\]
δηλαδή ο αριθμός των κύκλων που πραγματοποιεί το συνημίτονο μέσα στην μονάδα του χρόνου:
\[
f_c = \frac{\frac{\theta(t+\dif t)-\theta(t)}{2π}}{\dif t}
\]

\begin{defn}{Στιγμιαία συχνότητα}{}
Για ένα σήμα \( s(t) = A_c\cos\left(\theta_i(t)\right) \) με \textbf{στιγμιαία φάση}
\( \theta_i(t) \)
ορίζουμε τη \textbf{μέση
	συχνότητα}:
\[
f_{Δt}(t) = \frac{\theta_i(t+\Delta t) - \theta_i(t)}{2π Δ t}
\]
και παίρνοντας το όριο του \( Δt \) στο 0, ορίζουμε τη \textbf{στιγμιαία συχνότητα}:
\begin{align*}
	f_i(t) &= \lim_{Δt \to 0} f_{Δt}(t) = \lim_{Δt\to 0}\frac{\theta_i(t+Δt)-\theta_i(t)}{2πΔt}
	\implies \\
	\Aboxed{f_i(t) &= \frac{1}{2π} \od{\theta_i(t)}{t}}
\end{align*}
\end{defn}

Έτσι, μπορούμε να έχουμε ένα σήμα σταθερής ή μεταβαλλόμενης συχνότητας. Πρακτικά, μια
μεταβαλλόμενη συχνότητα σημαίνει ότι το συνημίτονο δεν θα συναντάει τον οριζόντιο άξονα
σε σημεία με ίσες αποστάσεις μεταξύ τους, αλλά σε διαφορετικές.

\todo{Graph 85}

\subsubsection{Διαμορφώσεις PM \& AM}
Τώρα μπορούμε να δώσουμε τις μαθηματικές εκφράσεις για τις διαμορφώσεις φάσης και συχνότητας:

\begin{defn}{PM - Διαμόρφωση Φάσης}{}
	Ορίζουμε ως εξής τη \textbf{διαμόρφωση φάσης}:
	\[
	\boxed{\theta_i(t) = 2πf_c t + k_p m(t)}
	\]
	όπου το \( k_p \) είναι μια σταθερά που μετριέται π.χ σε \( \si{\radian/\volt} \).
	\tcblower
	Δηλαδή το σήμα μας είναι της μορφής:
	\[
	\boxed{s(t) = A_c\cos \left[2πf_c t + k_p m(t)\right]}
	\]
\end{defn}
Η διαμόρφωση φάσης οδηγεί στη μαθηματική έκφραση και της στιγμιαίας συχνότητας:
\[
\boxed{f_i(t) = f_c + \frac{k_m}{2π} \od{m(t)}{t}}
\]

\begin{defn}{FM - Διαμόρφωση Συχνότητας}{}
	Ορίζουμε ως εξής τη \textbf{διαμόρφωση φάσης}:
	\[
	\boxed{f_i(t) = f_c + k_f m(t)}
	\]
	όπου το \( k_f \) είναι μια σταθερά που μετριέται π.χ σε \( \si{\hertz/\volt} \).
	\tcblower
	Για να υπολογίσουμε το σήμα, έχουμε, από τη σχέση \( f_i(t) = \frac{\dif \theta_i(t)}{2π\dif t} \):
	\begin{align*}
		\frac{1}{2π}\od{\theta_i(t)}{t} &= f_c+k_f m(t) \implies\\
		\theta_i(t) &= 2πf_ct + 2πk_f \int_{0}^{t} m(τ)\dif τ
	\end{align*}
	
	Άρα το σήμα μας είναι:
	\[
	\boxed{s(t) = A_c\cos\left[ 2πf_c t + 2πk_f\int_{0}^{t} m(τ)\dif τ \right] }
	\]
\end{defn}

\subsubsection{Ισχύς}
Θυμόμαστε από \hyperref[am.power]{προηγούμενο κεφάλαιο} ότι η ισχύς ενός σήματος είναι:
\[
P_w = \frac{1}{2}A_c^2
\]

Αφού έχουμε σταθερό πλάτος, η ισχύς αυτή παραμένει σταθερή, και γενικά για τις διαμορφώσεις
γωνίας είναι μικρή.

\paragraph{}
Επίσης, επισημαίνουμε ότι οι διαμορφώσεις γωνίας \textit{δεν είναι γραμμικές}.
Πράγματι, αν έχουμε δύο σήματα \( m_1(t) + m_2(t) \) που θέλουμε να προσθέσουμε και
να διαμορφώσουμε κατά PM:
\begin{align*}
	m(t) &= m_1(t) + m_2(t) \\
	s_1(t) &= A_c\cos \left[ 2πf_c t + k_p m_1(t) \right] \\
	s_2(t) &= A_c\cos \left[ 2πf_c t + k_p m_2(t) \right] \\
	s(t) &= A_c\cos \left[ 2πf_c t + k_p \left( m_1(t)+m_2(t)\right)\right] \\
	s(t) &\neq s_1(t) + s_2(t), \qquad \text{δηλαδή δεν ισχύει η συνθήκη γραμμικότητας.}
\end{align*}

Η έλλειψη γραμμικότητας αυτή οδηγεί στο άπλωμα του PM/FM διαμορφωμένου σήματος στο φάσμα.
Για αυτόν το λόγο οι ραδιοφωνικοί σταθμοί FM βρίσκονται σε υψηλότερες συχνότητες
(88-108 MHz) από τους αντίστοιχους στα AM.

\paragraph{Ένα παράδειγμα}
Έστω ότι θέλουμε να στείλουμε ένα σήμα:
\todo{Graph 86}

με συχνότητα φέροντος \( f_c = \frac{1}{4} \), πρώτα με \textit{διαμόρφωση φάσης} με
\( k_p = \frac{π}{2}\ \si{\radian/\volt} \),
και μετά με \textit{διαμόρφωση συχνότητας} με \( k_f = \SI{1}{\hertz/\volt} \).

\subparagraph{Με διαμόρφωση φάσης}
Έχουμε:
\[
s(t) = \left\lbrace \begin{array}{lr}
A_c\cos(2πf_c t + k_p at), &\quad t \geq 0 \\
A_c\cos(2πf_c t), &\quad t < 0
\end{array} \right\rbrace = \begin{cases}
A_c\cos(πt) &\qquad t \geq 0 \\
A_c\cos(\sfrac{πt}{2} ) &\qquad t < 0
\end{cases}
\]
Βλέπουμε δηλαδή ότι η συχνότητα του σήματος μετά το 0 είναι διπλάσια από αυτήν πριν το 0.
Αν θέλουμε να υπολογίζουμε τα σημεία στα οποία μηδενίζεται η συνάρτηση δεξιά του 0,
έχουμε \( 2πf_c t_n + k_pat_n = \frac{π}{2} + nπ \implies t_n = \frac{1}{2} + n \).

\subparagraph{Με διαμόρφωση συχνότητας}
Έχουμε:
\[
s(t) = \left\lbrace \begin{array}{lr}
A_c\cos(2πf_c t + πk_f at^2), &\quad t \geq 0 \\
A_c\cos(2πf_c t), &\quad t < 0
\end{array} \right\rbrace = \begin{cases}
A_c\cos\left( \frac{π}{2}t + πt^2 \right) &\qquad t \geq 0 \\
A_c\cos(\sfrac{πt}{2} ) &\qquad t < 0
\end{cases}
\]

Μάλιστα, δεξιά του 0, η στιγμιαία συχνότητα θα είναι:
\begin{align*}
	f_i(t) &= \frac{1}{2π}\od{\theta(t)}{t} = \frac{1}{2}\cdot \left(\frac{1}{2}+2πt\right)
\end{align*}
δηλαδή η συχνότητα του εκπεμπόμενου σήματος θα αυξάνεται συνεχώς:
\todo{Graph 88}

Αντίστοιχα, αν θέλουμε να υπολογίσουμε τα σημεία στα οποία περνάμε από το 0, θέλουμε:
\begin{align*}
	2πf_c t_n + πk_fat^2_n &= \frac{π}{2} + n π \implies \\
	t_n^2 + \frac{1}{2} t_n -n -\frac{1}{2} &= 0 \implies
	t_n = \frac{1}{4} \left( -1 + \sqrt{9+16n} \right)
\end{align*}
\todo{Improvise a graph like Graph 89}

\subsubsection{Δυαδικότητα των διαμορφώσεων}

\begin{align*}
	\text{PM}: &\quad A_c\cos\left[2πf_c t + k_p m(t)\right] \\
	\text{FM}: &\quad A_c\cos\left[2πf_c t + 2π k_f \int_{0}^{τ} m(τ)\dif τ\right]
\end{align*}

Παρατηρούμε ότι ουσιαστικά οι διαμορφωτές FM και PM διαφέρουν μόνο κατά μία ολοκλήρωση
ή παραγώγιση της πληροφορίας:
\todo{Graph 90}

Δηλαδή αν στην είσοδο ενός διαμορφωτή PM βάλουμε ένα ολοκληρωμένο σήμα, θα πάρουμε FM.
Αν στην είσοδο ενός διαμορφωτή FM βάλουμε ένα σήμα που έχει παραγωγιστεί, θα πάρουμε PM.
Επομένως, μπορούμε να αναλύσουμε μόνο το FM σήμα, αντί να πραγματοποιούμε ξεχωριστή
ανάλυση για τα δύο είδη διαμορφώσεων.

\subsection{FM}
Η διαμόρφωση του FM, όπως είδαμε παραπάνω, είναι:
\[
s(t) = A_c\cos (2πf_ct + 2πk_f \int_0^\infty m(λ)\dif λ)
\]

Αν θεωρήσουμε ότι έχουμε ημιτονοειδές σήμα εισόδου \textbf{με συχνότητα \( \mathbf{f_m} \)}:
\[
m(t) = A_m\cos(2πf_m t)
\]
τότε η στιγμιαία συχνότητα είναι:
\begin{align*}
	f_i(t) &= f_c + k_f A_m \cos (2πf_m t)\\
	&= f_c + Δf \cos (2πf_m t) \qquad \text{όπου } \boxed{Δ f = k_fA_m}
\end{align*}
\begin{defn}{Μέγιστη απόκλιση συχνότητας}{}
	Ορίζουμε το:
	\[
	Δf = k_fA_m
	\]
	ως τη \textbf{μέγιστη απόκλιση συχνότητας}, η οποία φαίνεται ότι εξαρτάται
	μόνο από το πλάτος του σήματος.
\end{defn}

Θυμόμαστε τον ορισμό της στιγμιαίας συχνότητας:
\[
\frac{1}{2π} \od{\theta_i(t)}{t} = f_i(t)
\implies \theta_i = 2π\int_0^t f_i(t) \dif t
\]
Άρα, για ημιτονοειδές σήμα:
\[
\theta_i(t) = 2πf_c t + \frac{Δf\;f_m}{\sin 2π f_m t}
\]
και το διαμορφωμένο FM σήμα είναι:
\[
s_\mathrm{FM}(t) = A_c \cos \left[ 2πf_ct + \frac{Δf}{f_m} \sin 2πf_m t \right]
\]

\begin{defn}{Δείκτης διαμόρφωσης}{}
	Ορίζουμε τον \textbf{δείκτη διαμόρφωσης \( \mathbf{\beta} \)} (modulation index)
	ως εξής:
	\[
	β = \frac{Δf}{f_m} = \frac{A_m k_f}{f_m}
	\]
	
	Ο δείκτης διαμόρφωσης στην ουσία εκφράζει την \textbf{απόκλιση φάσης}.
\end{defn}

Άρα η \textbf{τελική έκφραση} της διαμόρφωσης FM είναι:
\[
s_{\mathrm{FM}}(t) = A_c \cos(2π f_c t + β\sin 2πf_m t)
\]

Τυπικοί δείκτες διαμόρφωσης είναι \( 1 \leq β \leq 20 \), και όπως θα δούμε
αργότερα, το \( β \) επηρεάζει το εύρος ζώνης του εκπεμπόμενου σήματος. Για μεγάλα
\( β \) έχουμε FM ευρείας ζώνης, ενώ για μικρά \( β \) (π.χ 0.5 ή 0.3) έχουμε
FM στενής ζώνης (Narrow Band FM ‒ NBFM).

Αντίστοιχα, για το PM ισχύει:
\begin{align*}
	\theta_i (t) &= 2πf_c t + A_m k_p \cos 2πf_m t \\
	β_P &= k_p A_m\\
	f_i(t) &= f_c - \frac{k_pA_m f_c}{2π}\sin 2π f_m t\\
	s_{\mathrm{PM}}(t) &= A_c\cos(2π f_c t + \underbrace{A_mk_p}{β_P} \cos 2πf_m t)
\end{align*}

\subsubsection{NBFM}

Αν αναλύσουμε τον τύπο του διαμορφωμένου σήματος FM, θα έχουμε:
\begin{align*}
	s(t) &= A_c \cos\left[ 2πf_c t + β\sin 2π f_m t \right] \\
	&= A_c \cos 2πf_c t \cos (β\sin 2π f_m t) - A_c \sin(2πf_c t)
	\sin(β\sin 2πf_m t)
\end{align*}

Όταν για το \( β \) ισχύει \( \underline{β \ll \SI{1}{\radian}} \), τότε λέμε
ότι έχουμε FM στενής ζώνης (\textbf{Narrow Band FM ‒ NBFM}). Πρακτικά αυτό
συμβαίνει όταν το \( β \) είναι μικρότερο του \( 0.3 \), ή ακόμα και του \( 0.5 \).

Τότε μπορούμε να θεωρήσουμε τις προσεγγίσεις:
\begin{align*}
	\cos\left[β\sin 2πf_m t\right] &\simeq 1 \\
    \sin\left[β\sin 2πf_m t\right] &\simeq β\sin 2πf_m t
\end{align*}

Άρα προσεγγιστικά ισχύει:
\begin{align*}
	s(t) &\simeq A_c\cos 2πf_c t - βA_c \sin(2πf_m t)\sin(2πf_c t) \\
	&= A_c\cos 2πf_c t + \frac{1}{2}βA_c \left[
	    \cos 2π(f_c+f_m)t - \cos 2π(f_c-f_m)t
	\right]
\end{align*}

Η παραπάνω έκφραση όμως μοιάζει με ένα σήμα διαμορφωμένο κατά AM. Πράγματι,
γενικά για τα AM σήματα ισχύει:
\begin{align*}
	s_{\mathrm{AM}}(t) &= A_c (1 + \overset{\raisebox{2pt}{\ensuremath{\mathclap{k_aA_m}}}}{\mu}\cos 2πf_m t)\cos 2πf_c t
	\\ &= A_c \cos 2π f_c t + μA_c \cos 2π f_m t \cos 2πf_c t
	\\ &= A_c \cos 2π f_c t + \frac{1}{2}μA_c\left[
	\cos 2π(f_c+f_m)t + \cos 2π(f_c-f_m)t
	\right]
\end{align*}

\begin{absolutelynopagebreak}
Τα δύο σήματα φαίνονται παρόμοια, και μπορούμε να συγκρίνουμε τις υλοποιήσεις
του διαμορφωτή και τα φάσματα εξόδου:

\begin{tikzpicture}
\node[rectangle,draw,scale=2] (mult) at (0,0) {$\times$};
\node[oscillator,xshift=14pt] (osc) at (0,-2) {};
\node[circle,draw,minimum size=10mm] (sum) at (2,0) {$\sum$};

\draw (mult) -- ++(-3,0) node[midway,above] {$m(t)$} node[midway,below] {$A_m\cos 2πf_c t$};

\draw[->] (mult) -- (sum.west) node[above left] {$+$};
\draw[->] (osc.north) -- (mult);
\draw[->] (osc.east) -| (sum.south) node[below left] {$+$};
\draw[->] (sum) -- ++(2,0) node[below] {$s_{\mathrm{AM}}(t)$};

\draw (osc.west) node[left] {$A_c\cos 2πf_c t$};

\node[above left] at (-2,1) {AM};

\begin{scope}[xshift=8cm,yshift=-2cm]
\draw (-3,0) -- (3,0);
\draw (0,-0.5) -- (0,2)  node[right] {$s_{\mathrm{AM}}$};

\draw[draw=blue!50!cyan!80!orange,very thick,every node/.style={scale=.4}]
(-1.5,0) node[below] {$-f_c$} edge[->] ++(0,1)
(-2,0) node[below] {$-f_c-f_m$} edge[->] ++(0,0.7)
(-1,0) node[below] {$-f_c+f_m$} edge[->] ++(0,0.7)
(1.5,0) node[below] {$f_c$} edge[->] ++(0,1)
(2,0) node[below] {$f_c+f_m$} edge[->] ++(0,0.7)
(1,0) node[below] {$f_c-f_m$} edge[->] ++(0,0.7)
;
\end{scope}

\begin{scope}[yshift=-6cm]
\node[rectangle,draw,scale=2] (mult) at (0,0) {$\times$};
\node[oscillator,xshift=14pt] (osc) at (0,-4) {};
\node[circle,draw,minimum size=10mm] (sum) at (2,0) {$\sum$};
\node[rectangle,draw] (ps1) at (-2,0) {$-\ang{90}$};
\node[rectangle,draw] (ps2) at (0,-2) {$-\ang{90}$};

\draw (mult) -- (ps1) edge[<-] ++(-1,0);

\draw[->] (mult) -- (sum.west) node[above left] {$-$};
\draw[->] (osc.north) -- (ps2) -- (mult);
\draw[->] (osc.east) -| (sum.south) node[below left] {$+$};
\draw[->] (sum) -- ++(2,0) node[below] {$s_{\mathrm{NBFM}}(t)$};

\draw (osc.west) node[left] {$A_c\cos 2πf_c t$};

\node[above left] at (-2,1) {NBFM};

\begin{scope}[xshift=8cm,yshift=-2cm]
\draw (-3,0) -- (3,0);
\draw (0,-0.5) -- (0,2) node[right] {$s_{\mathrm{NBFM}}$};

\draw[draw=blue!50!cyan!80!orange,very thick,every node/.style={scale=.4}]
(-1.5,0) node[below] {$-f_c$} edge[->] ++(0,1)
(-2,0) node[below] {$-f_c-f_B$} edge[->] ++(0,0.7)
(-1,0) node[above] {$-f_c+f_B$} edge[->] ++(0,-0.7)
(1.5,0) node[below] {$f_c$} edge[->] ++(0,1)
(2,0) node[below] {$f_c+f_B$} edge[->] ++(0,0.7)
(1,0) node[above] {$f_c-f_B$} edge[->] ++(0,-0.7)
;
\end{scope}
\end{scope}

\end{tikzpicture}
\end{absolutelynopagebreak}

Αν παραστήσουμε την έκφραση του AM σε μορφή φασιθετών, θα έχουμε ένα διάνυσμα
\( A_c \) που περιστρέφεται με ταχύτητα \( \omega_c = 2π f_c \), και στο τέλος
του μπορούμε να προσθέσουμε τα δύο διανύσματα που περιστρέφονται με ταχύτητες
\( 2π(f_c+f_m) \) και \( 2π(f_c-f_m) \). Το πρώτο περιστρέφεται πιο γρήγορα
από το \( \omega_c \), και το δεύτερο πιο αργά. Όμως η συνιστώσα τους είναι προς
την κατεύθυνση του \( A_c \), και το πλάτος της αυξάνεται και μειώνεται ημιτονοειδώς:

\begin{tikzpicture}[scale=1]
\draw[very thick,->] (0,0) -- (4,0) node[near start,below] {$A_c$};

\draw[yshift=2mm,cyan,->]
(1,0) to[bend right] node[midway,above right,scale=.8] {$\omega_c=2πf_c$} ++(-0.4,0.4);

\filldraw[xshift=3cm,yshift=0.1cm,draw=gray,bottom color=cyan!50!gray,top color=white]
(0,0) -- +(-0.1,-0.1)
(0,0) -- +(0.1,-0.1)
(0,0) -- +(0,0.4)
(0,0.5) circle (0.1)
(0,0.4) -- ++(0.1,-0.1)
(0,0.4) -- ++(-0.1,-0.1)
;

\draw[->] (4,0) -- ++(45:1);
\draw[->] (4,0) -- ++(-45:1);
\draw[dashed,gray] (4,0) ++(45:1) -- ++(45-90:1);
\draw[dashed,gray] (4,0) ++(-45:1) -- ++(-45+90:1);
\draw[very thin,->] (4,0) -- ({4+sqrt(2)+0.05},0);
\draw (4,0) ++(45:0.2) to[bend left] node[near start,right,gray!50!brown!30!black,scale=.7] {$2πf_mt$} (4.2,0);
\draw (4,0) ++(-45:0.3) to[bend right] node[very near start,right,gray!50!brown!30!black,scale=.7] {$-2πf_mt$} (4.3,0);

\draw (4,0) ++(45:0.5) node (a) {};
\draw (a) ++(45+90:0.2) node(a1) {};
\draw (a) ++(45-90:0.15) node(a2) {};
\draw[<-,cyan!50!black] (a1.center) to[bend left] (a2.center);

\draw (4,0) ++(-45:0.5) node (a) {};
\draw (a) ++(-45+90:0.15) node(a1) {};
\draw (a) ++(-45-90:0.2) node(a2) {};
\draw[->,cyan!50!black] (a1.center) to[bend left] (a2.center);
\end{tikzpicture}

Αντίστοιχα, για το NBFM μπορούμε να πραγματοποιήσουμε μια παρόμοια ανάλυση,
φροντίζοντας ώστε να αλλάξουμε την κατεύθυνση του διανύσματος με γωνία
\( -2πf_m t \), αφού έχει αρνητικό πρόσημο. Τελικά θα πάρουμε ως άθροισμα ένα
διάνυσμα με μία ελαφριά διαφορά γωνίας από αυτήν του \( A_c \), δηλαδή θα
"τρεμοπαίζει" συνεχώς στο χρόνο. Αυτό το τρεμόπαιγμα περιέχει και την πληροφορία.

\begin{tikzpicture}[scale=1]
\fill[top color=yellow,bottom color=white,->]
(1,0) to[bend right] ({atan(sqrt(2)/4)}:1) -- (0,0);

\draw[cyan,->]
(2,-0.2) to[bend right] node[midway,above right,scale=.8] {$\omega_c$} (1.8,0.2);

\filldraw[xshift=3cm,yshift=0.1cm,draw=gray,bottom color=cyan!50!gray,top color=white]
(0,0) -- +(-0.1,-0.1)
(0,0) -- +(0.1,-0.1)
(0,0) -- +(0,0.4)
(0,0.5) circle (0.1)
(0,0.4) -- ++(0.1,-0.1)
(0,0.4) -- ++(-0.1,-0.1)
;

\draw[->] (4,0) -- ++(45:1);
\draw[dashed,->,red] (4,0) -- ++(-45:1);
\draw[->] (4,0) -- ++(90+45:1);
\draw[dashed,gray] (4,0) ++(45:1) -- ++(45+90:1);
\draw[dashed,gray] (4,0) ++(90+45:1) -- ++(-45+90:1);
\draw[very thin,gray] (4,0) -- ({4+sqrt(2)+0.05},0);
\draw[thick,->] (4,0) -- (4,{sqrt(2)+0.05});
\draw (4,0) ++(45:0.2) to[bend left] node[near start,right,gray!50!brown!30!black,scale=.7] {$2πf_mt$} (4.2,0);
\draw (4,0) ++(-45:0.3) to[bend right] node[very near start,right,gray!50!brown!30!black,scale=.7] {$-2πf_mt$} (4.3,0);

\draw (4,0) ++(45:0.5) node (a) {};
\draw (a) ++(45+90:0.2) node(a1) {};
\draw (a) ++(45-90:0.15) node(a2) {};
\draw[<-,cyan!50!black,opacity=.5] (a1.center) to[bend left] (a2.center);

\draw (4,0) ++(-45:0.5) node (a) {};
\draw (a) ++(-45+90:0.15) node(a1) {};
\draw (a) ++(-45-90:0.2) node(a2) {};
\draw[->,cyan!50!black,opacity=.5] (a1.center) to[bend left] (a2.center);

\draw[orange!70!black,ultra thick,->] (0,0) -- (4,{sqrt(2)});
\draw[very thick,->] (0,0) -- (4,0) node[near start,below] {$A_c$};

\draw[->]
(1,0) to[bend right] ({atan(sqrt(2)/4)}:1);
\end{tikzpicture}

\subsubsection{Ισχύς}
Έστω ένα σήμα διαμορφωμένο κατά DSB-SC:
\[
u(t) = A_c m(t) \cos (2πf_c t)
\]

Για την συνάρτηση αυτοσυσχέτισης του σήματος ισχύει:
\begin{align*}
	\mathcal R_{u(τ)}
	&= \lim_{T\to \infty} \frac{1}{T} \int_{-\sfrac{T}{2} }^{\sfrac{T}{2} }
	u(t)u(t-τ)\dif t \\
	&= \lim_{Τ\to \infty}\frac{1}{T} \int_{\sfrac{-T}{2} }^{\sfrac{T}{2} }
	A_c^2 m(t) m(t-τ) \cos(2πf_c t)\cos(2πf_c(t-τ)) \dif t
	\\ &= \frac{A_c^2}{2} \lim_{T\to \infty}\frac{1}{T}
	\int_{\sfrac{-T}{2} }^{\sfrac{T}{2} } m(t)m(t-τ)
	\left[ \cos(4πf_ct-2πf_cτ) + \cos(2πf_cτ) \right]\dif t
\end{align*}

Θα αναλύσουμε ξεχωριστά τον όρο \( \int_{-\infty}^{\infty} m(t)m(t-τ) \cos(
4πf_ct - 2πf_c τ
) \dif t \).

Από το θεώρημα του Parseval ισχύει:
\[
\int_{-\infty}^{\infty} x(t) y^*(t)\dif t
= \int_{-\infty}^{\infty} X(f) Y*(f)\dif f
\]
άρα έχουμε:
\begin{align*}
	&\hphantom{=}\int_{-\infty}^{\infty} m(t)m(t-τ) \cos (4πf_c t - 2πf_c τ)\dif τ\\ &=
	\int_{-\infty}^{\infty} F\left[m(t-τ)\right] \left\lbrace 
	    F\left[m(t)\cos(4πf_ct-2πf_cτ)\right]
	 \right\rbrace^* \dif t
	 \\ &= \int_{-\infty}^{\infty} e^{-j2πf_c t}M(f)
	 \left[
	      -\frac{M(f-2f_c)e^{-j2πf_ct}}{2}
	      +\frac{M(f+2f_c)e^{-j2πf_ct}}{2}
	 \right]^* \dif t
\end{align*}

Επειδή θεωρούμε το \( f_c \) πολύ μεγάλο, δεν υπάρχει περίπτωση ο πολλαπλασιασμός των δύο
παραπάνω όρων να δώσει τιμή διαφορετική του 0 (αφού τα φάσματα βρίσκονται σε διαφορετικό
σημείο \begin{tikzpicture}[baseline,scale=.4,every node/.style={scale=.5}]
\draw (-4,0) -- (4,0);

\draw [blue!50!cyan!90!orange,very thick]
(-0.7,0) -- (0,1) node[above] {$M(f)$} -- (0.7,0);
\draw [blue!90!cyan!80!orange,very thick]
[xshift=-3cm] (-0.7,0) -- (0,1) -- (0.7,0)
[xshift=6cm] (-0.7,0) -- (0,1) -- (0.7,0)
;

\foreach \x in {-3,0,...,3}
\draw[dashed] (\x,0) -- ++(0,1);

\draw (-3,0) node[below] {$-2f_c$};
\draw (3,0)  node[below] {$+2f_c$};
\end{tikzpicture} άρα το παραπάνω ολοκλήρωμα είναι 0).

Επομένως:
\begin{align*}
	\mathcal R_{u}(τ) &= \frac{Ac^2}{2} \cos 2π f_c τ \lim_{T\to \infty}\frac{1}{T}
	\int_{\sfrac{-T}{2} }^{\sfrac{T}{2} } m(t) m (t-τ)\dif t
	\\ &= \frac{A_c^2}{2} \mathcal{R}_m(τ)\cos 2πf_c τ
\end{align*}

Άρα για την \textbf{ισχύ} του σήματος ισχύει:
\[
P_u = \mathcal{R}_u(0) = \frac{A_c^2}{2}\mathcal{R}_u(0) = \frac{1}{2}A_c^2P_m
\]
όπου \( P_m \) η ισχύς του \( m(t) \).

Θυμόμαστε τον ορισμό της ισχύος:
\begin{align*}
	P_u &= \lim_{T\to \infty} \frac{1}{T}
	\int_{\sfrac{-T}{2} }^{\sfrac{T}{2} } A_c^2m^2(t) \cancelto{\frac{1}{2}+\frac{1}{2}\cos2π2f_ct}{cos^2 2πf_c t}\dif t
	\\ &= \frac{A_c^2}{2} \cancelto{P_m}{\lim_{T\to \infty}\int_{\sfrac{-T}{2} }^{\sfrac{T}{2} } m^2(t)\dif t}
	+ \frac{A_c^2}{2} \lim_{T\to \infty}\frac{1}{T}
	\cancelto{0}{\int_{\sfrac{-T}{2} }^{\sfrac{T}{2} } m^2(t)\cos(2π2f_ct) \dif t}
	\\ &= \frac{A_c^2}{2}P_m
\end{align*}
Το δεύτερο ολοκλήρωμα ήταν 0, αφού ήταν ολοκλήρωμα στο άπειρο με μία συμμετρική συνάρτηση
(\( \cos \)) πολλαπλασιασμένη με μια πολύ αργή (άρα πρακτικά σταθερή).

\subsubsection{Στο φάσμα της συχνότητας}
Έστω ότι έχουμε ένα απλό ημιτονοειδές σήμα πληροφορίας:
\[
m(t) = A_m\cos 2πf_m t
\]
και το διαμορφωμένο κατά FM:
\[
s(t) = A_c\cos(2πf_c t + β\sin 2πf_m t)
\]

Το παραπάνω σήμα εν γένει δεν είναι περιοδικό: Η συχνότητα του φέροντος \( f_c \)
δημιουργεί μία περίοδο \( \frac{1}{T_c} \), και η συχνότητα \( f_m \) δημιουργεί μια
περίοδο \( \frac{1}{T_m} \). Αν οι δύο περίοδοι είναι ρητά πολλαπλάσια μεταξύ τους, τότε
θα έχουμε μια αρκετά μεγάλη περίοδο, διαφορετικά το σήμα δεν θα είναι καθόλου περιοδικό.

Επομένως δεν είναι εύκολο να λάβουμε τη σειρά ή και το μετασχηματισμό Fourier του σήματος
αυτού. Για αυτό το λόγο καταφεύγουμε στο ακόλουθο τέχνασμα.

\begin{defn}{Μιγαδική μορφή FM σήματος}{}
\begin{align*}
s(t) &= \Re\left[ A_c \exp(j2πf_c t +jβ\sin 2π f_m t) \right]
\\ &= \Re\left[ \exp(jβ\sin 2πf_m t) \cdot \exp(j2πf_c t) \right]
\\ &= \Re\left[ \tilde{s}(t) \exp(j2πf_c t) \right]
\end{align*}
όπου ορίσαμε τη \textbf{μιγαδική περιβάλλουσα} \( \tilde{s}(t) \) ως εξής:
\[
\widetilde{s}(t) = A_c\exp\left[ jβ\sin(2πf_m t) \right]
\]
\end{defn}

Η περιβάλλουσα αυτή έχει μία περίοδο \( f_m \), οπότε και μία σειρά Fourier:
\begin{align*}
	\tilde s(t) &= \sum_{n=-\infty}^{\infty} c_n \exp(j2πnf_m t)
	\intertext{όπου (από τη θεωρία των σειρών Fourier):}
	c_n &= f_m \int_{-\sfrac{1}{2}f_m }^{\sfrac{1}{2} f_m }
	s(t) \cdot \exp(-j2πnf_m t)\dif t
	\\ c_n &= f_mA_c \int_{-\sfrac{1}{2}f_m }^{\sfrac{1}{2} f_m }
	\exp\left[ jβ\sin(2πf_m t) - j2πnf_m t \right]\dif t
	\\ \Aboxed{c_n &= \frac{A_c}{2π}
		\frac{-π}{π}\exp\left[ jβ\sin x - jnx \right] \dif x
		} \qquad \text{όπου θέσαμε } x=2πf_m t
\end{align*}

Το παραπάνω ολοκλήρωμα που καλούμαστε να υπολογίσουμε δεν μπορεί να εκφραστεί αναλυτικά,
αλλά προκύπτει από \textbf{πίνακες} της ορισμένης ως εξής
\textbf{συνάρτησης Bessel πρώτου είδους}:

\begin{defn}{Συνάρτηση Bessel πρώτου είδους}
	Η \textbf{συνάρτηση Bessel πρώτου είδους} έχει \textbf{όρισμα} το \( β \) και ορίζεται
	ως εξής:
	\[
	J_n(β) = \frac{1}{2π} \int_{-π}^{π} \exp\left[ j(β\sin x-nx) \right]\dif x
	\]
	
	Αριθμητικές τιμές αυτής της συνάρτησης μπορούμε να πάρουμε από πίνακες, διαγράμματα,
	αριθμομηχανές ή υπολογιστές.
\end{defn}

\todo{Graph 92}

Επομένως μπορούμε τώρα να θέσουμε:
\[
c_n = A_c J_n(β)
\]
και τελικά προκύπτει ότι:
\begin{align*}
	\tilde{s}(t) &= A_c\sum_{n=-\infty}^{\infty} J_n(β) \exp(j2πnf_m t) \\
	s(t) &= A_c\Re\left[
		\sum_{n=-\infty}^{\infty}J_n(β)\exp\left[
		j2π(f_c+nf_m t)
		\right]
		\right] \\
	\Aboxed{s(t) &= A_c \sum_{n=-\infty}^{\infty} J_n(β)\cos\left[
	2π(f_c+nf_m)t
	\right] }
\end{align*}

Δηλαδή, αφού χρησιμοποιήσαμε την έννοια της μιγαδικής περιβάλλουσας και ορίσαμε τη συνάρτηση
Bessel, προέκυψε η αναπαράσταση του διαμορφωμένου κατά FM σήματος στο φάσμα της συχνότητας.

\begin{theorem}{FM ημιτονοειδών σημάτων}{}
	Για ένα ημίτονο συχνότητας \( f_m \) που διαμορφώνουμε κατά FM με φέρον \( f_c \)
	και \( β \), το διαμορφωμένο σήμα είναι:
	\[
	\boxed{
		s(t) = A_c \sum_{n=-\infty}^{\infty} J_n(β) \cos \left(2πf_ct + 2πnf_m t\right)
		}
	\]
	όπου \( J_n \) είναι η συνάρτηση J-Bessel (πρώτου είδους).
\end{theorem}

Στο πεδίο των συχνοτήτων έχουμε:
\[
S(f) = \frac{A_c}{2}\sum_{n=-\infty}^{\infty} J_n(β)
\left[
\delta(f-f_c-nf_m)
+\delta(f+f_c+nf_m)
\right]
\]

Το φάσμα δηλαδή αποκτάει μια μορφή:
\todo{Graph 93}

Σε συνδυασμό με το διάγραμμα της συνάρτησης Bessel, μπορούμε να δούμε πως όσο απομακρυνόμαστε
από τη συχνότητα του φέροντος \( f_c \), μειώνεται και το πλάτος των συχνοτήτων. Υπάρχει
περιεχόμενο και στη συχνότητα \( f_c \), αλλά για μερικές τιμές του \( β \) μπορεί να μηδενιστεί.

\paragraph{Ιδιότητες συναρτήσεων Bessel}

\begin{itemize}
\item Ισχύει:
\[
\begin{cases}
\text{για $n$ άρτιο } \implies & J_n(β) = J_{-n}(β) \\
\text{για $n$ περιττό } \implies & J_n(β) = -J_{-n}(β)
\end{cases}
\]
δηλαδή ισχύει \( J_n(β) = (-1)^n J_{-n}(β) \).

\item Προσεγγιστικά για τις συναρτήσεις Bessel μπορούμε να θεωρήσουμε ότι:
\[
\boxed{
	\begin{aligned}
	J_0(β) &\simeq 1 \\
	J_1(β) &\simeq \sfrac{β}{2} \\
	J_n(β) &\simeq 0 \quad \text{για }n \geq 2
	\end{aligned}
}
\]

Μάλιστα, αν θεωρήσουμε ότι ο δείκτης διαμόρφωσης \( β \) είναι αρκετά μικρός ώστε να έχουμε
NBFM (Narrow Band FM), τότε προκύπτουν τα ίδια αποτελέσματα με την παραπάνω ανάλυση του
NBFM.

\item Τέλος, ισχύει:
\[
\sum_{n=-\infty}^{\infty} J_n^2(β) = 1 \quad \forall β
\]

Αυτή η σχέση είναι χρήσιμη για την εύρεση της ισχύος του σήματος:
\[
P = \frac{A_c^2}{2} \cancelto{1}{\sum_{n=-\infty}^{\infty} J_n^2(β)}
\]

\end{itemize}

Παρατηρούμε ότι το φάσμα του FM εκτείνεται ως το άπειρο, κάτι που εξ' αρχής φαίνεται
προβληματικό.

\paragraph{Προχωρώντας}
Θυμόμαστε τους τύπους για την \textit{απόκλιση συχνότητας} και το συντελεστή διαμόρφωσης:
\begin{align*}
	Δf &= k_fA_m \\
	β &= \frac{k_fA_m}{f_m} = \frac{Δf}{f_m}
\end{align*}

Μπορούμε να μεταβάλλουμε τα \( A_m \) και \( f_m \), και να παρατηρήσουμε τη μεταβολή
στο φάσμα των συχνοτήτων:
\todo{Graph 94}

Γενικά όμως βλέπουμε ότι οι πιο ισχυρές συχνότητες βρίσκονται \( \underline{Δf} \) αριστερά
και δεξιά της \( f_c \). Επομένως, αν λάβουμε υπ' όψιν και μία ακόμα πλευρική ζώνη,
προκύπτει ο εμπειρικός
rule-of-thumb \textbf{κανόνας του Carson} για το εύρος ζώνης \( B_{T} \):
\begin{align*}
	B_T &\simeq 2Δf + 2f_m
	\\ &=2βf_m + 2f_m
	\\ &= \boxed{2(β+1)f_m \simeq B_T}
\end{align*}

Συγκρίνουμε το εύρος ζώνης αυτό με το αντίστοιχο του FM, που ήταν \( B_T=2f_m \). Το σήμα
του FM, ειδικά για τιμές όπως \( β = 5 \), έχει πολλαπλάσιο (\( B_T = 12f_m \)) εύρος ζώνης
από το αντίστοιχο του AM, και είναι \textit{ευρυζωνικό} σήμα.

Γενικά, αν έχουμε εύρος ζώνης \( B_T \), πρέπει να πάρουμε τουλάχιστον \( n_{\max} \)
συχνότητες, όπου:
\[
B_T = 2n_{\max}f_m
\]
και το \( n_{\max} \) ή το \( B_T \) υπολογίζονται με τον κανόνα του Carson ή με έναν
από τους παρακάτω τρόπους.

Ένας άλλος τρόπος να υπολογίσουμε το επιθυμητό εύρος ζώνης του φάσματος είναι αν από τις
συχνότητες του φάσματος απορρίψουμε μόνο τις συχνότητες εκείνες που \textbf{έχουν πλάτος 
μικρότερο από το 1\% του \( A_c \)}. Υπάρχουν
μάλιστα πίνακες ή διαγράμματα που δείχνουν πόσες συχνότητες χρειάζεται να λάβουμε υπ' όψιν 
για κάθε επιλογή του \( β \).
\todo{Graph 95}
Εναλλακτικά, θα μπορούσαμε να συμπεριλαμβάνουμε συχνότητες μέχρι να φτάσουμε στο
98\% της ισχύος του εκπεμπόμενου σήματος.

\paragraph{}
Η παραπάνω ανάλυση έγινε για ένα ημιτονοειδές σήμα πληροφορίας, αλλά δεν μπορεί να
χρησιμοποιηθεί για ένα τυχαίο σήμα εύρους ζώνης \( w \). Αντί για αυτό όμως, μπορούμε
να θεωρήσουμε ένα ημιτονοειδές σήμα συχνότητας \( w \), και να λάβουμε \textit{ασφαλή}
αποτελέσματα, αφού θεωρούμε την πιο δυσμενή περίπτωση.

\todo{Graph 96}

\begin{defn}{Ανάλυση τυχαίου σήματος FM στη συχνότητα}{}
Σε αυτήν την ανάλυση, επανααντιστοιχίζουμε τα ονόματα των μεταβλητών ως εξής:
\begin{align*}
	f_m &\leftrightarrow w \\
	β &\leftrightarrow D \quad \text{λόγος απόκλισης}
\end{align*}
Άρα ισχύουν οι τύποι:
\[
\boxed{D=\frac{Δf}{w}}\quad \underset{\text{\small (Carson)}}{\boxed{B_T = 2(D+1)w}}
\]
\end{defn}

Μία τιμή που χρησιμοποιείται τυπικά για το \( Δf \) είναι 75 kHz.

\paragraph{}
Αντίστοιχα με τα NBFM, μπορούμε να παραστήσουμε τις δέλτα από τις οποίες αποτελείται
σαν φασιθέτες (phasors). Για παράδειγμα, αν λάβουμε υπ' όψιν την κεντρική συνιστώσα και
δύο πλευρικές, και θεωρήσουμε ότι βρισκόμαστε επάνω στο κινούμενο διάνυσμα της κεντρικής:
\todo{Graph 113}

Αν μάλιστα προσθέσουμε και τις υπόλοιπες συνιστώσες, θα παρατηρήσουμε ότι επηρεάζουν
παραπάνω το τελικό διάνυσμα:
\todo{Graph 114}

Κάθε χρονική στιγμή το σήμα είναι το άθροισμα όλων αυτών των συνημιτόνων, και έχει μια
ταχύτητα που επηρεάζεται από αυτά (με μέση τιμή \( \omega_c \)), αλλά το συνολικό πλάτος του
είναι πάντα \( A_c \).

\paragraph{Παράδειγμα}
Ποιό είναι το εύρος ζώνης ενός FM σήματος με μέγιστη απόκλιση \( Δf = \SI{75}{\kilo\hertz} \)
όπου το εύρος ζώνης του εκπεμπόμενου σήματος είναι \( w=\SI{15}{\kilo\hertz} \).

\subparagraph{Λύση}
Σύμφωνα με τον κανόνα του Carson:
\[
B_T = 2(D+1)w = 2\cdot(5+1)\cdot 15 = \SI{180}{\kilo\hertz}
\]
κάτι πολύ μεγαλύτερο από το αντίστοιχο εύρος ζώνης του FM.

Αντίστοιχα, αν χρησιμοποιήσουμε τους κανόνες για 1\% του πλάτους ή το 98\% της ενέργειας,
θα βρίσκαμε για \( D=5 \), χρησιμοποιώντας πίνακες, \( n_{\max} = 8 \), άρα
\( B_T = 2n_{\max} \cdot w = 16\cdot 15 = \SI{240}{\kilo\hertz} \), που είναι ένας πιο
αυστηρός περιορισμός.

\subsection{Υλοποίηση ενός συστήματος FM}
Να σημειωθεί ότι οι παρακάτω διατάξεις είναι αναλογικές και ίσως δεν χρησιμοποιούνται
σήμερα έναντι των ψηφιακών αντίστοιχων, αλλά παρουσιάζονται για ιστορικούς σκοπούς.

\subsubsection{Διαμορφωτής}
Για να υλοποιήσουμε τον διαμορφωτή ενός σήματος βασικής ζώνης,
χρειαζόμαστε απλώς έναν ταλαντωτή που να παράγει ένα ημίτονο του
οποίου μεταβάλλεται η συχνότητα.

Τέτοιος ταλαντωτής μπορεί να είναι \textbf{Voltage Controlled Οscillator (VCO)}, δηλαδή ταλαντωτής του οποίου η συχνότητα μεταβάλλεται από τάση.

Ένα τέτοιο κύκλωμα είναι:
\todo{Graph 115}

όπου ο μεταβλητός πυκνωτής (varicap/varactor) μπορεί να υλοποιηθεί
από μια ανάστροφα πολωμένη δίοδο
\begin{circuitikz}[baseline]
	\draw (2,0) to[diode] (0,0);
\end{circuitikz}
της οποίας η χωρητικότητα μεταβάλλεται ανάλογα με την εφαρμοζόμενη τάση.

Ισοδύναμα, μπορούμε να απλουστεύσουμε το κύκλωμα ως εξής:
\todo{Graph 116}

Αυτό το κύκλωμα έχει μια μεταβλητή συχνότητα που, με γνώσεις από ανάλυση κυκλωμάτων, είναι:
\[
f_i(t) = \frac{1}{2π\sqrt{(L_1+L_2)C(t)}}
\]
όπου η στιγμιαία χωρητικότητα είναι \( C(t) = C_0 + ΔC \cos 2πf_mt \) να θεωρήσουμε ότι
έχουμε ημιτονοειδές (με συχνότητα \( f_m \)) σήμα εισόδου \( m(t) \).

Τότε η στιγμιαία συχνότητα γίνεται:
\begin{align*}
	f_i(t) &= \frac{1}{2π\sqrt{(L_1+L_2)C_0}\sqrt{1+\frac{ΔC}{C_0}\cos 2πf_m t}}
\end{align*}

Ορίζουμε \( f_0 = \frac{1}{2π\sqrt{(L_1+L_2)C_0}} \), και χρησιμοποιούμε την προσέγγιση
\( \sqrt{1+ε} \simeq 1+\frac{ε}{2} \).

Τότε:
\[
f_i(t) \simeq \frac{f_0}{1+\frac{ΔC}{2C_0}\cos 2πf_m t}
\]

Επιπλέον προσεγγίζουμε \( \frac{1}{-1+ε} \simeq 1-ε \).

\begin{align*}
f_i(t) &\simeq f_0 \left[ 1-\frac{ΔC}{2C_0}\cos 2πf_m t \right]
\\
f_i(t) &\simeq f_0 - \underbrace{\frac{f_0ΔC}{2C_0}}_{Δf} \cos 2πf_m t
\intertext{όπου θέσαμε τον σταθερό όρο \( \frac{f_0ΔC}{2C_0} = Δf \)}
&= f_0 + Δf \cos 2πf_m t
\end{align*}

Δηλαδή φτάσαμε στο επιθυμητό σήμα FM, για το οποίο ισχύει \( f_i(t) = f_c + k_f m(t) \).

\subsubsection{Διαμορφωτής με NBFM}
Εναλλακτικά μπορούμε να χρησιμοποιήσουμε ένα σήμα NBFM για να κατασκευάσουμε \textit{έμμεσα} ένα σήμα
FM. Θυμόμαστε ότι το σήμα NBFM είναι ένα FM με χαμηλό \( β \), π.χ. \( β \leq 0.3 \), και
μοιάζει με AM, οπότε είναι εύκολο να κατασκευάσουμε έναν διαμορφωτή του.

Τότε, χρησιμοποιώντας πολλαπλασιαστές συχνότητας, που είναι στοιχεία που κατασκευάζονται
με μη γραμμικά στοιχεία (π.χ διόδους), κατασκευάζουμε τον εξής διαμορφωτή:
\todo{Graph 117}

Σε κάθε σημείο του διαμορφωτή αυτού θα έχουμε το σήμα:
\begin{enumpar}
	\item Το διαμορφωμένο NBFM είναι: \[ A_c \cos\left( 2πf_o t + β\sin 2πf_m t \right) \]
	\item Πολλαπλασιάζουμε τη συχνότητα με \( n_1 \) και έχουμε:
	\[
	A_c\cos \left[ 2π n_1 f_o t + n_1 β \sin 2πf_m t \right]
	\]
	\item Μετακινούμε τη συχνότητα κατά \( f_l \):
	\[
	A_c\cos \left[ 2π (n_1 f_0 + f_l) t + n_1 β \sin 2π f_m t \right]
	\]
	\item Πολλαπλασιάζουμε τη συχνότητα με \( n_2 \):
	\[
	A_c\cos \left[ 2π n_2(n_1 f_0 + f_l ) t + n_2 n_1 β \sin 2πf_m t \right]
	\]
\end{enumpar}

Δηλαδή καταλήξαμε σε ένα σήμα FM για το οποίο ισχύει:
\begin{align*}
	f_c &= n_2(n_1f_0 + f_l) \\
	β_{\text{τελ}} &= n_1n_2β
\end{align*}

Επομένως μπορούμε να δημιουργήσουμε το τελικό Wide-Band σήμα FM με τις παραμέτρους
\( f_c \) και \( β_{\text{τελ}} \) που επιθυμούμε, αλλάζοντας κατάλληλα τις μεταβλητές
των στοιχείων \( n_1 \), \( n_2 \) και \( f_l \).

\subsubsection{Υλοποίηση PLL (Phase-Locked Loop) με διαμορφωτή FM}
Με τη χρήση ενός διαμορφωτή και ενός αποδιαμορφωτή FM (που θα δούμε παρακάτω), μπορούμε
να υλοποιήσουμε ένα κύκλωμα PLL, που ακολουθεί δηλαδή τη συχνότητα και τη φάση ενός
εισερχόμενου σήματος.

Για να το καταφέρουμε αυτό, προσθέτουμε ως αρνητική ανάδραση τη διαφορά της συχνότητας
του εξαγόμενου σήματος από μία τοπική συχνότητα:
\todo{Graph 123}

\subsubsection{Αποδιαμόρφωση FM}
Το FM σήμα φαίνεται αρχικά δύσκολο να αποδιαμορφωθεί:
\[
s_{FM}(t) = A_c\cos\left( 2πf_c t + 2πk_p \int\limits_{0}^{t} m(λ)\dif λ  \right)
\]
Αν όμως το παραγωγίσουμε, παίρνουμε:
\[
\od{s_{FM}(t)}{t} = -A_c 2π\left( 
1 + k_p m(t)
 \right) \cdot \sin\left( 2πf_c t + 2πk_p \int\limits_{0}^{t} m(λ)\dif λ  \right)
\]
\todo{check}
επομένως για να υλοποιήσουμε τον αποδιαμορφωτή μπορούμε απλώς να πάρουμε την παράγωγο
του FM και να την τοποθετήσουμε στην είσοδο ενός αποδιαμορφωτή AM, αφού ουσιαστικά
το παραπάνω σήμα είναι ένα ημίτονο πλάτους \( A_c2π\left(1+k_pm(t)\right) \), δηλαδή
είναι ένα σήμα διαμορφωμένο κατά AM.

\paragraph{}
Θυμόμαστε τον ορισμό της μιγαδικής περιβάλλουσας \( \tilde s(t) \) του σήματος:
\[
s(t) = \Re\left[ \tilde s(t)\exp j2πf_c t \right], \qquad
\tilde{s}(t) = A_c\exp\left[ jβ\sin(2πf_mt) \right]
\]
και τη λειτουργία μιας συνάρτησης μεταφοράς με κρουστική απόκριση \( h(t) \):
\todo{Graph 124}
Μπορούμε να βρούμε για ευκολία το ισοδύναμο χωρίς την επίδραση της συχνότητας:
\todo{Graph 125}
όπου μαθηματικά αποδεικνύεται ότι:
\[
\tilde{H}(f-f_c) = 2H(f) \iff \tilde{H}(f) = 2H(f+f_c)
\]
και τότε μπορούμε να βρούμε τα \( \tilde x(t) \), \( \tilde h(t) \) (από τα \( x(t) \)
και \( h(t) \) αντίστοιχα), το \( \tilde{Y}(t) = \frac{1}{2}\tilde{H}(f)\tilde{X}(f) \)
και το τελικό \( y(t) \) από το \( \tilde{y}(t) \).

\paragraph{}
Για την αποδιαμόρφωση FM υπάρχουν δύο κυκλώματα: ο διευκρινιστής συχνότητας, και το PLL.

\subsubsection{Διευκρινιστής συχνότητας}
Ο διευκρινιστής συχνότητας αποτελείται από έναν διαφοριστή (βρίσκει παραγώγους) και έναν
αποδιαμορφωτή περιβάλλουσας (AM), όπως περιγράψαμε και παραπάνω.

Ο \textbf{διαφοριστής} κατασκευάζεται με ένα \textbf{κύκλωμα κλίσης} (slope circuit), το
οποίο είναι ένα φίλτρο με συνάρτηση μεταφοράς:
\[
h_1(f) = \begin{cases}
j2πα\left(f-f_c+\sfrac{B_T}{2} \right),&\quad A_c-\sfrac{B_T}{2} \leq f \leq f_c + \sfrac{B_T}{2} \\
j2πα\left( f+f_c-\sfrac{B_T}{2}  \right),&\quad -f_c-\sfrac{B_T}{2}  \leq f \leq
-f_c + \sfrac{B_T}{2} \\
0,&\quad \text{αλλού} 
\end{cases}
\]
που έχει τη μορφή:
\todo{Graph 126}

Αν χρησιμοποιήσουμε τις μιγαδικές περιβάλλουσες (που μεταφέρουν το φίλτρο στη βασική ζώνη):
\[
\tilde{H_1}(f) = \begin{cases}
j4πα\left(f+\sfrac{B_T}{2} \right),\qquad& \sfrac{-B_T}{2}  \leq f \leq \sfrac{B_T}{2} \\
0,\qquad&\text{αλλού}
\end{cases}
\]
\todo{Graph 127}
και με είσοδο το FM σήμα \( \tilde{s}(t) = A_c\exp\left[j2πk_f\int_{0}^{t}m(λ)\dif λ\right] \), σύμφωνα με τη θεωρία που παρουσιάσαμε παραπάνω η έξοδος μετά την εφαρμογή του φίλτρου
θα είναι:
\begin{align*}
\tilde{S_1}(f) = \frac{1}{2}\tilde{H_1}\cdot\tilde{S}(f)
&= \begin{cases}
j2πα\left(f+\sfrac{B_T}{2} \right)\cdot S(f),\quad &\sfrac{-B_T}{2} \leq f \leq \sfrac{B_T}{2} \\
0,\quad & \text{αλλού}
\end{cases} \\
&=\begin{cases}
j2παf\tilde{S}(f)
+j2πα\sfrac{B_T}{2} \tilde{S}(f)
&,\quad \sfrac{-B_T}{2} \leq f \leq \sfrac{B_T}{2} \\
0&,\quad  \text{αλλού}
\end{cases}
\end{align*}
Παρατηρούμε πως φτάνουμε σε μια σχέση που περιέχει το αντίστοιχο της παραγώγου στο πεδίο
των συχνοτήτων (\( f \) πολλαπλασιασμένο με \( \tilde{S}(f) \)).

Εφαρμόζοντας αντίστροφο Μ/Σ Fourier στο παραπάνω, κάνουμε πράξεις:
\begin{align*}
	\tilde{s_1}(t) &= a\left[ \od{\tilde s(t)}{t} + jπB_T\tilde{s}(t) \right]
	\\
	 &= jaπB_T\left[
	\frac{1}{jπB_T} \od{\tilde{s}(t)}{s} + \tilde{s}(t)
	\right]
	\\ &= jaπB_TA_c\left[
	\frac{1}{\cancel{j}\cancel{π}B_T}\cancel{j}2\cancel{π}k_fm(t) + 1
	\right]
	\exp\left[
	j2πk_f \int_{0}^{t} m(λ)\dif λ
	\right]. \\
	s_1(t) &= \Re\left[ \tilde{s_1}(t)\exp\left(j2πf_c t\right) \right]
	\\ &= πaB_T A_c\left[ 1+\frac{2k_f}{B_T}m(t) \right]
	\cos \left( 2πf_c + 2πk_f \int_{0}^{t} m(λ)\dif λ + \frac{π}{2} \right)
\end{align*}

Δηλαδή προέκυψε ένα υβριδικό σήμα AM-FM, από το οποίο μπορούμε να εξάγουμε την περιβάλλουσα,
δεδομένου ότι ισχύει η συνθήκη που εξασφαλίζει ότι δεν έχουμε υπερδιαμόρφωση:
\[
\left| \frac{2k_f}{B_T} m(t) \right| < 1
\]
τότε η περιβάλλουσα είναι:
\[
\left| \tilde{s_1}(t) \right| = πB_T aA_c\left[
1+\frac{2k_f}{B_T}m(t)
\right]
\]

Για να πάρουμε την καθαρή πληροφορία, μπορούμε να εφαρμόσουμε και ένα δεύτερο φίλτρο
\( H_2 \):
\todo{Graph 128}
που δίνει έξοδο:
\[
\left| \tilde{s_2}(t) \right| = πB_TaA_c\left[
1-\frac{2k_f}{B_T} m (t)
\right]
\]

Αν αφαιρέσουμε τις εξόδους των δύο φίλτρων, έχουμε:
\[
s_o(t) = \left|\tilde{s_1}(t)\right| - \left|\tilde{s_2}(t)\right|
= 4πk_f a A_c m(t)
\]

Τελικά το διάγραμμα του αποδιαμορφωτή μοιάζει κάπως έτσι:
\todo{Graph 129}
Ο αποδιαμορφωτής αυτός ονομάζεται \textbf{balanced frequency discriminator}.

Η αφαίρεση μάλιστα των εξόδων των δύο φίλτρων βοηθάει ώστε να πραγματοποιηθεί η παραγώγιση
ακόμα και στην περίπτωση που αυτά δεν είναι ιδανικά.

\subsection{Στερεοφωνικό FM}
Στο στερεοφωνικό FM θέλουμε να μεταδίδουμε 2 σήματα ήχου (αριστερό και δεξί) αντί για μόνο 1.
Επειδή όμως στην εποχή που υλοποιήθηκε το στερεοφωνικό FM είχαν ήδη διαδοθεί οι μονοφωνικοί
δέκτες, έπρεπε να χρησιμοποιηθεί ένα είδος πολυπλεξίας που να μην επηρέαζε τις ακροάσεις τους.

Η στερεοφωνική διαμόρφωση λειτουργεί στέλνοντας το άθροισμα και τη διαφορά των δύο σημάτων
(αριστερού και δεξιού). Στη συνέχεια, κρατάμε το άθροισμα, μετακινούμε τη διαφορά λίγο
πιο πάνω στη συχνότητα, και προσθέτουμε έναν πιλοτικό τόνο ανάμεσα στα δύο κανάλια:
\todo{Graph 130}
\todo{Graph 131}

Έτσι, ο αποδιαμορφωτής του στερεοφωνικού FM χρειάζεται ένα Low Pass φίλτρο για να πάρει
το αριστερό κανάλι, και ένα Band Pass φίλτρο για να πάρει το δεξί κανάλι. Στη συνέχεια,
πολλαπλασιάζει το δεξί κανάλι με τον πιλοτικό τόνο σε έναν μίκτη, έτσι ώστε να το μεταφέρει
στη βασική ζώνη. Στο τέλος, προσθαφαιρούνται κατάλληλα τα σήματα ώστε από τα \( m_1+m_2 \)
και \( m_1-m_2 \) να εξαχθούν τα \( m_1 \) και \( m_2 \):
\todo{Graph 133}
\todo{Graph 132}

Ταυτόχρονα, με αυτόν τον τρόπο, οι δέκτες που δεν υποστηρίζουν stereo "βλέπουν" μόνο
το σήμα \( s(t) \) μέχρι τα 15 kHz (που είναι το άθροισμα του αριστερού και του δεξιού),
και βγάζουν μόνο αυτό το σήμα και στα δύο ηχεία. Από την άλλη μεριά, οι στερεοφωνικοί
δέκτες που συντονίζονται σε έναν μονοφωνικό σταθμό FM βλέπουν το σήμα στη θέση
\( m_1+m_2 \), και δε βλέπουν τίποτα στο \( m_1-m_2=0 \), οπότε παράγουν το ίδιο σήμα και στο
αριστερό, και στο δεξί ηχείο, που είναι η επιθυμητή συμπεριφορά.

\subsection{Ασκήσεις}

\paragraph{Ερώτηση}
Στον τύπο για το FM:
\[
s(t) = A_c \cos\left(2πf_c t + 2πk_f \int_{0}^{t} m(τ)\dif τ\right)
\]
γιατί υπάρχει το ολοκλήρωμα μέσα στο συνημίτονο, και τι δηλώνει αυτό;

\subparagraph{Απάντηση}
Η (γωνιακή) συχνότητα είναι η παράγωγος της γωνίας, επομένως σε αυτήν την περίπτωση
είναι η παράγωγος του ολοκληρώματος, δηλαδή το σήμα \( m(t) \), το οποίο θέλουμε να
είναι διαμορφωμένο κατά συχνότητα.

Πράγματι, στο FM θέλουμε η \textbf{στιγμιαία} συχνότητα να είναι:
\[
f_i = f_c + k_f m(t)
\]
όμως η παράγωγος της γωνίας είναι η συχνότητα, άρα:
\[
f_i = 2π\od{\theta(t)}{t}
\]
επομένως έχουμε:
\begin{align*}
	\theta(t) &= \int_{0}^{t} 2π f_i(τ)\dif τ
	\\ &= \int_{0}^{t} 2π\left[f_c + k_f m(τ)\right]\dif τ
	\\ &= 2π f_c t + 2πk_f \int_{0}^{t} m(τ)\dif τ
\end{align*}
που είναι ίδια με την έκφραση εντός του συνημιτόνου.

\paragraph{Ερώτηση}
Δίνεται το \textbf{διαμορφωμένο κατά PM} σήμα:
\todo{text}

Το αρχικό σήμα είναι ένας τόνος \( f_m = \SI{1}{\hertz} \). Αυτός ο τόνος
είναι ημίτονο ή συνημίτονο;

\subparagraph{Λύση}
Θυμόμαστε ότι στα \textbf{FM} σήματα η συχνότητα και η φάση είναι της μορφής:
\begin{align*}
	f_i(t) &= f_c + k_f m(t) \\
	\theta(t) &= 2πf_c t + 2πk_f \int_{0}^{t} m(τ)\dif τ
\end{align*}

Αντίστοιχα, στα \textbf{PM} σήματα η φάση είναι που εξαρτάται απ' ευθείας από το σήμα:
\[
\theta(t) = 2πf_c t + k_p m(t)
\]
και η στιγμιαία συχνότητα εξαρτάται από την \textbf{παράγωγο} της πληροφορίας:
\[
f_i(t) = f_c + \frac{k_p}{2π}m'(t)
\]

Θα ελέγξουμε τη συχνότητα του σήματος που μας δίνεται.
Μεταξύ του 0 και 0.5 το σήμα είναι αραιό, ενώ μεταξύ του 0.5 και του 1 το σήμα είναι πυκνό.
Λαμβάνουμε περιπτώσεις:
\begin{itemize}
	\item Έστω \( m'(t) = \sin 2πτ \)
	\todo{Graph 135}
	\item Έστω \( m'(t) = \cos 2πτ \)
	\todo{Graph 136}
	\item Έστω \( m'(t) = -\sin 2πτ \)
	\todo{Graph 137}
\end{itemize}

Τα αραιώματα αντιστοιχούν σε αρνητική τιμή της \( m'(t) \), ενώ τα πυκνώματα σε θετική. Η
συνάρτηση που ταιριάζει περισσότερο είναι η \( m'(t) = -\sin 2πt \), άρα \( m(t) = \sin 2πt \).

\paragraph{Ερώτηση}
Η κινητή τηλεφωνία πρώτης γενιάς (1G) χρησιμοποιούσε διαμόρφωση FM. Επιχειρηματολογήστε
σύντομα υπέρ αυτής της επιλογής ένταντι της διαμόρφωσης AM χρησιμοποιώντας κριτήρια όπως:
\begin{itemize}
	\item Πολυπλοκότητα
	\item Φάσμα
	\item Εμπορικό ενδιαφέρον
	\item Μέγεθος κινητών συσκευών
\end{itemize}
\subparagraph{Απάντηση}
Για να απαντήσουμε σε αυτήν την ερώτηση πρέπει να λάβουμε υπ' όψιν τις συνθήκες της εποχής.
Τη στιγμή που αυτή ήταν μια καινούρια τεχνολογία, υπήρχε μικρό εμπορικό ενδιαφέρον, και
η κινητή τηλεφωνία απευθυνόταν κυρίως σε επαγγελματίες και άτομα που είχαν την οικονομική
δυνατότητα να επενδύσουν στη δυνατότητα να έχουν ένα κινητό και να μπορούν να επικοινωνήσουν
ανά πάσα στιγμή. Επομένως, η πολυπλοκότητα και το κόστος δεν αποτελούσε σημαντικό κριτήριο.

Με την ίδια λογική με παραπάνω, δεν έχουμε κάποια ιδιαίτερη απαίτηση από το φάσμα, δεδομένου
ότι έχουμε πολύ μικρό αριθμό πελατών, και μπορούμε να ξοδέψουμε κάποιο εύρος συχνοτήτων.

Αντίθετα, το AM ξοδεύει μεγάλη ποσότητα της ενέργειας στο σήμα του φέροντος, κάτι που θα
καθιστούσε τις συσκευές πολύ μεγάλες.

\paragraph{Άσκηση}
Το αδιαμόρφωτο φέρον ενός διαμορφωτή FM έχει συχνότητα \( f_c = \SI{1.4}{MHz} \) πλάτους
\( A_c = \SI{30}{\volt} \).

Η διαμόρφωση συχνότητας είναι τέτοια ώστε σήμα πλάτους \( A_m = \SI{1}{\milli\volt} \)
να αντιστοιχεί σε μεταβολή \( Δ_f = \SI{3}{\kilo\hertz} \).

\begin{enumgreekpar}
	\item Έστω ένα σήμα πληροφορίας \( m(t) = A_m \cdot \cos(94247.78 t) \).
	Να βρεθεί η μέγιστη τιμή του \( A_m \) ώστε το εύρος ζώνης του διαμορφωμένου σήματος
	να είναι \( B_T \leq 0.04\cdot f_c \)
	\item Αν επιλέξω το πλάτος του μηνύματος να είναι \( A_m = \frac{A_{\max}}{4} \)
	να προσδιοριστεί η ισχύς \( P_s \) του διαμορφωμένου σήματος FM, καθώς και το εύρος
	ζώνης που καταλαμβάνει.
\end{enumgreekpar}

\subparagraph{Λύση}
\begin{enumgreekpar}
	\item Το σήμα πληροφορίας έχει συχνότητα που υπολογίζεται ως εξής:\[
	2πf_m t = 94247.78t \implies f_m = \SI{15}{\kilo\hertz}
	\]
	
	Το εύρος ζώνης θέλουμε να είναι: \[
	B_T \leq 0.04 \cdot \SI{1.4}{\mega\hertz} = \SI{56}{\kilo\hertz}
	\]
	
	Όμως, από τον \textbf{κανόνα του Carson}, για το εύρος ζώνης ισχύει:
	\[
	B_T = 2f_m(1+β) \implies 2f_m(1+β) \leq \SI{56}{\kilo\hertz}
	\implies \underline{β \leq 0.8667}
	\]
	
	Με τόσο μικρό \( β \) παίρνουμε FM στενής ζώνης (Narrow Band FM \textendash\ NBFM).
	
	Από τα δεδομένα μπορούμε ακόμα να βρούμε και το \( k_f \):
	\[
	Δ_f = k_f \cdot A_m \implies \underline{k_f = 3\cdot 10^6 \si{\hertz/\volt}}
	\]
	
	Τέλος, εφαρμόζουμε τον τύπο για το \( β \):
	\[
	β = \frac{k_f\cdot A}{f_m}
	\implies A = \frac{β\cdot f_m}{k_f} \leq \frac{0.8667\cdot 15 \cdot 10^3}{3\cdot 10^6}
	= \SI{4.3}{\milli\volt}
	\]
	
	Άρα το μέγιστο πλάτος είναι:
	\[
	\underline{A_{\max} = \SI{4.3}{\milli\volt}}
	\]
	
	\item Θυμόμαστε ότι το διαμορφωμένο σήμα είναι:
	\[
	s(t) = A_c \cos\underbrace{\left(
	2πf_c t + 2πk_f \int_{0}^{t} m(τ)\dif τ
	\right)}_{θ(τ)}
	= A_c\cos θ(τ) \]
	δηλαδή απλώς ένα συνημίτονο με μια γωνία.
	
	Άρα η ισχύς του είναι (αν θεωρήσουμε τη σύμβαση της αντίστασης \( \SI{1}{\ohm} \)):
	\[
	P_s = \frac{A_c^2}{2} = \SI{450}{\watt}
	\]
	
	Για το εύρος ζώνης, από τον κανόνα του Carson:
	\[
	B_T = 2f_m(1+β) = \SI{30}{\kilo\hertz}\cdot (1 + 0.215) = \SI{36.45}{\kilo\hertz}
	\]
\end{enumgreekpar}

\paragraph{Ερώτημα}
Γιατί η τιμή του δείκτη διαμόρφωσης \( β \) που καθορίζει αν ένα σήμα FM είναι στενής
ή ευρείας ζώνης είναι η \( β=1 \);

Συμβουλευτείτε το διάγραμμα με τις συναρτήσεις Bessel.

\subparagraph{Απάντηση}
Από τη θεωρία γνωρίζουμε ότι ένα NBFM σήμα έχει τη μορφή:
\begin{equation}
s(t) = A_c\cdot \cos 2πf_c t - β\cdot A_c \sin 2πf_m t \cdot \sin 2πf_c t
\label{eq:exnbfm}
\end{equation}
αν θεωρήσουμε ότι \( m(t) = -\cos2π f_m t \).

Θυμόμαστε επίσης την αρχική μορφή του FM:
\[
s(t) = A_c \cdot \cos\left(2πf_c t + β\cdot \sin 2πf_m t\right)
\]

Αναπτύσσουμε την τελευταία σχέση με βάση τις τριγωνομετρικές ιδιότητες και έχουμε:
\begin{equation}
	s(t) = A_c \cdot \cos 2πf_c t \cdot \cos \left(
	β\cdot \sin2π f_m t
	\right) - A_c \sin 2πf_c t \cdot \sin(β\cdot \sin 2πf_m t)
	\label{eq:exalmost_nbfm}
\end{equation}

Η \eqref{eq:exalmost_nbfm} μοιάζει με την αρχική \eqref{eq:exnbfm} αν το \( β \) είναι
αρκετά μικρό. Πράγματι, μπορούμε να λάβουμε τα αναπτύγματα Taylor του ημιτόνου και του
συνημιτόνου:
\begin{align*}
	\cos x &= 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \dots \\
	\sin x &= x - \frac{x^3}{3!} + \frac{x^5}{5!} - \dots
\end{align*}

Για πολύ μικρά \( x \), το \( \cos x \approx 1 \) και το \( \sin x \approx x \), επομένως:
\begin{align*}
	\cos(β\cdot\sin 2πf_m t) &\simeq 1 \\
	\sin(β\cdot \sin 2πf_m t) &\simeq β\cdot \sin 2πf_m t
\end{align*}

\subparagraph{}
Εναλλακτικά, λαμβάνοντας υπ' όψιν τις συναρτήσεις Bessel, θυμόμαστε από τη θεωρία πως για το
FM ισχύει:
\[
s(t) = A_c \cdot \sum_{n=-\infty}^{\infty} J_n(β)
\cdot \cos\left(2π\left(f_c+nf_m\right)t\right)
\]

Από το διάγραμμα των συναρτήσεων Bessel 1\textsuperscript{ου} είδους, παρατηρούμε ότι πριν
από το 1, οι συναρτήσεις \( J_2,\ J_3,\ J_4, \dots \) αποκτούν όλο και περισσότερο
αμελητέες τιμές. Πράγματι, αν θεωρήσουμε ότι \( n \in \left\lbrace -1,\ 0,\ 1 \right\rbrace \),
τότε μένουν μόνο οι 3 όροι που υπάρχουν και στην έκφραση \eqref{eq:exnbfm} του NBFM.

Μπορούμε ακόμα να υπολογίσουμε την ισχύ του εξαγόμενου σήματος. Η ισχύς του πλήρους
FM είναι:
\[
\sum_{n=-\infty}^{\infty} J_n^2(β) = 1
\]

Αντίστοιχα, η ισχύς με τους 3 πρώτους όρους μόνο είναι:
\[
\sum_{n=-1}^{1}J_n^2 (β) \simeq 97\%
\]
που είναι αποδεκτό.
\end{document}
